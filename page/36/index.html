<!doctype html>



  


<html class="theme-next muse use-motion" lang>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css">


  <meta name="keywords" content="Hexo, NexT">








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1">






<meta property="og:type" content="website">
<meta property="og:title" content="Double">
<meta property="og:url" content="http://yoursite.com/page/36/index.html">
<meta property="og:site_name" content="Double">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Double">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/36/">





  <title>Double</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Double</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/08/28/ReadNote/http/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Double">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/head1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Double">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/28/ReadNote/http/" itemprop="url">HTTP</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-08-28T13:18:12+08:00">
                2016-08-28
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ReadNote/" itemprop="url" rel="index">
                    <span itemprop="name">ReadNote</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>原文：<a href="http://www.kancloud.cn/kancloud/tealeaf-http/43832" target="_blank" rel="noopener">http://www.kancloud.cn/kancloud/tealeaf-http/43832</a></p>
<h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>HTTP 解释：</p>
<ol>
<li>规则系统，协议</li>
<li>把应用程序和超文本文档之间的传输联系起来</li>
<li>是机器之间彼此沟通的协议，或者说消息格式</li>
<li>遵循一个简单的模型：请求－－响应</li>
</ol>
<p>历史：</p>
<ol>
<li>1991年 HTTP／0.9</li>
<li>1992年 HTTP／1.0</li>
<li>1995年 HTTP／1.1</li>
</ol>
<h2 id="请求包"><a href="#请求包" class="headerlink" title="请求包"></a>请求包</h2><p><img src="http://upload-images.jianshu.io/upload_images/680540-e04227416a611216.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="请求包"></p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2016/08/28/ReadNote/http/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/08/28/Android/优化/01.找出界面卡顿的原因--BlockCanary/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Double">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/head1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Double">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/28/Android/优化/01.找出界面卡顿的原因--BlockCanary/" itemprop="url">找出Android界面卡顿的原因－－ BlockCanary</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-08-28T13:18:12+08:00">
                2016-08-28
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/" itemprop="url" rel="index">
                    <span itemprop="name">Android</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p><img src="https://github.com/markzhai/AndroidPerformanceMonitor" alt="github"></p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2016/08/28/Android/优化/01.找出界面卡顿的原因--BlockCanary/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/08/28/Python/WebCrawler/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Double">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/head1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Double">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/28/Python/WebCrawler/" itemprop="url">A Web Crawler With asyncio Coroutines</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-08-28T13:18:12+08:00">
                2016-08-28
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index">
                    <span itemprop="name">Python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>原文地址：<a href="http://aosabook.org/en/500L/a-web-crawler-with-asyncio-coroutines.html" target="_blank" rel="noopener">http://aosabook.org/en/500L/a-web-crawler-with-asyncio-coroutines.html</a></p>
<h2 id="The-Traditional-Approach"><a href="#The-Traditional-Approach" class="headerlink" title="The Traditional Approach"></a>The Traditional Approach</h2><p>传统的写法，创建一个线程池，每个线程通过socket处理一个页面，下载<code>xkcd.com</code>:</p>
<pre><code>def fetch(url):
    sock = socket.socket()
    sock.connect((&apos;xkcd.com&apos;, 80))
    request = &apos;GET {} HTTP/1.0\r\nHost: xkcd.com\r\n\r\n&apos;.format(url)
    sock.send(request.encode(&apos;ascii&apos;))
    response = b&apos;&apos;
    chunk = sock.recv(4096)
    while chunk:
        response += chunk
        chunk = sock.recv(4096)

    # Page is now downloaded
    links = parse_links(response)
    q.add(links)
</code></pre><p>socket的操作都是阻塞操作。如果在同一时刻需要处理大量的页面就需要大量的线程。通常一个成熟的应用程序会通过使用线程池来管理线程达到减少不断创建线程导致的性能消耗。</p>
<p>使用线程是非常消耗系统资源的</p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2016/08/28/Python/WebCrawler/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/08/27/ReadNote/head_first_python/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Double">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/head1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Double">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/27/ReadNote/head_first_python/" itemprop="url">Head First Python</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-08-27T13:18:12+08:00">
                2016-08-27
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/读书笔记/" itemprop="url" rel="index">
                    <span itemprop="name">读书笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h1 id="Head-First-Python-笔记"><a href="#Head-First-Python-笔记" class="headerlink" title="Head First Python 笔记"></a>Head First Python 笔记</h1><blockquote>
<p>结束 太基础了</p>
</blockquote>
<h1 id="初识-Python"><a href="#初识-Python" class="headerlink" title="初识 Python"></a>初识 Python</h1><p>查看电脑上Python的版本：</p>
<pre><code>python3 -V
</code></pre>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2016/08/27/ReadNote/head_first_python/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/08/14/ReadNote/Python/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Double">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/head1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Double">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/14/ReadNote/Python/" itemprop="url">Python 学习记录</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-08-14T21:38:14+08:00">
                2016-08-14
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index">
                    <span itemprop="name">Python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h1 id="第一个Python程序"><a href="#第一个Python程序" class="headerlink" title="第一个Python程序"></a>第一个Python程序</h1><ol>
<li><p>编写一个文件：<code>hello.py</code></p>
<pre><code>print(&apos;hello , world&apos;);
</code></pre></li>
<li><p>运行这个文件</p>
<pre><code>python hello.py
</code></pre></li>
<li><p>运行文件方法二：</p>
<pre><code>// 1. 修改文件内容
#!/usr/bin/env python3
print(&apos;hello,world&apos;)

// 2. 给文件添加执行权限
chmod a+x hello.py

// 3. 执行文件
./hello.py
</code></pre></li>
</ol>
<p>上面使用了交互模式和直接运行<code>.py</code>文件</p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2016/08/14/ReadNote/Python/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/08/07/Android/UI/贝塞尔曲线/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Double">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/head1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Double">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/07/Android/UI/贝塞尔曲线/" itemprop="url">贝塞尔曲线</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-08-07T13:18:12+08:00">
                2016-08-07
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/" itemprop="url" rel="index">
                    <span itemprop="name">Android</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>参考：</p>
<ul>
<li><a href="http://gold.xitu.io/entry/5771cb966be3ff00639ffcb2" target="_blank" rel="noopener">http://gold.xitu.io/entry/5771cb966be3ff00639ffcb2</a></li>
<li><a href="http://blog.csdn.net/lupengfei1009/article/details/51995385" target="_blank" rel="noopener">http://blog.csdn.net/lupengfei1009/article/details/51995385</a></li>
</ul>
<h2 id="数学中的贝塞尔"><a href="#数学中的贝塞尔" class="headerlink" title="数学中的贝塞尔"></a>数学中的贝塞尔</h2><p>贝塞尔曲线于1962年，由法国工程师皮埃尔·贝塞尔（Pierre Bézier）所广泛发表，他运用贝塞尔曲线来为汽车的主体进行设计。贝塞尔曲线最初由Paul de Casteljau于1959年运用de Casteljau算法开发，以稳定数值的方法求出贝塞尔曲线。</p>
<p>在计算机图形学中贝赛尔曲线的运用也很广泛，Photoshop中的钢笔效果，Flash5的贝塞尔曲线工具，在软件GUI开发中一般也会提供对应的方法来实现贝赛尔曲线。</p>
<ul>
<li>线性贝塞尔曲线</li>
<li>二次贝塞尔曲线</li>
<li>三阶贝塞尔曲线</li>
</ul>
<p>详情介绍：<a href="https://zh.wikipedia.org/wiki/%E8%B2%9D%E8%8C%B2%E6%9B%B2%E7%B7%9A" target="_blank" rel="noopener">wiki</a></p>
<h2 id="Android-中实现贝塞尔曲线"><a href="#Android-中实现贝塞尔曲线" class="headerlink" title="Android 中实现贝塞尔曲线"></a>Android 中实现贝塞尔曲线</h2><h3 id="quadTo-一次贝塞尔"><a href="#quadTo-一次贝塞尔" class="headerlink" title="quadTo 一次贝塞尔"></a>quadTo 一次贝塞尔</h3><h3 id="rQuadTo-二次贝塞尔"><a href="#rQuadTo-二次贝塞尔" class="headerlink" title="rQuadTo 二次贝塞尔"></a>rQuadTo 二次贝塞尔</h3><h3 id="cubicTo-三次贝塞尔"><a href="#cubicTo-三次贝塞尔" class="headerlink" title="cubicTo 三次贝塞尔"></a>cubicTo 三次贝塞尔</h3>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2016/08/07/Android/UI/贝塞尔曲线/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/08/07/program/RESTful/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Double">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/head1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Double">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/07/program/RESTful/" itemprop="url">RESTful</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-08-07T13:18:12+08:00">
                2016-08-07
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Program/" itemprop="url" rel="index">
                    <span itemprop="name">Program</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>URL定位资源，用HTTP动词（GET,POST,DELETE,DETC）描述操作</p>
</blockquote>
<h1 id="REST"><a href="#REST" class="headerlink" title="REST"></a>REST</h1><p>Representational State Transfer,表现层状态转化</p>
<p>符合REST原则的架构：RESTful架构</p>
<h2 id="REST-架构约定"><a href="#REST-架构约定" class="headerlink" title="REST 架构约定"></a>REST 架构约定</h2><ol>
<li><p>CS结构（Client–server）</p>
<p> 客户端是一个相对独立的实现，它不必考虑数据的持久化存储问题。服务端拥有和保存数据，服务端不去关心客户端内部实现，也不用关心客户端请求的上下文。服务端和客户端之间遵守相同的接口规范。在遵守相同接口规范的前提下，二者都可以独立演化，甚至可以被其它的实现替代。</p>
</li>
<li><p>无状态（Stateless）</p>
<p> 服务端不依赖前后不同请求的顺序和状态信息来完成请求.<br> 请求的session信息由客户端持有，并在必要时连同请求数据一起发送。服务端可以使用请求中的session信息去其它外部服务或者数据库获取相关内容进以便对该请求做权限验证等操作。</p>
<p> 如果所需数据要通过多次请求才能完成，客户端必须自己负责记录状态（因为服务器不跟踪客户端的状态）</p>
<p> 服务端不依赖客户端的请求顺序和状态提高了服务器的可扩展性（scalability）</p>
<p> 无状态的约定也提高了系统的健壮性（reliability）</p>
</li>
<li><p>缓存机制（Cacheable）</p>
<p> 服务端应该明确规定返回数据的缓存机制，包括是否可缓存，缓存如何失效以及利用缓存获取增量数据而不必每次获取全部数据等。合理的缓存设计可以减少请求次数，进而提高服务器的效率和性能。</p>
</li>
<li><p>系统分层（Layered system）</p>
<p> 客户端不用知道数据是从服务端直接返回还是通过中转代理返回。</p>
</li>
<li><p>可定制代码（可选）（Code on demand）</p>
</li>
<li><p>一致的接口（Uniform interface）</p>
</li>
</ol>
<h2 id="主语-资源（Resources）"><a href="#主语-资源（Resources）" class="headerlink" title="主语 资源（Resources）"></a>主语 资源（Resources）</h2><p>“表现层”其实指的是”资源”（Resources）的”表现层”。</p>
<p>资源表示网络上或者说服务器上的具体的数据：图片，视频，json数据；使用URI指向这个数据</p>
<h2 id="表现层（Representation）"><a href="#表现层（Representation）" class="headerlink" title="表现层（Representation）"></a>表现层（Representation）</h2><p>比如，文本可以用txt格式表现，也可以用HTML格式、XML格式、JSON格式表现，甚至可以采用二进制格式；图片可以用JPG格式表现，也可以用PNG格式表现。</p>
<p>URI应该只代表”资源”的位置。它的具体表现形式，应该在HTTP请求的头信息中用Accept和Content-Type字段指定</p>
<h2 id="状态转化（State-Transfer）"><a href="#状态转化（State-Transfer）" class="headerlink" title="状态转化（State Transfer）"></a>状态转化（State Transfer）</h2><p>如果客户端想要操作服务器，必须通过某种手段，让服务器端发生”状态转化”（State Transfer）</p>
<p>四种基本操作：GET用来获取资源，POST用来新建资源（也可以用于更新资源），PUT用来更新资源，DELETE用来删除资源。</p>
<h2 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h2><ol>
<li>每一个URI代表一种资源；</li>
<li>客户端和服务器之间，传递这种资源的某种表现层；</li>
<li>客户端通过四个HTTP动词，对服务器端资源进行操作，实现”表现层状态转化”。</li>
</ol>
<h2 id="设计误区"><a href="#设计误区" class="headerlink" title="设计误区"></a>设计误区</h2><h3 id="URI包含动词"><a href="#URI包含动词" class="headerlink" title="URI包含动词"></a>URI包含动词</h3><p>因为”资源”表示一种实体，所以应该是名词，URI不应该有动词，动词应该放在HTTP协议中。</p>
<p>比如：某个URI是/posts/show/1，其中show是动词，这个URI就设计错了，正确的写法应该是/posts/1，然后用GET方法表示show。</p>
<h3 id="动作"><a href="#动作" class="headerlink" title="动作"></a>动作</h3><p>如果某些动作是HTTP动词表示不了的，你就应该把动作做成一种资源。</p>
<p>比如网上汇款，从账户1向账户2汇款500元，错误的URI是：</p>
<pre><code>POST /accounts/1/transfer/500/to/2
</code></pre><p>正确的写法是把动词transfer改成名词transaction，资源不能是动词，但是可以是一种服务：</p>
<pre><code>POST /transaction HTTP/1.1
Host: 127.0.0.1
</code></pre><p>　　<br>    from=1&amp;to=2&amp;amount=500.00</p>
<h3 id="URI中加入版本号"><a href="#URI中加入版本号" class="headerlink" title="URI中加入版本号"></a>URI中加入版本号</h3><p>因为不同的版本，可以理解成同一种资源的不同表现形式，所以应该采用同一个URI。</p>
<p>Accept字段中进行区分：</p>
<pre><code>Accept: vnd.example-com.foo+json; version=1.0
Accept: vnd.example-com.foo+json; version=1.1
Accept: vnd.example-com.foo+json; version=2.0
</code></pre><p>注意使用json传输的时候，要求请求头里面加入：Content-Type：applicatin/json.否则抛出415异常（unsupported media type）</p>
<h1 id="接口设计"><a href="#接口设计" class="headerlink" title="接口设计"></a>接口设计</h1><p>符合REST设计风格的Web API称为RESTful API</p>
<h2 id="API-命名应该简洁明了"><a href="#API-命名应该简洁明了" class="headerlink" title="API 命名应该简洁明了"></a>API 命名应该简洁明了</h2><p>所有 API 应该使用 REST 架构约定形式命名：将 API 请求对象看成一个个资源，实现者使用相应的 HTTP 的动词（GET, POST, PUT, PATCH, DELETE）来访问和操作这些资源。</p>
<p>案例：</p>
<pre><code>- GET /users  获取所用户
- GET /user/1234  获取ID为1234的用户
- POST /users  创建一个新用户
- PUT /users/1234  更新ID为1234的用户
- PATCH /users/1234  更新ID为1234的用户的部分内容
- DELETE /users/1234  删除ID为1234的用户
</code></pre><blockquote>
<p>约定：使用了复数形式</p>
</blockquote>
<p>如何表示资源之间的联系 API：</p>
<p>例子：</p>
<pre><code>- GET /users/1234/comments  获取用户ID为1234的所有评论
- GET /users/1234/comments/1 获取用户ID为1234的评论ID为1的单个评论
- DELETE /users/1234/messages/1  删除用户评论ID为1，属于用户1234的单个评论
</code></pre><h2 id="考虑到系统迭代和兼容性，URL中添加版本号"><a href="#考虑到系统迭代和兼容性，URL中添加版本号" class="headerlink" title="考虑到系统迭代和兼容性，URL中添加版本号"></a>考虑到系统迭代和兼容性，URL中添加版本号</h2><pre><code>http://api.domain.com/v2
</code></pre><p>接口不可能一成不变，在不停迭代中，总会发生变化。接口的变化一般会有几种：</p>
<ul>
<li>数据的变化，比如增加了旧版本不支持的数据类型</li>
<li>参数的变化，比如新增了参数</li>
<li>接口的废弃，不再使用该接口了</li>
</ul>
<p>为了适应这些变化，必须得做接口版本的设计。</p>
<p>如果一个 API 的版本过期了，任何把该请求重定向到最新版本上。</p>
<h2 id="优雅的设计条件过滤，排序，搜索等传入参数形式"><a href="#优雅的设计条件过滤，排序，搜索等传入参数形式" class="headerlink" title="优雅的设计条件过滤，排序，搜索等传入参数形式"></a>优雅的设计条件过滤，排序，搜索等传入参数形式</h2><p>输入参数推荐采用 HTTP Query Parameter 的方式实现。</p>
<p>例子：</p>
<ul>
<li><p>比如你要设计一个API，返回所有已经登录的用户，可以这样做:</p>
<pre><code>GET /users?login=true
</code></pre></li>
<li><p>获取所有的用户，返回结果按照create_at降序排序可以这样设计：</p>
<pre><code>GET /users?sort=-create_at
</code></pre></li>
<li><p>组合使用过滤条件和排序：</p>
<pre><code>GET /users?sort=-create_at,login_at&amp;login=true
</code></pre></li>
<li><p>对于一些常用的条件搜索和过滤，可以考虑映射到一个新的API（相当于快捷方式）比如设计一个用于返回最近登录用户的API：</p>
<pre><code>GET /users/recently_login
</code></pre><p>  这种设计可以简化客户端的调用，否则调用者每次都要根据时间合成 Query Parameter，增加了客户端使用复杂度。</p>
</li>
<li><p>查询数据的部分内容：</p>
<pre><code>GET /user?fields=id,user_name,address&amp;diabled=false&amp;sort=-login_at
GET /facebook/v2.8/me?fields=id,name,birthday,cover,devices,email&amp;access_token=xxx
</code></pre></li>
</ul>
<h2 id="合理设计返回数据的形式，格式和考虑启用压缩（gzip）"><a href="#合理设计返回数据的形式，格式和考虑启用压缩（gzip）" class="headerlink" title="合理设计返回数据的形式，格式和考虑启用压缩（gzip）"></a>合理设计返回数据的形式，格式和考虑启用压缩（gzip）</h2><h2 id="根据不同的-API-操作，设置合适的-HTTP-状态码和必要的出错信息"><a href="#根据不同的-API-操作，设置合适的-HTTP-状态码和必要的出错信息" class="headerlink" title="根据不同的 API 操作，设置合适的 HTTP 状态码和必要的出错信息"></a>根据不同的 API 操作，设置合适的 HTTP 状态码和必要的出错信息</h2><p>对于需要提供额外说明的错误类型，可以在 HTTP Body 中详细描述，便于调用者排查原因：</p>
<pre><code>{
 &quot;error&quot;: {
  &quot;message&quot;:&quot;Message describing the error&quot;,
  &quot;type&quot;:&quot;OAuthException&quot;,
  &quot;code&quot;:190,
  &quot;error_subcode&quot;:460,
  &quot;error_user_title&quot;:&quot;A title&quot;,
  &quot;error_user_msg&quot;:&quot;A message&quot;,
  &quot;fbtrace_id&quot;:&quot;EJplcsCHuLu&quot;
  }
}
</code></pre><h2 id="使用-token-机制设计鉴权和验证系统（Authorization-and-Authentication）"><a href="#使用-token-机制设计鉴权和验证系统（Authorization-and-Authentication）" class="headerlink" title="使用 token 机制设计鉴权和验证系统（Authorization and Authentication）"></a>使用 token 机制设计鉴权和验证系统（Authorization and Authentication）</h2><h3 id="一-针对特定用户生成一个-token"><a href="#一-针对特定用户生成一个-token" class="headerlink" title="一 针对特定用户生成一个 token"></a>一 针对特定用户生成一个 token</h3><p>每次API的调用请求都带上这个 token。为了防止 token 泄露引发的安全问题，还应该考虑 token 什么时候失效，什么时候需要重新生成。</p>
<h3 id="OAuth-2"><a href="#OAuth-2" class="headerlink" title="OAuth 2"></a>OAuth 2</h3><p>OAuth 2 适合需要把某一资源暴露给第三方应用的情况</p>
<p>比如：</p>
<pre><code>如果你使用新浪微博登录豆瓣，在你的同意下（你在微博的登录界面输入用户名密码，并且确认），微博最终会给豆瓣一个具有实效性的 token，豆瓣凭借这个 token 来读取你的昵称和头像信息。
</code></pre><h3 id="方案"><a href="#方案" class="headerlink" title="方案"></a>方案</h3><ol>
<li>用户使用户名密码或者第三方登录，最终请求一个我们设计的登录 API（这个 API 接受用户名密码，或第三方登录验证结果）；</li>
<li>服务端认证成功以后，生成一个 token，并将这个 token 和用户信息关联在一起，同时返回这个 token 给调用客户端；</li>
<li>客户端记录并保存下这个 token；</li>
<li>下次客户端发起和用户相关请求 API 都要在 http header 中带上这个 token；</li>
<li>服务端通过这个 token 去区分用户是谁，判断这个用户是否已经登录和有什么样的权限；</li>
<li>服务端也要考虑 token 的失效时间；</li>
<li>客户端在发现 token 失效的时候重新请求新的 token</li>
</ol>
<p>为什么使用 token 而不是直接把用户名和密码放在 http header 中直接做授权和验证？</p>
<blockquote>
<p>原因是调用 API 一般会被频繁调用，这样用户名和密码频繁在网络上传输，增加了泄漏的危险。如果使用token，即使泄漏了也不会暴露用户的密码，何况 token 也被经常被设计成有时间限制的，超时以后当前 token 就会失效，需要客户端重新做验证获得新的 token，暴露之后的影响很快就会过去。</p>
</blockquote>
<h2 id="如何实现数据的分页返回"><a href="#如何实现数据的分页返回" class="headerlink" title="如何实现数据的分页返回"></a>如何实现数据的分页返回</h2><h2 id="如何处理有关联资源的返回数据"><a href="#如何处理有关联资源的返回数据" class="headerlink" title="如何处理有关联资源的返回数据"></a>如何处理有关联资源的返回数据</h2><p>情况：</p>
<blockquote>
<p>有一个 API，输入一个指定用户 id，返回一个该用户所有评论信息。最终要在 UI 上显示的，除了该用户评论的具体文本内容以外，还有用户名，头像，个人简介之类和该用户相关的详细信息。</p>
</blockquote>
<p>应该设计的 api：</p>
<pre><code>/comments?user=1234

{
  data: [
   {comment:&quot;RESTful Service API&quot;},
   {comment:&quot;J:&quot;},
   ...
 ],

 comment_user: {user_id: &quot;1234&quot;, avatar: &quot;a.jpg&quot;, nickName:&quot;Jeffrey&quot;...}
}
</code></pre><h2 id="考虑启用-HTTP-缓存机制"><a href="#考虑启用-HTTP-缓存机制" class="headerlink" title="考虑启用 HTTP 缓存机制"></a>考虑启用 HTTP 缓存机制</h2><p>HTTP协议本身支持两种缓存机制: ETag 和 Last-Modified。</p>
<ol>
<li>ETag：HTTP 请求中在 header 中包含一个内容的 hash，如果返回结果没有变化，该请求会直接返回304 Not Modified，而不是所有数据内容本身</li>
<li>Last-Modified: 和 Etag 工作原理差不多，只是使用时间戳作为内容是否过期的标志。</li>
</ol>
<p>Nginx：<a href="https://www.nginx.com/blog/nginx-caching-guide/" target="_blank" rel="noopener">A Guide to Caching with NGINX and NGINX Plus</a></p>
<h2 id="限制-API-调用频次（Rate-limiting）"><a href="#限制-API-调用频次（Rate-limiting）" class="headerlink" title="限制 API 调用频次（Rate limiting）"></a>限制 API 调用频次（Rate limiting）</h2><h2 id="尽可能的使用-HTTPS，涉及用户验证的-API-一定要强制启用-HTTPS"><a href="#尽可能的使用-HTTPS，涉及用户验证的-API-一定要强制启用-HTTPS" class="headerlink" title="尽可能的使用 HTTPS，涉及用户验证的 API 一定要强制启用 HTTPS"></a>尽可能的使用 HTTPS，涉及用户验证的 API 一定要强制启用 HTTPS</h2><p>如果你的WEB Server 是 Nginx，在部署了 HTTPS 的情况下，下面两个选项务必仔细设置，因为这个两个简单的设置可以很大程度上避免一些安全问题:</p>
<ol>
<li>ssl_prefer_server_ciphers： 表示服务端加密算法优先于客户端加密算法，主要是<a href="https://en.wikipedia.org/wiki/Downgrade_attack" target="_blank" rel="noopener">防止降级攻击 （downgrade attack）</a></li>
<li>Strict-Transport-Security（HSTS）：告诉浏览器这个域名在指定的时间（max-age）内应该强制使用 HTTPS 访问。</li>
</ol>
<h2 id="Url-design-tricks"><a href="#Url-design-tricks" class="headerlink" title="Url design tricks"></a>Url design tricks</h2><h3 id="Url是区分大小写的"><a href="#Url是区分大小写的" class="headerlink" title="Url是区分大小写的"></a>Url是区分大小写的</h3><ul>
<li>/Posts</li>
<li>/posts</li>
</ul>
<p>指向不同的地址</p>
<h3 id="Back-forward-Slash"><a href="#Back-forward-Slash" class="headerlink" title="Back forward Slash (/)"></a>Back forward Slash (/)</h3><p>目前比较流行的API设计方案，通常建议url以 <code>/</code> 作为结尾,如果API <code>GET</code>请求中，url不以<code>/</code>结尾，则重定向到以<code>/</code>结尾的API上去（这点现在的web框架基本都支持），因为有没有 <code>/</code>，也是两个url</p>
<h3 id="连接符-和-下划线"><a href="#连接符-和-下划线" class="headerlink" title="连接符 - 和 下划线 _"></a>连接符 - 和 下划线 _</h3><p>ESTful API 应具备良好的可读性，当url中某一个片段（segment）由多个单词组成时，建议使用 <code>-</code> 来隔断单词，而不是使用 <code>_</code></p>
<p>原因：浏览器中超链接显示的默认效果是，文字并附带下划线，如果API以_隔断单词，二者会重叠，影响可读性。</p>
<h1 id="服务器返回的数据格式"><a href="#服务器返回的数据格式" class="headerlink" title="服务器返回的数据格式"></a>服务器返回的数据格式</h1><pre><code>{
    code：0,
    message: &quot;success&quot;,
    data: { key1: value1, key2: value2, ... }
}
</code></pre><ul>
<li>code: 返回码，0表示成功，非0表示各种不同的错误</li>
<li>message: 描述信息，成功时为”success”，错误时则是错误信息</li>
<li>data: 成功时返回的数据，类型为对象</li>
</ul>
<p>code错误参考：</p>
<ul>
<li>0：成功</li>
<li>100：请求错误</li>
<li>101：缺少appKey</li>
<li>102：缺少签名</li>
<li>103：缺少参数</li>
<li>200：服务器出错</li>
<li>201：服务不可用</li>
<li>202：服务器正在重启</li>
</ul>
<p>错误信息一般有两种用途：</p>
<ol>
<li>是客户端开发人员调试时看具体是什么错误；</li>
<li>是作为App错误提示直接展示给用户看。</li>
</ol>
<p>参考：</p>
<ul>
<li><a href="http://www.ruanyifeng.com/blog/2011/09/restful.html" target="_blank" rel="noopener">http://www.ruanyifeng.com/blog/2011/09/restful.html</a></li>
<li><a href="https://bourgeois.me/rest/" target="_blank" rel="noopener">https://bourgeois.me/rest/</a></li>
<li><a href="http://keeganlee.me/post/architecture/20160107" target="_blank" rel="noopener">http://keeganlee.me/post/architecture/20160107</a></li>
<li><a href="http://blog.jimmylv.info/2015-11-11-what-is-really-rest/" target="_blank" rel="noopener">http://blog.jimmylv.info/2015-11-11-what-is-really-rest/</a></li>
<li><a href="http://www.jianshu.com/p/cf80d644727e" target="_blank" rel="noopener">http://www.jianshu.com/p/cf80d644727e</a></li>
<li><a href="http://blog.igevin.info/posts/restful-api-get-started-to-write/" target="_blank" rel="noopener">http://blog.igevin.info/posts/restful-api-get-started-to-write/</a></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/08/07/ReadNote/App研发录/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Double">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/head1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Double">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/07/ReadNote/App研发录/" itemprop="url">App 研发录</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-08-07T13:18:12+08:00">
                2016-08-07
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/读书笔记/" itemprop="url" rel="index">
                    <span itemprop="name">读书笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="高效App框架设计与重构"><a href="#高效App框架设计与重构" class="headerlink" title="高效App框架设计与重构"></a>高效App框架设计与重构</h1><h2 id="重构，也未眠"><a href="#重构，也未眠" class="headerlink" title="重构，也未眠"></a>重构，也未眠</h2><h3 id="重新规划Android项目结构"><a href="#重新规划Android项目结构" class="headerlink" title="重新规划Android项目结构"></a>重新规划Android项目结构</h3><p>目前自己项目的目录结构：</p>
<ul>
<li>data</li>
<li>module</li>
<li>net</li>
<li>widgets</li>
<li>util</li>
<li>br</li>
<li>service</li>
<li>permission</li>
</ul>
<p>目的：</p>
<ul>
<li>每个文件只有一个单独类，不要有嵌套</li>
<li>讲Activity按照模块拆分，可以迅速定位到具体页面</li>
</ul>
<p>需要改进的地方：</p>
<pre><code>bean －－》 Entity
</code></pre><h3 id="为Activity定义新的生命周期"><a href="#为Activity定义新的生命周期" class="headerlink" title="为Activity定义新的生命周期"></a>为Activity定义新的生命周期</h3><p>单一职责：一个类或者一个方法，只做一件事。</p>
<p>书中推荐：</p>
<pre><code>onCreate() 拆分出三个方法：
initVariables();
initViews(savedInstanceState);
loadData();
</code></pre><h3 id="统一事件编程模型"><a href="#统一事件编程模型" class="headerlink" title="统一事件编程模型"></a>统一事件编程模型</h3><p>书中推荐在写点击事件的时候使用内部类。</p>
<p>个人推荐使用Butterknife实现点击事件</p>
<h3 id="实体化编程"><a href="#实体化编程" class="headerlink" title="实体化编程"></a>实体化编程</h3><h4 id="在网络请求中使用实体"><a href="#在网络请求中使用实体" class="headerlink" title="在网络请求中使用实体"></a>在网络请求中使用实体</h4><p>书中举了一个反例：讲网络请求返回的数据包装程JSONObject／JSONArray，在项目中直接使用，需要跨Activity传递数据时还将对象封装成全局的。</p>
<p>书中推荐：使用自定义class将网络数据进行转化。配合GSON</p>
<p>需要避免混淆：</p>
<pre><code>-keepattributes Signature // 不混淆泛型
-keepattributes *Annotation* // 不混淆注解
</code></pre><h4 id="实体生成器"><a href="#实体生成器" class="headerlink" title="实体生成器"></a>实体生成器</h4><p>推荐一个插件：GsonFormat,利用json数据快速生成实体类</p>
<h4 id="在页面跳转中使用实体类"><a href="#在页面跳转中使用实体类" class="headerlink" title="在页面跳转中使用实体类"></a>在页面跳转中使用实体类</h4><ol>
<li><p>方法一：对象全全局化</p>
<blockquote>
<p>书中使用的是使用自定义的一个全局对象来引用实体类对象，app切换到后台的时候，如果内存不足，全局变量就会被回收不推荐使用。<br> 目前如果App需要有全局参数或者变量，推荐使用自定义的Application对象来引用</p>
</blockquote>
</li>
<li><p>方法二：Intent传值</p>
<p> 需要对象实现序列化<br> 推荐一个序列化插件：Android Parcelable code generator</p>
</li>
</ol>
<h3 id="Adapter-模版"><a href="#Adapter-模版" class="headerlink" title="Adapter 模版"></a>Adapter 模版</h3><h3 id="类型安全转换函数"><a href="#类型安全转换函数" class="headerlink" title="类型安全转换函数"></a>类型安全转换函数</h3><p>常出现的错误：</p>
<ol>
<li><p>Object类型对象,对其直接使用字符串操作函数toString，如果为null就会奔溃</p>
<pre><code>int result = Integer.valueOf(obj.toString());
</code></pre><p> 解决方法：编写一个类型安全转换函数convertToInt：</p>
<pre><code>public final static int convertToInt(Object value, int defaultValue){
    if(value==null || &quot;&quot;.equals(valur.toString().trim())){
        return defaultValue;
    }
    try{
        return Integer.valueOf(value.toString());
    } catch (Exception e){
        try{
            return Double.valueOf(value.toString()).intValue();
        } catch (Exception e1){
            return defaultValue;
        }
    }
}
</code></pre><p> 最后使用：</p>
<pre><code>int result = Utils.convertToInt(obj, 0);
</code></pre><p> Utils类中还需要自定义其他的类型转换安全函数。</p>
</li>
<li><p>如果长度不够，substring函数时就会奔溃</p>
<p> 加<code>try..catch</code>处理<br> 不同数据不同处理：1. 不需要加工的数据：数据为空，或者长度符合要求，直接显示。 2. 对于重要数据：比如金额不能为空，应该弹出窗口提示用户</p>
</li>
</ol>
<h2 id="Android-网络底层框架设计"><a href="#Android-网络底层框架设计" class="headerlink" title="Android 网络底层框架设计"></a>Android 网络底层框架设计</h2><h2 id="Android-经典场景设计"><a href="#Android-经典场景设计" class="headerlink" title="Android 经典场景设计"></a>Android 经典场景设计</h2><h3 id="App-图片缓存设计"><a href="#App-图片缓存设计" class="headerlink" title="App 图片缓存设计"></a>App 图片缓存设计</h3><p>书中介绍了ImageLoader,Fresco</p>
<p>本人使用的是Glide</p>
<h3 id="对网络流量进行优化"><a href="#对网络流量进行优化" class="headerlink" title="对网络流量进行优化"></a>对网络流量进行优化</h3><h4 id="通信层面优化"><a href="#通信层面优化" class="headerlink" title="通信层面优化"></a>通信层面优化</h4><ol>
<li>接口返回的数据压缩：gzip</li>
<li>新的数据传输协议 ProtoBuffer</li>
<li>避免频繁发起请求，能一次请求完的就尽量一次解决</li>
<li>TCP长连接，提高访问速度</li>
<li><strong>建立取消网络请求机制</strong></li>
<li>增加重试机制：为get请求建立重试，不要为post请求建立重试</li>
</ol>
<h4 id="图片策略优化"><a href="#图片策略优化" class="headerlink" title="图片策略优化"></a>图片策略优化</h4><ol>
<li><p>确保下载的图片，符合ImageView控件的大小</p>
<p> 在请求中设置需要的width，height</p>
</li>
<li><p>低流量模式</p>
<p> 请求中quality</p>
</li>
<li><p>极速模式</p>
</li>
</ol>
<h3 id="城市列表的设计"><a href="#城市列表的设计" class="headerlink" title="城市列表的设计"></a>城市列表的设计</h3><p>P61</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/07/29/ReadNote/设计模式/包装模式/设计模式之蝉-门面模式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Double">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/head1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Double">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/07/29/ReadNote/设计模式/包装模式/设计模式之蝉-门面模式/" itemprop="url">设计模式之蝉 - 门面模式</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-07-29T21:38:14+08:00">
                2016-07-29
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/读书笔记/" itemprop="url" rel="index">
                    <span itemprop="name">读书笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h1 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h1><h2 id="0"><a href="#0" class="headerlink" title="0"></a>0</h2><p>写信</p>
<p>ILetterProcess:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ILetterProcess</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">writeContext</span><span class="params">(String context)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fillEnvelope</span><span class="params">(String address)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">letterInotoEnvelope</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendLetter</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2016/07/29/ReadNote/设计模式/包装模式/设计模式之蝉-门面模式/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/07/23/ReadNote/设计模式/行为设计模式/设计模式之蝉-迭代器模式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Double">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/head1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Double">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/07/23/ReadNote/设计模式/行为设计模式/设计模式之蝉-迭代器模式/" itemprop="url">设计模式之蝉 - 迭代器模式</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-07-23T21:38:14+08:00">
                2016-07-23
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/读书笔记/" itemprop="url" rel="index">
                    <span itemprop="name">读书笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h1 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h1><h1 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h1><p>迭代器模式目前已经是一个没落的模式。</p>
<p>Provide a way to access the elements of an aggregate objects sequentialy without exposing its underlying representation.</p>
<p>它提供一种方法访问一个容器对象中各个元素，而又不需暴露该对象的内部细节。</p>
<p>迭代器是为容器服务的。比如 Collection，Set 等</p>
<ul>
<li>Iterator 抽象迭代器：基本的固有方法 <code>first()</code>, <code>next()</code>, <code>isDone()/hasNext()</code></li>
<li>ConcreteIterator</li>
<li>Aggregate 抽象容器</li>
<li>Concrete Aggregate 具体容器</li>
</ul>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2016/07/23/ReadNote/设计模式/行为设计模式/设计模式之蝉-迭代器模式/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/35/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/35/">35</a><span class="page-number current">36</span><a class="page-number" href="/page/37/">37</a><span class="space">&hellip;</span><a class="page-number" href="/page/55/">55</a><a class="extend next" rel="next" href="/page/37/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="/head1.jpg" alt="Double">
          <p class="site-author-name" itemprop="name">Double</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">548</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">24</span>
                <span class="site-state-item-name">categories</span>
              
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">260</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Double</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  





  






  





  

  

  

  

  

  

</body>
</html>
