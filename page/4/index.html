<!doctype html>



  


<html class="theme-next muse use-motion" lang>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css">


  <meta name="keywords" content="Hexo, NexT">








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1">






<meta property="og:type" content="website">
<meta property="og:title" content="Double">
<meta property="og:url" content="http://yoursite.com/page/4/index.html">
<meta property="og:site_name" content="Double">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Double">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/4/">





  <title>Double</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Double</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/26/server/knowledge/JWT/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Double">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/head1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Double">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/26/server/knowledge/JWT/" itemprop="url">JWT</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-26T13:18:12+08:00">
                2019-09-26
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Server/" itemprop="url" rel="index">
                    <span itemprop="name">Server</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="是什么"><a href="#是什么" class="headerlink" title="是什么"></a>是什么</h1><p>JWT: JSON Web Token</p>
<ol>
<li>是一种规范，数据格式</li>
<li>使用数字签名保证数据完整性，可以使用 HMAC 签名或者非对称加密 RSA ECDSA.</li>
</ol>
<h1 id="什么时候使用"><a href="#什么时候使用" class="headerlink" title="什么时候使用"></a>什么时候使用</h1><ol>
<li>Authorization: 最常用的方式，在请求头里添加 Authorization</li>
<li>Information Exchange: 数据传输</li>
</ol>
<h1 id="JWT-数据结构"><a href="#JWT-数据结构" class="headerlink" title="JWT 数据结构"></a>JWT 数据结构</h1><p>JWT 包含:</p>
<ol>
<li>Header</li>
<li>Payload</li>
<li>Signature</li>
</ol>
<p>中间用 <code>.</code> 分割: <code>xxxxx.yyyyy.zzzzz</code></p>
<h2 id="Header"><a href="#Header" class="headerlink" title="Header"></a>Header</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;alg&quot;: &quot;HS256&quot;,</span><br><span class="line">  &quot;typ&quot;: &quot;JWT&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>头经过 <code>Base64Url</code> 处理</p>
<h2 id="Payload"><a href="#Payload" class="headerlink" title="Payload"></a>Payload</h2><p>自定义数据存储位置, 包含3部分: registered, public, private</p>
<ul>
<li>Registered claims, 包含: <code>iss(issuer), exp(expiration time), sub(subject), aud(audience), other</code></li>
</ul>
<p>这里名称都是3个字母，为了简化。</p>
<ul>
<li>Public claims: </li>
<li>Private claims</li>
</ul>
<p>例子:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"sub"</span>: <span class="string">"1234567890"</span>,</span><br><span class="line">  <span class="string">"name"</span>: <span class="string">"Double"</span>,</span><br><span class="line">  <span class="string">"admin"</span>: <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Payload 数据经过 <code>Base64URL</code> 处理</p>
<p><strong>这里的数据都是公开的所以不能存储私密数据</strong></p>
<h2 id="Signature"><a href="#Signature" class="headerlink" title="Signature"></a>Signature</h2><p>签名</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">HMACSHA256(</span><br><span class="line">  base64UrlEncode(header) + <span class="string">"."</span> +</span><br><span class="line">  base64UrlEncode(payload),</span><br><span class="line">  secret)</span><br></pre></td></tr></table></figure>
<p>保证数据不会被修改。</p>
<h1 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h1><p>其他几种 token，SWT Simple Web Tokens, SAML Security Assertion Markup Language Tokens.</p>
<ol>
<li>JSON 数据格式简介，支持的语言更多同时在 JS 中可以直接转成对象，比 SAML 中 XML 强</li>
<li>支持非对称加密，SWT 只支持 HMAC。</li>
<li>支持多种客户端(moblie, pc)</li>
</ol>
<h1 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a>最佳实践</h1><h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><h3 id="注销和修改密码"><a href="#注销和修改密码" class="headerlink" title="注销和修改密码"></a>注销和修改密码</h3><blockquote>
<p>目前没有完美方案，没有官方推荐方案</p>
</blockquote>
<p>用户修改密码后，原来的 JWT 还是有效的。</p>
<p>客户端退出清空 JWT 后，原来的 JWT 还是有效的。</p>
<p>方案一：使用 radis 存储 JWT, 实现服务器端销毁 JWT, 但是这样做就和 Session 有点像了</p>
<p>方案二：维护一个 token 黑名单，失效的加入到 token 中</p>
<p>方案三：每个用户设置独立的加密 key，失效就修改 key</p>
<h3 id="续签"><a href="#续签" class="headerlink" title="续签"></a>续签</h3><p>方案一：每次请求刷新 JWT(肯定不行)</p>
<p>方案二：refreshToken 方案，在返回 token 同时生成一个时间长的 refreshToken 用户刷行 token 时使用; token 过期时 返回指定 code, 提示客户端调用指定接口刷新(JWT)</p>
<blockquote>
<p>微信某个 sdk 中使用了这种方案</p>
</blockquote>
<h2 id="安全相关"><a href="#安全相关" class="headerlink" title="安全相关"></a>安全相关</h2><ol>
<li>保护签名密钥</li>
<li>JWT 不保存敏感数据</li>
<li>防止永生 token</li>
<li>防止 url 缓存攻击</li>
</ol>
<p>确保不通用户的用户信息包含在 url 中，并在服务器验证, 如users?jwt=xxx–&gt;users?cid=xx&amp;wjt=xxx</p>
<ol start="5">
<li>日志敏感</li>
</ol>
<p>在日志中可以存储 JWT 中的数据，但是不直接存储 JWT.</p>
<ol start="6">
<li>不建议以无签名算法的方式（签名算法为none）来颁发JWT token</li>
<li>更安全的方式，考虑使用非对称加密创建 token</li>
<li>Web JWT 安全, toen 存储在 Cookie 是加上 HttpOnly 和 Secure 标记(HttpOnly保证JavaScript无法获取该Cookie，而Secure标记将保证该Cookie信息只能通过Https传输),但注意Cookie的方式可能会引起CSRF（跨站请求伪造）攻击；token可以存放到sessionStorage/localStorage，但注意XSS（跨站点脚本）攻击；</li>
<li>Api 防重放机制(接口被用户截获后恶意重复请求)。</li>
</ol>
<p>方式一：(推荐)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">可以在claim中 添加 现时标志(jti claim)、过期时间(exp claim)以及创建时间(iat claim)</span><br></pre></td></tr></table></figure>
<p>方式二：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">常用的防止重放的机制是使用 timestamp 和 nonce 来做的重放机制。</span><br><span class="line"></span><br><span class="line">timestamp 用来表示请求的当前时间戳</span><br><span class="line"></span><br><span class="line">nonce 是由客户端根据足够随机的情况生成的，比如 md5 (timestamp+rand (0, 1000)); 它就有一个要求，正常情况下，在短时间内（比如 60s）连续生成两个相同 nonce 的情况几乎为 0。</span><br><span class="line"></span><br><span class="line">服务端</span><br><span class="line">服务端第一次在接收到这个 nonce 的时候做下面行为：</span><br><span class="line">1 去 redis 中查找是否有 key 为 nonce:&#123;nonce&#125; 的 string</span><br><span class="line">2 如果没有，则创建这个 key，把这个 key 失效的时间和验证 timestamp 失效的时间一致，比如是 60s。</span><br><span class="line">3 如果有，说明这个 key 在 60s 内已经被使用了，那么这个请求就可以判断为重放请求。</span><br></pre></td></tr></table></figure>
<p>参考：</p>
<ol>
<li><a href="https://jwt.io/introduction/" target="_blank" rel="noopener">https://jwt.io/introduction/</a></li>
<li><a href="https://liming.pub/post/jwt/" target="_blank" rel="noopener">https://liming.pub/post/jwt/</a></li>
<li><a href="http://blog.didispace.com/learn-how-to-use-jwt-xjf/" target="_blank" rel="noopener">http://blog.didispace.com/learn-how-to-use-jwt-xjf/</a></li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/22/database/mysql/mysql知识点合集/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Double">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/head1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Double">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/22/database/mysql/mysql知识点合集/" itemprop="url">MySQL记录</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-22T13:18:12+08:00">
                2019-09-22
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Database/" itemprop="url" rel="index">
                    <span itemprop="name">Database</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h1><ol>
<li>对数据建立目录字典，达到快速查找数据的作用。</li>
<li>运用在表中某些字段上，但是存储时，独立于表之外</li>
<li>拿空间换时间</li>
</ol>
<p>索引特点:</p>
<ol>
<li>用户不需要在 sql 中指定使用哪个索引</li>
<li>定义了 primary key 和 unique 约束时会自动在对应列上创建索引</li>
<li>用户可以按照需要对指定列创建索引</li>
</ol>
<p><strong>什么时候要索引:</strong></p>
<ol>
<li>表经常进行 查询/select 操作</li>
<li>表很大，记录内容分布范围广</li>
<li>列名经常出现在 where 子句或连接条件中</li>
</ol>
<p><strong>什么时候不要索引:</strong></p>
<ol>
<li>表经常进行 增/删/改 insert/update/delete 操作</li>
<li>表很小</li>
<li>列名不常作为连接条件或出现在where子句中</li>
</ol>
<p><strong>优缺点</strong></p>
<ol>
<li>加快查询速度，降低插入 删除 修改速度(因为增删改同时要维护索引所以慢)</li>
<li>索引占用物理和数据空间</li>
</ol>
<p><strong>索引分类:</strong></p>
<ol>
<li>唯一索引</li>
<li>主键索引</li>
<li>聚集索引</li>
<li>非聚集索引</li>
</ol>
<h1 id="事务隔离级别"><a href="#事务隔离级别" class="headerlink" title="事务隔离级别"></a>事务隔离级别</h1><p>事务4基本要素: ACID, 原子性 Atomicity, 一致性 Consistency, 隔离性 Isolation, 持久性 Durability</p>
<ol>
<li>Serializable 可串行【可避免脏读，不可重复读，虚读】</li>
<li>Repeatable read 可重复读【可避免脏读，不可重复读】</li>
<li>Read committed 读已提交 【可避免脏读】</li>
<li>Read uncommitted 读未提交【级别最低，什么都避免不了】</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">TRANSACTION_READ_UNCOMMITTED</span><br><span class="line">TRANSACTION_READ_COMMITTED</span><br><span class="line">TRANSACTION_REPEATABLE_READ</span><br><span class="line">TRANSACTION_SERIALIZABLE</span><br></pre></td></tr></table></figure>
<ol>
<li>赃读: 一个事务读取到另一个事务未提交的数据</li>
</ol>
<p>例子：A给B转账，A 还没有提交事务，B 已经能读取到金额增加的数据了。但是实际上不能保证 A 转账成功。</p>
<ol start="2">
<li>不可重复读: 一个事务读取到另外一个事务已经提交的数据，也就是说一个事务可以看到其他事务所做的修改</li>
</ol>
<p>例子：A 事务开始和结束是都读取了一个数据，但是 B 事务<strong>修改</strong>了数据并提交了，导致 A 事务两次读取的数据不一致</p>
<ol start="3">
<li>虚读/幻读: 是指在一个事务内读取到了别的事务插入的数据，导致前后读取不一致。</li>
</ol>
<p>例子：A 事务开始和结束是都读取了一个数据，但是 B 事务<strong>插入</strong>了数据并提交了，导致 A 事务两次读取的数据不一致</p>
<blockquote>
<p>脏读是不可容忍的，不可重复读和虚读在一定的情况下是可以的【做统计的肯定就不行】。</p>
</blockquote>
<h1 id="数据库乐观锁和悲观锁"><a href="#数据库乐观锁和悲观锁" class="headerlink" title="数据库乐观锁和悲观锁"></a>数据库乐观锁和悲观锁</h1><h1 id="question"><a href="#question" class="headerlink" title="question"></a>question</h1><h2 id="Access-denied-for-user-‘root‘-’localhost’-using-password-YES"><a href="#Access-denied-for-user-‘root‘-’localhost’-using-password-YES" class="headerlink" title="Access denied for user ‘root‘@’localhost’ (using password: YES)"></a>Access denied for user ‘root‘@’localhost’ (using password: YES)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; mysql -u root -p</span><br><span class="line"></span><br><span class="line">Access denied for user &apos;root&apos;@&apos;localhost&apos; (using password: YES)</span><br><span class="line"></span><br><span class="line">mysql 密码错误</span><br></pre></td></tr></table></figure>
<p>参考:</p>
<ol>
<li><a href="https://juejin.im/post/5a9ca0d6518825555c1d1acd#heading-38" target="_blank" rel="noopener">https://juejin.im/post/5a9ca0d6518825555c1d1acd#heading-38</a></li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/05/Android/Android 版本/Android10.0/android-10.0-news/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Double">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/head1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Double">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/05/Android/Android 版本/Android10.0/android-10.0-news/" itemprop="url">Android10.0 新内容</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-05T22:38:14+08:00">
                2019-09-05
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/" itemprop="url" rel="index">
                    <span itemprop="name">Android</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="新特性"><a href="#新特性" class="headerlink" title="新特性"></a>新特性</h1><ol>
<li>折叠屏</li>
<li>5g</li>
<li>全面屏手势支持</li>
<li>通知栏</li>
<li>黑色模式</li>
<li>ART 优化</li>
</ol>
<h1 id="Behavior-chagnes-for-apps"><a href="#Behavior-chagnes-for-apps" class="headerlink" title="Behavior chagnes for apps"></a>Behavior chagnes for apps</h1><p><a href="https://developer.android.com/about/versions/10/behavior-changes-all" target="_blank" rel="noopener">https://developer.android.com/about/versions/10/behavior-changes-all</a></p>
<ol>
<li>限制 sdk 不支持的方法</li>
</ol>
<p>检查 app 是否使用了 sdk 不支持的方法: <a href="https://developer.android.com/distribute/best-practices/develop/restrictions-non-sdk-interfaces#test-for-non-sdk" target="_blank" rel="noopener">检测限制的方法</a></p>
<ol start="2">
<li>手势导航功能</li>
</ol>
<p>比如：测滑返回功能</p>
<ol start="3">
<li><p>相机使用 Activity 需要添加 <code>android:resizeableActivity</code> 适配多窗口模式</p>
</li>
<li><p>折叠屏幕适配</p>
</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/05/Android/Android 版本/Android9.0-P/android-9.0-news/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Double">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/head1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Double">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/05/Android/Android 版本/Android9.0-P/android-9.0-news/" itemprop="url">Android9.0 新内容</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-05T22:38:14+08:00">
                2019-09-05
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/" itemprop="url" rel="index">
                    <span itemprop="name">Android</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ol>
<li>Notification</li>
<li></li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/05/ReadNote/深入浅出Node/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Double">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/head1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Double">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/05/ReadNote/深入浅出Node/" itemprop="url">Node.js 深入浅出笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-05T21:38:14+08:00">
                2019-09-05
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/读书笔记/" itemprop="url" rel="index">
                    <span itemprop="name">读书笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="第-1-章-Node-简介"><a href="#第-1-章-Node-简介" class="headerlink" title="第 1 章 Node 简介"></a>第 1 章 Node 简介</h1><h2 id="1-1-Node-历程"><a href="#1-1-Node-历程" class="headerlink" title="1.1 Node 历程"></a>1.1 Node 历程</h2><ol>
<li>2009 5 月发布最初版本</li>
</ol>
<h2 id="1-2-why-JavaScript"><a href="#1-2-why-JavaScript" class="headerlink" title="1.2 why JavaScript"></a>1.2 why JavaScript</h2><p>设计者认为, 设计高性能 web 服务器的要点: 事件驱动, 非阻塞 I/O</p>
<p>JavaScript 本身就是事件驱动的</p>
<h2 id="Node-给-JavaScript-带来的意义"><a href="#Node-给-JavaScript-带来的意义" class="headerlink" title="Node 给 JavaScript 带来的意义"></a>Node 给 JavaScript 带来的意义</h2><p><img src="https://raw.githubusercontent.com/fangmd/markdownphoto/master/src/node/chrome-node.jpg" alt="https://raw.githubusercontent.com/fangmd/markdownphoto/master/src/node/chrome-node.jpg"></p>
<h2 id="1-4-Node-的特点"><a href="#1-4-Node-的特点" class="headerlink" title="1.4 Node 的特点"></a>1.4 Node 的特点</h2><ol>
<li>异步 I/O</li>
</ol>
<p>异步调用：Don’t call me, I will call you.</p>
<p>异步任务结束后，自动执行回调函数</p>
<ol start="2">
<li><p>事件与回调函数</p>
</li>
<li><p>单线程</p>
</li>
</ol>
<p>单线程执行代码，不需要在意多线程中的状态同步问题，没有死锁的存在，也没有线程上下文交换带来的性能开销。</p>
<p>单线程弱点: 无法利用多核CPU; 错误会引起整个应用退出; 大量计算占用CPU导致无法继续调用异步I/O</p>
<p><strong>大量计算占用CPU问题处理方案:</strong></p>
<p>Google 采用 Web Workers 创建工作线程来执行计算任务。Node 使用类似思路 child_process 子进程处理大量计算任务。</p>
<p>通过 Master-Worker 管理各个工作进程.</p>
<ol start="4">
<li>跨平台</li>
</ol>
<p>Node 基于 libuv 实现跨平台。</p>
<h2 id="1-5-Node-的应用场景"><a href="#1-5-Node-的应用场景" class="headerlink" title="1.5 Node 的应用场景"></a>1.5 Node 的应用场景</h2><ol>
<li>I/O 密集型</li>
<li>与老后台系统共存</li>
<li>分布式应用</li>
</ol>
<h1 id="第-2-章-模块机制"><a href="#第-2-章-模块机制" class="headerlink" title="第 2 章 模块机制"></a>第 2 章 模块机制</h1><h2 id="2-1-CommonJS-规范"><a href="#2-1-CommonJS-规范" class="headerlink" title="2.1 CommonJS 规范"></a>2.1 CommonJS 规范</h2><p>涵盖内容：模块，二进制，Buffer，字符集编码，I/O 流，进程环境，文件系统，套接字，单元测试，web 服务器网关接口，包管理 等.</p>
<h2 id="2-2-Node-模块实现"><a href="#2-2-Node-模块实现" class="headerlink" title="2.2 Node 模块实现"></a>2.2 Node 模块实现</h2><p>exports, require, module</p>
<p>模块分为: Node 提供的 核心模块；用户编写的 文件模块.</p>
<p>Node 引入模块需要经历的步骤:</p>
<ol>
<li>路径分析</li>
<li>文件定位</li>
<li>编译执行</li>
</ol>
<p><strong>优先从缓存加载:</strong> Node 会缓存编译执行后的模，便于再次使用。 优先级最高</p>
<blockquote>
<p>核心模块通常已经编译成二进制加入到源代码中，所以在使用的时候不需要 路径分析和文件定位 的步骤。</p>
</blockquote>
<p>编译过程可以识别: <code>.js</code>, <code>.node</code>, <code>.json</code> 文件。</p>
<h2 id="2-6-包与NPM"><a href="#2-6-包与NPM" class="headerlink" title="2.6 包与NPM"></a>2.6 包与NPM</h2><p>CommonJS 对包定义了规范。</p>
<h3 id="包结构"><a href="#包结构" class="headerlink" title="包结构"></a>包结构</h3><ol>
<li>package.json</li>
<li>bin: 可执行二进制文件</li>
<li>lib: js 源码</li>
<li>doc</li>
<li>test</li>
</ol>
<h1 id="第-3-章-异步I-O"><a href="#第-3-章-异步I-O" class="headerlink" title="第 3 章 异步I/O"></a>第 3 章 异步I/O</h1><h2 id="3-1-为什么要异步"><a href="#3-1-为什么要异步" class="headerlink" title="3.1 为什么要异步"></a>3.1 为什么要异步</h2><ol>
<li>用户体验</li>
</ol>
<p>可以同时读取多个文件并减少等待时间。</p>
<p>后端可以快速响应资源，才能让前端的体验变好。</p>
<ol start="2">
<li>资源分配</li>
</ol>
<p>在执行多个不相关任务的时候。</p>
<p>单线程同步编程模型因阻塞I/O导致硬件资源得不到使用。多线程编程模型因为编程中的死锁，状态同步等问题提高编程难度。</p>
<p>Node 使用 单线程，异步I/O 更好执行多个不相关任务。</p>
<h2 id="3-2-异步-I-O-实现现状"><a href="#3-2-异步-I-O-实现现状" class="headerlink" title="3.2 异步 I/O 实现现状"></a>3.2 异步 I/O 实现现状</h2><h2 id="3-3-Node-的异步-I-O"><a href="#3-3-Node-的异步-I-O" class="headerlink" title="3.3 Node 的异步 I/O"></a>3.3 Node 的异步 I/O</h2><h3 id="3-3-1-事件循环"><a href="#3-3-1-事件循环" class="headerlink" title="3.3.1 事件循环"></a>3.3.1 事件循环</h3><p>Node 执行模型：事件循环</p>
<p>一次循环称为: Tick</p>
<p>一次循环: 取出事件，处理回调(没有事件就 退出)</p>
<p>在不通的平台，事件循环实现方式不同: windows IOCP, *nix 基于多线程创建</p>
<h3 id="3-3-2-观察者"><a href="#3-3-2-观察者" class="headerlink" title="3.3.2 观察者"></a>3.3.2 观察者</h3><p>Tick 过程中，使用 <strong>观察者</strong> 判断是否有事件需要处理</p>
<p>定时器会插入到观察者中，观察者内部数据结构是 红黑树。</p>
<h3 id="3-3-3-请求对象"><a href="#3-3-3-请求对象" class="headerlink" title="3.3.3 请求对象"></a>3.3.3 请求对象</h3><p>JS 将异步任务封装成一个请求对象，交给底层异步处理模块处理。</p>
<p>Windows 底层是 I/O 线程池中的线程去处理 异步任务。</p>
<h3 id="3-3-4-执行回调"><a href="#3-3-4-执行回调" class="headerlink" title="3.3.4 执行回调"></a>3.3.4 执行回调</h3><h2 id="3-4-非-I-O-的异步-API"><a href="#3-4-非-I-O-的异步-API" class="headerlink" title="3.4 非 I/O 的异步 API"></a>3.4 非 I/O 的异步 API</h2><p><code>setTimeout</code>, <code>setInterval()</code>, <code>setImmediate()</code>, <code>process.nextTick()</code></p>
<h3 id="process-nextTick"><a href="#process-nextTick" class="headerlink" title="process.nextTick()"></a>process.nextTick()</h3><p>如果要立即异步执行一个任务:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">setTimeout(function()&#123;</span><br><span class="line">  //TODO</span><br><span class="line">&#125;, 0);</span><br></pre></td></tr></table></figure>
<p>这种方式浪费性能。</p>
<p><code>process.nextTick</code> 内部实现是将回调函数放入队列(数组)，下一轮 Tick 时取出执行，不经过红黑树，更高效。</p>
<h3 id="setImmediate"><a href="#setImmediate" class="headerlink" title="setImmediate()"></a>setImmediate()</h3><p>优先级:<code>process.nextTick()</code> &gt; <code>setTimmediate()</code></p>
<p>原因：事件循环观察者的检查有先后顺序。<code>process.nextTick()</code> 属于 idle 观察者，<code>setImmediate()</code> 属于 check 观察者。在每一轮检查中 idle 观察者 &gt; I/O 观察者 &gt; check 观察者</p>
<p>一个 Tick 中，<code>setImmediate()</code> 只会执行一个，另一个会等待下一个 Tick 执行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">// 加入两个nextTick()的回调函数 </span><br><span class="line">process.nextTick(function () &#123;</span><br><span class="line">  console.log(&apos;nextTick延迟执行1&apos;); </span><br><span class="line">&#125;); </span><br><span class="line"></span><br><span class="line">process.nextTick(function () &#123;</span><br><span class="line">  console.log(&apos;nextTick延迟执行2&apos;); </span><br><span class="line">&#125;); </span><br><span class="line"></span><br><span class="line">// 加入两个setImmediate()的回调函数 </span><br><span class="line">setImmediate(function () &#123; </span><br><span class="line">    console.log(&apos;setImmediate延迟执行1&apos;); </span><br><span class="line">    // 进入下次循环 </span><br><span class="line">    process.nextTick(function () &#123;</span><br><span class="line">        console.log(&apos;强势插入&apos;); </span><br><span class="line">    &#125;); </span><br><span class="line">&#125;); </span><br><span class="line"></span><br><span class="line">setImmediate(function () &#123;</span><br><span class="line">  console.log(&apos;setImmediate延迟执行2&apos;); </span><br><span class="line">&#125;); </span><br><span class="line">console.log(&apos;正常执行&apos;);</span><br><span class="line"></span><br><span class="line">其执行结果如下：</span><br><span class="line"></span><br><span class="line">正常执行 </span><br><span class="line">nextTick延迟执行1 </span><br><span class="line">nextTick延迟执行2 </span><br><span class="line">setImmediate延迟执行1 </span><br><span class="line">强势插入 </span><br><span class="line">setImmediate延迟执行2</span><br></pre></td></tr></table></figure>
<h2 id="3-5-事件驱动与高性能服务器"><a href="#3-5-事件驱动与高性能服务器" class="headerlink" title="3.5 事件驱动与高性能服务器"></a>3.5 事件驱动与高性能服务器</h2><p><img src="https://raw.githubusercontent.com/fangmd/markdownphoto/master/src/node/ode-web-flow.jpg" alt="https://raw.githubusercontent.com/fangmd/markdownphoto/master/src/node/node-web-flow.jpg"></p>
<h1 id="第-4-章-异步编程"><a href="#第-4-章-异步编程" class="headerlink" title="第 4 章 异步编程"></a>第 4 章 异步编程</h1><h2 id="4-1-函数式编程"><a href="#4-1-函数式编程" class="headerlink" title="4.1 函数式编程"></a>4.1 函数式编程</h2><ol>
<li>高阶函数</li>
</ol>
<p>将函数作为返回值</p>
<p>例子: Array.forEach, map, reduce…</p>
<h2 id="4-2-异步编程的优势与难点"><a href="#4-2-异步编程的优势与难点" class="headerlink" title="4.2 异步编程的优势与难点"></a>4.2 异步编程的优势与难点</h2><p>难点:</p>
<ol>
<li>异常处理</li>
<li>函数嵌套过深</li>
<li>阻塞代码</li>
<li>多线程编程</li>
</ol>
<p>单一线程执行，在游览器中指 JavaScript 执行线程与UI渲染线程是同一个线程。</p>
<ol start="5">
<li>异步转同步</li>
</ol>
<h2 id="4-3-异步编程解决方案"><a href="#4-3-异步编程解决方案" class="headerlink" title="4.3 异步编程解决方案"></a>4.3 异步编程解决方案</h2><ol>
<li>事件发布/订阅模式</li>
<li>promise/Deferred 模式</li>
<li>流程控制库</li>
</ol>
<h3 id="事件发布-订阅模式"><a href="#事件发布-订阅模式" class="headerlink" title="事件发布/订阅模式"></a>事件发布/订阅模式</h3><p>发布/订阅模式: 事件监听器模式是一种广泛用于异步编程的模式，是回调函数的事件化。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">emitter.on(<span class="string">'event1'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">msg</span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(msg);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">emitter.emit(<span class="string">'event1'</span>, <span class="string">'I am message!'</span>);</span><br></pre></td></tr></table></figure>
<p>可以实现事件与多个回调函数关联，这些回调函数也称为 事件侦听器。</p>
<p>发布/订阅模式用于也常常用于解耦业务逻辑。</p>
<ol>
<li><p>继承 events。EventEmitter 类 实现发布/订阅模式</p>
</li>
<li><p>利用事件队列解决雪崩问题</p>
</li>
</ol>
<p>利用 <code>once</code> 过滤重复性事件。</p>
<blockquote>
<p>EventEmitter ，默认设置了监听器的数量限制，如果使用可能需要先去除限制。</p>
</blockquote>
<ol start="3">
<li>多异步之间的协作方案</li>
</ol>
<p>如何实现并行调用，串行执行。</p>
<p>引入第三方函数和第三方变量处理异步协作的结果。 <strong>哨兵变量</strong></p>
<p>结合闭包</p>
<h3 id="4-3-2-Promise-Deferred-模式"><a href="#4-3-2-Promise-Deferred-模式" class="headerlink" title="4.3.2 Promise/Deferred 模式"></a>4.3.2 Promise/Deferred 模式</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$.<span class="keyword">get</span>('/api`, &#123;</span><br><span class="line">  success: onSuccess,</span><br><span class="line">  error: onError,</span><br><span class="line">  complete: onComplete</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">$.<span class="keyword">get</span>('/api')</span><br><span class="line">  .success(onSuccess)</span><br><span class="line">  .error(onError)</span><br><span class="line">  .complete(onComplete)</span><br></pre></td></tr></table></figure>
<ol>
<li>通过 Deferred 对象可以处理多个业务逻辑。</li>
<li>缓解嵌套</li>
</ol>
<p><strong>Promises/A</strong> 模式</p>
<h3 id="4-3-3-流程控制库"><a href="#4-3-3-流程控制库" class="headerlink" title="4.3.3 流程控制库"></a>4.3.3 流程控制库</h3><ol>
<li>尾触发与 next</li>
</ol>
<p>Node Connect 模块中使用了这种模式。</p>
<p>最简单的中间件:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> app = connect();</span><br><span class="line"><span class="comment">// middleware</span></span><br><span class="line">app.use(connect.staticCache());</span><br><span class="line">app.listen(<span class="number">3001</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// other.js</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> (<span class="params">req, res, next</span>)</span>&#123;</span><br><span class="line">  <span class="comment">// 中间件</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>async</li>
</ol>
<p>最知名的流程控制模块 async.</p>
<p><strong>异步的串行执行:</strong> <code>async.series()</code></p>
<p><strong>异步的并行执行:</strong> <code>async.parallel()</code> 同时拿到多个并行处理的结果</p>
<p><strong>异步调用的依赖处理:</strong> <code>async.waterfall()</code> </p>
<ol start="3">
<li>Step</li>
</ol>
<h2 id="4-4-异步并发控制"><a href="#4-4-异步并发控制" class="headerlink" title="4.4 异步并发控制"></a>4.4 异步并发控制</h2><p>在使用异步的时候，要防止开启过多异步，防止文件系统进行大量并发调用。</p>
<ol>
<li>bagpipe 解决方案</li>
</ol>
<p>通过队列来控制并发量<br>如果当前活跃的异步并发量小于限定值，从队列中取出执行<br>如果活跃调用达到限定值，调用暂时存放在队列中<br>每个异步调用结束时，从队列中取出新的异步调用执行</p>
<ol start="2">
<li>async 解决方案</li>
</ol>
<p><code>async.parallelLimit()</code></p>
<h1 id="第-5-章-内存控制"><a href="#第-5-章-内存控制" class="headerlink" title="第 5 章  内存控制"></a>第 5 章  内存控制</h1><h2 id="5-1-V8-的垃圾回收机制与内存限制"><a href="#5-1-V8-的垃圾回收机制与内存限制" class="headerlink" title="5.1 V8 的垃圾回收机制与内存限制"></a>5.1 V8 的垃圾回收机制与内存限制</h2><p>由垃圾回收机制来进行自动内存管理。</p>
<ol>
<li>V8 的内存限制</li>
</ol>
<p>V8 限制了内存的用量，Node 通过 JavaScript 使用内存只能使用一部分内存(64 位系统 1.4GB, 32 位系统0.7GB)</p>
<ol start="2">
<li>V8 的对象分配</li>
</ol>
<p>所有 JavaScript 对象都是通过堆来进行分配的。</p>
<p><strong>V8 限制了堆内存的大小，为什么？</strong> </p>
<p>堆内存过大，垃圾回收耗时太长。所以直接限制了堆内存的大小。</p>
<blockquote>
<p>可以通过 Node 启动时传递参数，调整内存限制 node –max-old-space-size=1024 test.js MB // node –max-new-space-size=1024 test.js MB</p>
</blockquote>
<h3 id="V8-垃圾回收机制"><a href="#V8-垃圾回收机制" class="headerlink" title="V8 垃圾回收机制"></a>V8 垃圾回收机制</h3><p>各种垃圾回收算法:</p>
<ol>
<li>分代垃圾回收机制</li>
</ol>
<p>对于不通代的垃圾使用不通的垃圾回收算法。</p>
<p>V8 将内存分为：新生代，老生代</p>
<ol start="2">
<li>Scavenge算法&amp;Cheney算法回收老生代垃圾</li>
</ol>
<p>Cheney 算法采用复制方法实现垃圾回收。(内存一分为二，一边使用一边不是用，回收的时候将不回收的移动到不使用的一边…)</p>
<ol start="3">
<li><p>Mark-Sweep 标记清除 &amp; Mark-Compact 标记整理 回收新生代垃圾</p>
</li>
<li><p>Incremental Marking</p>
</li>
</ol>
<p>避免 JavaScript 应用逻辑与垃圾回收器看到的情况不一致，在垃圾回收过程中将应用逻辑停止下来。全停顿(stop-the-world).</p>
<h2 id="5-2-高效使用内存"><a href="#5-2-高效使用内存" class="headerlink" title="5.2 高效使用内存"></a>5.2 高效使用内存</h2><ol>
<li>作用域</li>
</ol>
<p>一个函数执行完成后，函数作用域内的变量也会销毁</p>
<ol start="2">
<li>变量的主动释放</li>
</ol>
<p>全局变量需要在进程退出时才能释放。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> global.foo <span class="comment">// 使用 delete 释放内存</span></span><br><span class="line"></span><br><span class="line">global.foo = <span class="literal">undefined</span> <span class="comment">// or null, 使用赋值方法释放内存 (推荐)</span></span><br></pre></td></tr></table></figure>
<ol start="3">
<li>闭包</li>
</ol>
<p>闭包形式下，中间函数将不会释放内存。</p>
<blockquote>
<p>正常 JavaScript 执行中，无法立即回收内存的有：闭包 和 全局变量</p>
</blockquote>
<h2 id="5-3-内存指标"><a href="#5-3-内存指标" class="headerlink" title="5.3 内存指标"></a>5.3 内存指标</h2><ol>
<li>查看内存使用情况</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">process.memoryUesage()</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>查看系统的内存占用</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.totalmem();</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>堆外内存</li>
</ol>
<p>堆内存总量 &lt; 进程内存</p>
<h2 id="5-4-内存泄露"><a href="#5-4-内存泄露" class="headerlink" title="5.4 内存泄露"></a>5.4 内存泄露</h2><p>通常原因:</p>
<ol>
<li>缓存</li>
</ol>
<p>在使用缓存的时候应该注意: </p>
<p>缓存限制策略：代码限制缓存大小，例子：限制数组长度；使用 LRU 算法缓存</p>
<p>使用进程外缓存: 例子:redis</p>
<ol start="2">
<li>队列消费不及时</li>
</ol>
<p>监控队列长度，报警</p>
<p>异步调用添加超时机制</p>
<ol start="3">
<li>作用域未释放</li>
</ol>
<h2 id="5-5-内存泄露排查"><a href="#5-5-内存泄露排查" class="headerlink" title="5.5 内存泄露排查"></a>5.5 内存泄露排查</h2><p>使用第三方工具排查内存泄露</p>
<h2 id="5-6-大内存应用"><a href="#5-6-大内存应用" class="headerlink" title="5.6 大内存应用"></a>5.6 大内存应用</h2><p>stream 操作大文件读写</p>
<h1 id="第-6-章-理解-Buffer"><a href="#第-6-章-理解-Buffer" class="headerlink" title="第 6 章 理解 Buffer"></a>第 6 章 理解 Buffer</h1><p>操作字节</p>
<h1 id="第-7-章-网络编程"><a href="#第-7-章-网络编程" class="headerlink" title="第 7 章 网络编程"></a>第 7 章 网络编程</h1><p>网络模块: net, dgram, http, https 对应 TCP, UDP, HTTP, HTTPS</p>
<h2 id="7-5-网络服务与安全"><a href="#7-5-网络服务与安全" class="headerlink" title="7.5 网络服务与安全"></a>7.5 网络服务与安全</h2><p>模块: crypto, tls, https</p>
<h3 id="TLS-SSL"><a href="#TLS-SSL" class="headerlink" title="TLS/SSL"></a>TLS/SSL</h3><p>非对称加密</p>
<p>使用公钥加密传输的数据，私钥解密。</p>
<p>在建立安全传输之前，服务器和客户端需要互换公钥。</p>
<p>客户端发送数据的时候，使用服务器公钥加密；服务器发送数据的时候使用客户端公钥加密。</p>
<p><strong>为了避免中间人攻击：</strong>需要对公钥进行认证，确保公钥来自目标服务器。使用数字证书进行认证。</p>
<p>数字证书包含: 服务器名称，主机名，服务器公钥，签名发布机构名称，来自签名颁发机构的签名。</p>
<h3 id="数字证书"><a href="#数字证书" class="headerlink" title="数字证书"></a>数字证书</h3><p>CA: Certificate Authority 数字证书认证中心</p>
<h1 id="第-8-章-构建-web-应用"><a href="#第-8-章-构建-web-应用" class="headerlink" title="第 8 章 构建 web 应用"></a>第 8 章 构建 web 应用</h1><h1 id="第-9-章-玩转进程"><a href="#第-9-章-玩转进程" class="headerlink" title="第 9 章 玩转进程"></a>第 9 章 玩转进程</h1><p>Node 通过 child_process 模块实现，多进程创建，在单机上搭建 Node 集群。</p>
<h2 id="9-3-集群稳定之路"><a href="#9-3-集群稳定之路" class="headerlink" title="9.3 集群稳定之路"></a>9.3 集群稳定之路</h2><ol>
<li>负载均衡</li>
</ol>
<p>采用操作系统抢占式策略达到负载均衡</p>
<ol start="2">
<li>状态共享</li>
</ol>
<p>第三方数据存储：Redis<br>主动通知</p>
<h2 id="9-4-Cluster-模块"><a href="#9-4-Cluster-模块" class="headerlink" title="9.4 Cluster 模块"></a>9.4 Cluster 模块</h2><p>Node v0.8 版本加入了 cluster 模块。 解决多核CPU利用率问题，比使用 child_process 更加简单</p>
<p><strong>工作原理：</strong> 实际上是 child_process 和 net 模块的结合。</p>
<h1 id="第-10-章-测试"><a href="#第-10-章-测试" class="headerlink" title="第 10 章 测试"></a>第 10 章 测试</h1><h1 id="第-11-章-产品化"><a href="#第-11-章-产品化" class="headerlink" title="第 11 章 产品化"></a>第 11 章 产品化</h1><h2 id="11-1-项目工程化"><a href="#11-1-项目工程化" class="headerlink" title="11.1 项目工程化"></a>11.1 项目工程化</h2><p>项目的组织能力。</p>
<p>项目工程化最基本的几步:</p>
<ol>
<li>目录结构</li>
<li>构建工具</li>
<li>编码规范</li>
<li>代码审查</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/05/Android/app打包/apk打包流程/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Double">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/head1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Double">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/05/Android/app打包/apk打包流程/" itemprop="url">Apk 打包流程</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-05T12:18:12+08:00">
                2019-09-05
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/" itemprop="url" rel="index">
                    <span itemprop="name">Android</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="APK-包解析"><a href="#APK-包解析" class="headerlink" title="APK 包解析"></a>APK 包解析</h1><p>APK 包解压后:</p>
<ol>
<li><code>META_INF</code> 签名文件夹</li>
</ol>
<p>包含: <code>CERT.RSA</code>, <code>CERT.SF</code>, <code>MANIFEST.MF</code> …</p>
<p><code>MANIFEST.MF</code>:  版本号，及每个文件的哈希值(SHA-256-Degest)<br><code>CERT.SF</code>: 版本号，对每个文件的头3行进行 SHA1<br><code>CERT.RSA</code>: 保存签名和公钥证书</p>
<p>其他：第卅</p>
<ol start="2">
<li><code>res</code> 文件夹</li>
</ol>
<p>所有的资源文件</p>
<ol start="3">
<li><code>AndroidManifest.xml</code></li>
</ol>
<p>Android 清单文件</p>
<ol start="4">
<li><code>classes.dex</code>: dex 文件</li>
<li><code>resources.arsc</code></li>
</ol>
<p>资源索引表</p>
<ol start="6">
<li><code>assets</code> 静态资源文件夹</li>
<li><code>kotlin</code> kotlin 相关的, metadata</li>
</ol>
<h2 id="apk-包生成流程"><a href="#apk-包生成流程" class="headerlink" title="apk 包生成流程"></a>apk 包生成流程</h2><p><img src="https://upload-images.jianshu.io/upload_images/9984264-bbdece8b63a337fb.png?imageMogr2/auto-orient/strip|imageView2/2/w/536/format/webp" alt="apk flow"></p>
<ol>
<li>aapt 打包所有 res 资源文件</li>
</ol>
<p>生成: R.java, resources.arsc, res 文件夹</p>
<ol start="2">
<li>aidl 处理 .aidl 文件</li>
</ol>
<p>生成对应的 Java 接口文件</p>
<ol start="3">
<li>Java Compiler 阶段</li>
</ol>
<p>通过 Java Compiler 编译 R.java, Java 接口文件，Java 源文件;</p>
<p>生成 .class 文件</p>
<ol start="4">
<li>dex 阶段</li>
</ol>
<p>通过 dex 命令，将所有 .class 文件处理成 classes.dex</p>
<ol start="5">
<li>apkbuilder 阶段</li>
</ol>
<p>将 classex.dex, resources.arsc, res, assets, AndroidManifest.xml 打包成 apk 文件。</p>
<ol start="6">
<li>Jarsigner 阶段</li>
</ol>
<p>对 apk 进行签名</p>
<h1 id="Gradle-打包流程"><a href="#Gradle-打包流程" class="headerlink" title="Gradle 打包流程"></a>Gradle 打包流程</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">sourceGenTask，resGenTask，assetGenTask</span><br><span class="line">checkManifestTask</span><br><span class="line">process the manifest(s) task</span><br><span class="line">create the res values task</span><br><span class="line">compile renderscript files task</span><br><span class="line">merge the resource folders task</span><br><span class="line">merge the asset folders task</span><br><span class="line">create the BuildConfig class task</span><br><span class="line">process the Android Resources and generate source files task</span><br><span class="line">process the java resources task</span><br><span class="line">process the aidl task</span><br><span class="line">compile task</span><br><span class="line">NDK tasks</span><br><span class="line">final packaging task，zipalign task</span><br><span class="line">lint tasks</span><br></pre></td></tr></table></figure>
<h1 id="class-gt-dex"><a href="#class-gt-dex" class="headerlink" title=".class -&gt; dex"></a>.class -&gt; dex</h1><p>dex 文件是一种能被 DVM 识别和并加载，执行的文件格式。(二进制流文件)</p>
<p>具体来说，关于.class文件到dex写入过程主要为：</p>
<ol>
<li><p>将class进行类转换处理</p>
</li>
<li><p>将转换后的类写入到dex中(multidex会创建多个dex)</p>
</li>
<li><p>将dex转换成byte[]</p>
</li>
<li><p>将byte[]列表依次写入到classes.dex, classes2.dex, classes3.dex…</p>
</li>
</ol>
<p>参考:</p>
<ol>
<li><a href="http://mouxuejie.com/blog/2016-06-21/multidex-compile-and-dex-source-analysis/" target="_blank" rel="noopener">class to dex</a></li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/04/Android/原理/SharedPreferences详解/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Double">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/head1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Double">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/04/Android/原理/SharedPreferences详解/" itemprop="url">SharedPreferences 详解</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-04T12:18:12+08:00">
                2019-09-04
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/android/" itemprop="url" rel="index">
                    <span itemprop="name">android</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>参考：<a href="https://juejin.im/post/5d669a27518825271f67d5d4" target="_blank" rel="noopener">https://juejin.im/post/5d669a27518825271f67d5d4</a></p>
<h1 id="获取-SharedPreference-对象"><a href="#获取-SharedPreference-对象" class="headerlink" title="获取 SharedPreference 对象"></a>获取 SharedPreference 对象</h1><h2 id="方式一-PreferenceManager"><a href="#方式一-PreferenceManager" class="headerlink" title="方式一 PreferenceManager"></a>方式一 PreferenceManager</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SharedPreferences defaultSharedPreferences = PreferenceManager.getDefaultSharedPreferences(context);</span><br></pre></td></tr></table></figure>
<h2 id="方式二-ContextImpl-getSharedPreferences"><a href="#方式二-ContextImpl-getSharedPreferences" class="headerlink" title="方式二 ContextImpl getSharedPreferences"></a>方式二 ContextImpl getSharedPreferences</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sSharedPreferences = context.getSharedPreferences(APP_SP_NAME, Context.MODE_PRIVATE);</span><br></pre></td></tr></table></figure>
<h2 id="SharedPreference-模式"><a href="#SharedPreference-模式" class="headerlink" title="SharedPreference 模式"></a>SharedPreference 模式</h2><ul>
<li>MODE_WORLD_READABLE (Android N 7.0 后不支持，会直接抛出异常)</li>
<li>MODE_WORLD_WRITEABLE (Android N 7.0 后不支持，会直接抛出异常)</li>
<li>MODE_MULTI_PROCESS (并不能保证线程安全)</li>
<li>MODE_PRIVATE (常用)</li>
</ul>
<h2 id="SharedPreferences-对象加载过程"><a href="#SharedPreferences-对象加载过程" class="headerlink" title="SharedPreferences 对象加载过程"></a>SharedPreferences 对象加载过程</h2><ol>
<li>判断 SharedPreferences 是否已经加载进内存</li>
<li>判断是否存在遗留的备份文件，如果存在，重命名为 sp 文件</li>
<li>读取 sp 文件，并存入内存</li>
<li>更新文件信息</li>
<li>释放锁，唤醒处于等待状态的线程</li>
</ol>
<p>其他:</p>
<ol>
<li>创建对象并马上调用 getXXX 的时候，如果 sp 文件数据量比较大，getXXX 会阻塞等待文件读取。</li>
</ol>
<h1 id="getXXX"><a href="#getXXX" class="headerlink" title="getXXX"></a>getXXX</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt; SharedPreferencesImpl.java</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getInt</span><span class="params">(String key, <span class="keyword">int</span> defValue)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">synchronized</span> (mLock) &#123;</span><br><span class="line">        awaitLoadedLocked(); <span class="comment">// sp 文件尚未加载完成时，会阻塞在这里，见 2.1</span></span><br><span class="line">        Integer v = (Integer)mMap.get(key); <span class="comment">// 加载完成后直接从内存中读取</span></span><br><span class="line">        <span class="keyword">return</span> v != <span class="keyword">null</span> ? v : defValue;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>SP 文件加载完成后，所有的 getXXX 操作都是从内存中读取的。</p>
<blockquote>
<p>SP数据都加载到内存中，也就导致了 SP 不适合存储大数据量的限制</p>
</blockquote>
<h1 id="putXXX"><a href="#putXXX" class="headerlink" title="putXXX"></a>putXXX</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">val editor = PreferenceManager.getDefaultSharedPreferences(<span class="keyword">this</span>).edit()</span><br><span class="line">editor.putInt(<span class="string">"key"</span>,<span class="number">1</span>)</span><br><span class="line">editor.commit().editor.apply()</span><br></pre></td></tr></table></figure>
<blockquote>
<p>在封装工具类的时候，editor 可以重复使用</p>
</blockquote>
<h2 id="commit"><a href="#commit" class="headerlink" title="commit"></a>commit</h2><blockquote>
<p>同步保存，有返回值</p>
</blockquote>
<ol>
<li>首先同步 mModified 到内存中 , commitToMemory()</li>
<li>然后同步内存数据到 sp 文件中 ，enqueueDiskWrite()</li>
<li>等待写入操作完成，并通知监听者</li>
</ol>
<h2 id="apply"><a href="#apply" class="headerlink" title="apply"></a>apply</h2><blockquote>
<p>异步保存，无返回值</p>
</blockquote>
<h1 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h1><ol>
<li>不支持跨进程</li>
<li>初始化可能慢</li>
<li>SP 数据都会加载到内存中</li>
<li>无论是 commit() 还是 apply() ，针对任何修改都是全量写入。建议针对高频修改的配置项存在子啊单独的 sp 文件。</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/02/program/docker/docker-nginx/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Double">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/head1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Double">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/02/program/docker/docker-nginx/" itemprop="url">Docker nginx</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-02T13:18:12+08:00">
                2019-09-02
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Docker/" itemprop="url" rel="index">
                    <span itemprop="name">Docker</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://github.com/fangmd/docker-examples" target="_blank" rel="noopener">https://github.com/fangmd/docker-examples</a></p>
<p>参考:<a href="https://www.runoob.com/docker/docker-install-nginx.html" target="_blank" rel="noopener">https://www.runoob.com/docker/docker-install-nginx.html</a></p>
<h1 id="Download-nginx"><a href="#Download-nginx" class="headerlink" title="Download nginx"></a>Download nginx</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull nginx</span><br></pre></td></tr></table></figure>
<p>test:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --name test-nginx -p 8081:80 -d nginx</span><br></pre></td></tr></table></figure>
<p>运行 nginx 容器，映射电脑端口 8081 到容器的 80。打开 <code>http://127.0.0.1:8081</code> 可以看到 nginx 网页表示成功</p>
<p>查看正在运行的 容器</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps</span><br></pre></td></tr></table></figure>
<h1 id="nginx-部署"><a href="#nginx-部署" class="headerlink" title="nginx 部署"></a>nginx 部署</h1><p>创建需要的目录: <code>/nginx/www,  /nginx/logs, /nginx/conf</code></p>
<p>将运行中的容器中的 nginx 配置文件复制到本地:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker cp ec2accd6e8d5:/etc/nginx/nginx.conf ./nginx/conf</span><br><span class="line">docker cp 0ad0541e2979:/usr/share/nginx/html ./nginx/www</span><br></pre></td></tr></table></figure>
<p>配置 <code>docker-compose.yml</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">version: &apos;2&apos;</span><br><span class="line">services:</span><br><span class="line">  nginx:</span><br><span class="line">    image: nginx:stable-alpine</span><br><span class="line">    restart: unless-stopped</span><br><span class="line">    volumes:</span><br><span class="line">      - ./nginx/conf/nginx.conf:/etc/nginx/nginx.conf</span><br><span class="line">      - ./nginx/conf.d:/etc/nginx/conf.d/</span><br><span class="line">      - ./nginx/www:/usr/share/nginx/html</span><br><span class="line">      - ./nginx/logs:/var/log/nginx</span><br><span class="line">    ports:</span><br><span class="line">      - &apos;8082:80&apos;</span><br><span class="line">    # environment:</span><br><span class="line">    #   - NGINX_HOST=your.domain</span><br><span class="line">    #   - NGINX_PORT=80</span><br></pre></td></tr></table></figure>
<p>运行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d --build</span><br></pre></td></tr></table></figure>
<h1 id="Dockerfile-方式"><a href="#Dockerfile-方式" class="headerlink" title="Dockerfile 方式"></a>Dockerfile 方式</h1><p>Dockerfile:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">FROM nginx</span><br><span class="line"></span><br><span class="line">COPY ./nginx/www /usr/share/nginx/html</span><br></pre></td></tr></table></figure>
<p>根据 Dockerfile 创建镜像:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build -t one-nginx .</span><br></pre></td></tr></table></figure>
<p>运行:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo docker run --name one-nginx -d -p 8080:80 nginx</span><br></pre></td></tr></table></figure>
<p>打开: <code>http://127.0.0.1:8080</code></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/02/database/高并发网站中的数据库设计/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Double">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/head1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Double">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/02/database/高并发网站中的数据库设计/" itemprop="url">高并发网站中的数据库设计-视频笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-02T13:18:12+08:00">
                2019-09-02
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Database/" itemprop="url" rel="index">
                    <span itemprop="name">Database</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="数据库的基本组成"><a href="#数据库的基本组成" class="headerlink" title="数据库的基本组成"></a>数据库的基本组成</h1><ul>
<li>用户 API</li>
<li>关系代数和事务引擎</li>
<li>K-V存储</li>
</ul>
<h2 id="KV-存储系统"><a href="#KV-存储系统" class="headerlink" title="KV 存储系统"></a>KV 存储系统</h2><p>映射，根据 key 找到 value</p>
<p>映射关键特性:</p>
<ol>
<li>是否支持范围查找</li>
<li>是否能够处理更新</li>
<li>读写指标</li>
<li>是否面向磁盘结构</li>
<li>etc…</li>
</ol>
<h2 id="关系代数和事务引擎"><a href="#关系代数和事务引擎" class="headerlink" title="关系代数和事务引擎"></a>关系代数和事务引擎</h2><h3 id="关系代数与映射的关系"><a href="#关系代数与映射的关系" class="headerlink" title="关系代数与映射的关系"></a>关系代数与映射的关系</h3><p>关系型数据库如何转化成映射:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">表结构：</span><br><span class="line">id, user_id, name</span><br><span class="line"></span><br><span class="line">id: 作为key，后面的数据作为 value 存储在磁盘中。</span><br><span class="line">select * from tab where id = ? 就是 key-value 查找 时间复杂度为: O(1)</span><br><span class="line"></span><br><span class="line">如果要按照 user_id 如果直接去查找 时间复杂度是 O(n);</span><br><span class="line">优化1: 创建二级索引(user_id 为 key, id 为 value), 先查二级索引，再查一级索引 时间复杂度O(1)</span><br><span class="line"></span><br><span class="line">select ... where user_id = ? and name = &apos;...&apos;</span><br><span class="line">优化: 组合索引 (user_id,name 作为 key, id 作为 value)</span><br></pre></td></tr></table></figure>
<h3 id="事务引擎"><a href="#事务引擎" class="headerlink" title="事务引擎"></a>事务引擎</h3><p>加锁/去锁</p>
<h3 id="用户-API"><a href="#用户-API" class="headerlink" title="用户 API"></a>用户 API</h3><h1 id="分布式存储"><a href="#分布式存储" class="headerlink" title="分布式存储"></a>分布式存储</h1><h2 id="Key-Value-的多机扩展"><a href="#Key-Value-的多机扩展" class="headerlink" title="Key-Value 的多机扩展"></a>Key-Value 的多机扩展</h2><p>数据库集群</p>
<p>规则引擎判断数据存储在哪个数据库中。</p>
<p>一致性 Hash: 解决热点问题</p>
<h2 id="CAP-和-分布式系统的一致性"><a href="#CAP-和-分布式系统的一致性" class="headerlink" title="CAP 和 分布式系统的一致性"></a>CAP 和 分布式系统的一致性</h2><p>一致性解决方案:</p>
<ol>
<li>无主机</li>
<li>有主机</li>
</ol>
<p>一个主机能写，其他主机只读。主机挂了需要选主机</p>
<h1 id="阿里数据库的一些最佳实践"><a href="#阿里数据库的一些最佳实践" class="headerlink" title="阿里数据库的一些最佳实践"></a>阿里数据库的一些最佳实践</h1>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/22/前端/JavaScript/JS知识点/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Double">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/head1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Double">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/22/前端/JavaScript/JS知识点/" itemprop="url">JS 知识点</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-08-22T13:18:12+08:00">
                2019-08-22
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/前端/" itemprop="url" rel="index">
                    <span itemprop="name">前端</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="继承与原型链"><a href="#继承与原型链" class="headerlink" title="继承与原型链"></a>继承与原型链</h1><p>JS 中只有一个结构: 对象。</p>
<p>每个对象又一个私有属性: <code>__proto__</code> 指向它构造函数中的原型对象 <code>prototype</code></p>
<p>当一个对象的 <code>__proto__ === null</code> 时，就是原型链的最后一个节点</p>
<p>原型链的顶端一般都是 <code>Object</code></p>
<h2 id="如何实现一个继承-amp-如何创建对象"><a href="#如何实现一个继承-amp-如何创建对象" class="headerlink" title="如何实现一个继承 &amp; 如何创建对象"></a>如何实现一个继承 &amp; 如何创建对象</h2><h3 id="new-，-构造器"><a href="#new-，-构造器" class="headerlink" title="new ， 构造器"></a>new ， 构造器</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Man</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = <span class="string">'fang'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Man.prototype = &#123;</span><br><span class="line">  color: <span class="string">'white'</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> m = <span class="keyword">new</span> Man();</span><br></pre></td></tr></table></figure>
<h3 id="Object-create"><a href="#Object-create" class="headerlink" title="Object.create"></a>Object.create</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var p = Object.create(o); // 表示 p extends o</span><br></pre></td></tr></table></figure>
<p><code>Object.create</code> 源码(简化了):</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.create = <span class="function"><span class="keyword">function</span>(<span class="params">proto, propertiesObject</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 省略前置 参数 判断...</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">F</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">  F.prototype = proto;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> F();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="class-关键字创建对象"><a href="#class-关键字创建对象" class="headerlink" title="class 关键字创建对象"></a>class 关键字创建对象</h3><p>class, constructor, static, extends, super</p>
<h1 id="严格模式"><a href="#严格模式" class="headerlink" title="严格模式"></a>严格模式</h1><p>ES5 开始引入 严格模式</p>
<p>作用:</p>
<ol>
<li>将过失错误转化成异常</li>
<li>一些非法操作异常报错</li>
<li>为未来 js 语法预留关键字(使用一些关键字会报错)</li>
</ol>
<h2 id="开启严格模式"><a href="#开启严格模式" class="headerlink" title="开启严格模式"></a>开启严格模式</h2><p>开启严格模式:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;use strict&quot;</span><br></pre></td></tr></table></figure>
<p>可以在函数内部开启严格模式:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">strict</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 函数级别严格模式语法</span></span><br><span class="line"><span class="meta">  'use strict'</span>;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">nested</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'And so am I!'</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">"Hi!  I'm a strict mode function!  "</span> + nested();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="JS-内存管理"><a href="#JS-内存管理" class="headerlink" title="JS 内存管理"></a>JS 内存管理</h1><p>内存生命周期：</p>
<ol>
<li>分配内存</li>
<li>使用内存</li>
<li>释放内存</li>
</ol>
<h2 id="分配内存"><a href="#分配内存" class="headerlink" title="分配内存"></a>分配内存</h2><p>JS 在定义变量的时候自动完成内存分配</p>
<h2 id="使用内存"><a href="#使用内存" class="headerlink" title="使用内存"></a>使用内存</h2><p>对变量进行操作</p>
<h2 id="释放内存"><a href="#释放内存" class="headerlink" title="释放内存"></a>释放内存</h2><p>垃圾回收器：跟踪内存的分配和使用，当内存不再使用时自动释放它。</p>
<h3 id="垃圾回收算法"><a href="#垃圾回收算法" class="headerlink" title="垃圾回收算法"></a>垃圾回收算法</h3><ol>
<li>引用计数垃圾收集</li>
</ol>
<p>缺点：循环引用无法处理</p>
<ol start="2">
<li>标记-清除算法</li>
</ol>
<p>root 对象，向下查找对象，没有查找到的就是需要回收的对象</p>
<p>优点：解决循环引用问题<br>缺点：那些无法从根对象查询到的对象都将被清除</p>
<h1 id="JS-并发模型与事件循环"><a href="#JS-并发模型与事件循环" class="headerlink" title="JS 并发模型与事件循环"></a>JS 并发模型与事件循环</h1><p>JS 运行时：Stack(栈), 堆(Heap)，队列(Queue)</p>
<h2 id="Stack"><a href="#Stack" class="headerlink" title="Stack"></a>Stack</h2><p>函数调用形成栈帧</p>
<p>函数执行过程中的局部变量存储在帧中。</p>
<h2 id="堆-Heap"><a href="#堆-Heap" class="headerlink" title="堆 Heap"></a>堆 Heap</h2><p>对象被分配在一个堆中</p>
<h2 id="队列"><a href="#队列" class="headerlink" title="队列"></a>队列</h2><p>JS 运行时包含一个待处理的消息队列。</p>
<p>事件循环队列伪代码:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (queue.waitForMessage()) &#123;</span><br><span class="line">  queue.processNextMessage();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>queue.waitForMessage</code> 阻塞</p>
</blockquote>
<ol>
<li>执行至完成</li>
</ol>
<p>一个消息完整执行前，其他消息不会被执行。</p>
<ol start="2">
<li>添加消息</li>
</ol>
<p>一个事件发生并且有监听器绑定在事件上时，这个事件消息就会加入到消息队列中，否则 事件丢失。</p>
<ol start="3">
<li>零延迟</li>
</ol>
<p>零延迟并不意味着回调会立即执行。</p>
<h2 id="多个运行时通讯"><a href="#多个运行时通讯" class="headerlink" title="多个运行时通讯"></a>多个运行时通讯</h2><p>iframe 有自己的运行时</p>
<p>运行时之间通过 <code>postMessage</code> 通讯</p>
<h2 id="永不阻塞"><a href="#永不阻塞" class="headerlink" title="永不阻塞"></a>永不阻塞</h2><p>js 事件循环模型，在处理 I/O 通过事件和回调实现。</p>
<p>在 I/O 过程中并不会阻塞事件处理。</p>
<p>也就是说在网络请求过程中，可以处理其他事件。</p>
<h1 id="JS-相等性判断-Object-is"><a href="#JS-相等性判断-Object-is" class="headerlink" title="JS 相等性判断 ==, ===, Object.is"></a>JS 相等性判断 ==, ===, Object.is</h1><ol>
<li>严格相等 <code>===</code></li>
<li>宽松相等 <code>==</code></li>
<li><code>Object.is</code> ES6 与严格相等表现一样，增加:<code>NaN与NaN相等， -0与+0不等</code></li>
</ol>
<h1 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h1><h2 id="是什么"><a href="#是什么" class="headerlink" title="是什么"></a>是什么</h2><p>嵌套函数可以访问外部声明的变量。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">makeFunc</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> name = <span class="string">'Mozilla'</span>;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">displayName</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(name);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> displayName;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> myFunc = makeFunc();</span><br><span class="line">myFunc();</span><br></pre></td></tr></table></figure>
<p>JavaScript 中函数会形成闭包。闭包由函数和创建改函数的词法环境组合而成。</p>
<p>什么是闭包？</p>
<blockquote>
<p>JavaScript 函数内部嵌套函数就会形成闭包，闭包由内部函数和创建函数的词法环境组成。</p>
</blockquote>
<h2 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h2><ol>
<li>延迟执行: 通过返回内部函数的形式达到延迟执行的作用，创建函数和执行函数分离</li>
<li>变量与外部环境隔离</li>
</ol>
<h2 id="JQuery-闭包"><a href="#JQuery-闭包" class="headerlink" title="JQuery 闭包"></a>JQuery 闭包</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// jquery code</span></span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<blockquote>
<p>匿名函数自执行</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//以下截取自jquery源码片段</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">window, undefined</span>) </span>&#123;</span><br><span class="line">  <span class="comment">/*    源码内容    */</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">window</span>.jQuery = <span class="built_in">window</span>.$ = jQuery;</span><br><span class="line">&#125;)(<span class="built_in">window</span>);</span><br></pre></td></tr></table></figure>
<h1 id="原生-DOM-操作几种方式"><a href="#原生-DOM-操作几种方式" class="headerlink" title="原生 DOM 操作几种方式"></a>原生 DOM 操作几种方式</h1><p><code>Element</code> 对象的几个方法</p>
<ol>
<li>替换 <code>replaceChild</code></li>
<li>删除 <code>removeChild</code></li>
<li>插入 <code>insertBefore, appendChild</code></li>
</ol>
<h1 id="深拷贝和浅拷贝"><a href="#深拷贝和浅拷贝" class="headerlink" title="深拷贝和浅拷贝"></a>深拷贝和浅拷贝</h1><p>js 数据类型</p>
<ol>
<li>基本数据类型: undefined, boolean, number, string, null</li>
<li>引用数据类型:</li>
</ol>
<blockquote>
<p>深/浅拷贝都是对于引用对象来说的</p>
</blockquote>
<p><strong>浅拷贝: </strong> 拷贝后的对象，成员变量指向和原来的对象成员变量指向同一个内存地址。</p>
<blockquote>
<p>浅拷贝，对象的属性只能拷贝基本数据类型</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">shallowCopy</span>(<span class="params">target</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> obj = &#123;&#125;;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> target) &#123;</span><br><span class="line">    obj[key] = target[key];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> obj;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>深拷贝: </strong>生成的对象完全独立与原来的对象。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">deepCopy</span>(<span class="params">target</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">let</span> obj = &#123;&#125;;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> key <span class="keyword">in</span> target)&#123;</span><br><span class="line">    <span class="keyword">if</span>( <span class="keyword">typeof</span> target[key] === <span class="string">'object'</span>)&#123;</span><br><span class="line">      obj[key] = deepCopy(target[key]);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      obj[key] = target[key];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> obj;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">方式二: <span class="built_in">JSON</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj2 = <span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(obj));</span><br></pre></td></tr></table></figure>
<h2 id="obj-keys-vs-obj-keys"><a href="#obj-keys-vs-obj-keys" class="headerlink" title="obj.keys vs obj[keys]"></a>obj.keys vs obj[keys]</h2><p>两个的作用是一样的。</p>
<p>但是 <code>obj.keys</code> 只能用于 obj 中已经定义好的 key(需要是在代码未运行就定义好的 key, 不能是动态添加的 key)).</p>
<h1 id="Event-Loop"><a href="#Event-Loop" class="headerlink" title="Event Loop"></a>Event Loop</h1><p>Event Loop: JS 引擎线程会循环从任务队列中读取事件并执行</p>
<p>没有游览器环境只有一个 Event Loop;</p>
<p>一个 Event Loop 有 1 个或多个 task queue</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">代码执行顺序:</span><br><span class="line"></span><br><span class="line">同步代码</span><br><span class="line">消息队列中异步代码</span><br><span class="line">回调函数</span><br><span class="line">下个事件中执行 setTimeout</span><br><span class="line">全局上下文进入函数调用栈</span><br><span class="line">micro-task 微任务</span><br><span class="line">macro-task 宏任务</span><br></pre></td></tr></table></figure>
<blockquote>
<p>setTimeout 最短执行时间是 4ms</p>
</blockquote>
<p><strong>micro-task 微任务队列</strong> <code>Promise MutationObserver</code></p>
<p><strong>macro-task 宏任务队列</strong> <code>setTimeout setInmediate MessageChannel</code></p>
<p>一次 Tick 表示一个循环</p>
<h2 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">setTimeout(()=&gt;&#123;</span><br><span class="line">  console.log(&apos;setTimeout1&apos;)</span><br><span class="line">&#125;,0)</span><br><span class="line">let p = new Promise((resolve,reject)=&gt;&#123;</span><br><span class="line">  console.log(&apos;Promise1&apos;)</span><br><span class="line">  resolve()</span><br><span class="line">&#125;)</span><br><span class="line">p.then(()=&gt;&#123;</span><br><span class="line">  console.log(&apos;Promise2&apos;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">输出结果是Promise1，Promise2，setTimeout1</span><br><span class="line"></span><br><span class="line">Promise 同步执行，Promise then 在 micro-task, setTimeout 在 macro-task.</span><br><span class="line"></span><br><span class="line">同步任务 -&gt; 清空micro-task -&gt; 清空macro-task</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Promise.resolve().then(()=&gt;&#123;</span><br><span class="line">  console.log(&apos;Promise1&apos;)</span><br><span class="line">  setTimeout(()=&gt;&#123;</span><br><span class="line">    console.log(&apos;setTimeout2&apos;)</span><br><span class="line">  &#125;,0)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">setTimeout(()=&gt;&#123;</span><br><span class="line">  console.log(&apos;setTimeout1&apos;)</span><br><span class="line">  Promise.resolve().then(()=&gt;&#123;</span><br><span class="line">    console.log(&apos;Promise2&apos;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;,0)</span><br><span class="line"></span><br><span class="line">结果: Promise1, setTimeout1, Promise2, setTimeout2</span><br></pre></td></tr></table></figure>
<blockquote>
<p>一个 Tick: 同步任务 -&gt; micro-task -&gt; macro-task</p>
</blockquote>
<h2 id="Node-event-looper-和-游览器-event-looper"><a href="#Node-event-looper-和-游览器-event-looper" class="headerlink" title="Node event looper 和 游览器 event looper"></a>Node event looper 和 游览器 event looper</h2><blockquote>
<p>Node11 后，node 的 EventLooper 与 游览器的 EventLooper 统一了</p>
</blockquote>
<p>差异原因：底层 Event Lopper 实现机制不一样, node: libuv</p>
<h1 id="Promise-原理"><a href="#Promise-原理" class="headerlink" title="Promise 原理"></a>Promise 原理</h1><p>自己实现一个 Promise</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isFunction</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">typeof</span> value === <span class="string">'function'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 定义Promise的三种状态常量</span></span><br><span class="line"><span class="keyword">const</span> PENDING = <span class="string">'PENDING'</span>;</span><br><span class="line"><span class="keyword">const</span> FULFILLED = <span class="string">'FULFILLED'</span>;</span><br><span class="line"><span class="keyword">const</span> REJECTED = <span class="string">'REJECTED'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPromise</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(handle) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!isFunction(handle)) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'MyPromise must accept a function as a parameter'</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>._status = PENDING;</span><br><span class="line">    <span class="keyword">this</span>._value = undefied;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      handle(<span class="keyword">this</span>._resolve.bind(<span class="keyword">this</span>), <span class="keyword">this</span>._reject.bind(<span class="keyword">this</span>));</span><br><span class="line">    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">      <span class="keyword">this</span>._reject(err);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 外部调用 then 的时候，先存储下函数, 等 Promise 执行完成后调用 then</span></span><br><span class="line">    <span class="keyword">this</span>._fullfilledQueues = [];</span><br><span class="line">    <span class="keyword">this</span>._rejectedQueues = [];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  _resolve(val) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>._status !== PENDING) <span class="keyword">return</span>;</span><br><span class="line">    <span class="comment">// 依次执行成功队列中的函数，并清空队列</span></span><br><span class="line">    <span class="keyword">const</span> run = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">this</span>._status = FULFILLED;</span><br><span class="line">      <span class="keyword">this</span>._value = val;</span><br><span class="line">      <span class="keyword">let</span> cb;</span><br><span class="line">      <span class="keyword">while</span> ((cb = <span class="keyword">this</span>._fulfilledQueues.shift())) &#123;</span><br><span class="line">        cb(val);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// 为了支持同步的Promise，这里采用异步调用</span></span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> run(), <span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  _reject(val) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.status !== PENDING) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">this</span>._status = REJECTED;</span><br><span class="line">    <span class="comment">// 依次执行成功队列中的函数，并清空队列</span></span><br><span class="line">    <span class="keyword">const</span> run = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">this</span>._status = REJECTED;</span><br><span class="line">      <span class="keyword">this</span>._value = val;</span><br><span class="line">      <span class="keyword">let</span> cb;</span><br><span class="line">      <span class="keyword">while</span> ((cb = <span class="keyword">this</span>._rejectedQueues.shift())) &#123;</span><br><span class="line">        cb(val);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// 为了支持同步的Promise，这里采用异步调用</span></span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> run(), <span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  then(onFulfilled, onRejected) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; _value, _status &#125; = <span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">switch</span> (_status) &#123;</span><br><span class="line">      <span class="keyword">case</span> PENDING:</span><br><span class="line">        <span class="keyword">this</span>._fullfilledQueues.push(onFulfilled);</span><br><span class="line">        <span class="keyword">this</span>._rejectedQueues.push(onRejected);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> FULFILLED:</span><br><span class="line">        onFulfilled(_value);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> REJECTED:</span><br><span class="line">        onRejected(_value);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 返回一个新的Promise对象，形成链接式调用</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MyPromise(<span class="function">(<span class="params">onFulfilledNext, onRejectedNext</span>) =&gt;</span> &#123;&#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="函数节流-throttles"><a href="#函数节流-throttles" class="headerlink" title="函数节流 throttles"></a>函数节流 throttles</h1><p>规定单位时间内只执行第一次</p>
<p>时间内多次执行，第一次点击马上执行，时间到后执行第二次点击，其他事件丢失。(lodash 验证结果)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">throthle</span>(<span class="params">call, time</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!time) &#123;</span><br><span class="line">    time = <span class="number">300</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> timer = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">const</span> retFun = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (timer == <span class="literal">null</span>) &#123;</span><br><span class="line">      call();</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    timer = setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      call();</span><br><span class="line">      timer = <span class="literal">null</span>;</span><br><span class="line">    &#125;, time);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> retFun;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="函数防抖-debounce"><a href="#函数防抖-debounce" class="headerlink" title="函数防抖 debounce"></a>函数防抖 debounce</h1><p>一段时间内只执行最后一次</p>
<ol>
<li>频繁点击会不断刷新时间，所以一直点击，就一直不会触发事件</li>
<li>点击后，会在时间结束的时候执行</li>
</ol>
<p>应用场景：</p>
<ol>
<li>搜索功能</li>
<li>window resize</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">call, wait</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> timer = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    clearTimeout(timer);</span><br><span class="line">    timer = setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      call();</span><br><span class="line">    &#125;, wait);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">call, wait immediate</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">let</span> timeout;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">...args</span>)</span>&#123;</span><br><span class="line">    clearTimeout(timeout);</span><br><span class="line">    timeout = setTimeout(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">      timeout = <span class="literal">null</span>;</span><br><span class="line">      <span class="keyword">if</span>(!immediate)&#123;</span><br><span class="line">        call.apply(<span class="keyword">this</span>, args);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;, wait);</span><br><span class="line">    <span class="keyword">if</span>(immediate &amp;&amp; !timeout)&#123;</span><br><span class="line">      call.apply(<span class="keyword">this</span>, [...args]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="bind-call-apply"><a href="#bind-call-apply" class="headerlink" title="bind, call, apply"></a>bind, call, apply</h1><p>bind, call, apply 存在的意义：修改函数执行时的上下文，具体说就是改变函数 this 指向。</p>
<p>区别：</p>
<ol>
<li>bind 返回函数，不会马上执行；call, apply 都是马上执行的</li>
<li>call, apply 区别时参数不同, call 从第二个参数开始以参数列表的形式展现，apply 则是把除了改变上下文对象的参数放在一个数组里面作为它的第二个参数。</li>
</ol>
<p>普通模式和严格模式导致的差异:</p>
<ol>
<li>在不指定 this 对象的时候，普通模式下 this 是 window, 严格模式下是 undefined</li>
<li>在指定 null 对象的时候，普通模式下 this 是 window, 严格模式下是 null</li>
<li>在指定 undefined 对象的时候，普通模式下 this 是 window, 严格模式下是 undefined</li>
</ol>
<h2 id="作用-1"><a href="#作用-1" class="headerlink" title="作用"></a>作用</h2><ol>
<li>利用 call, apply 求数组中的最大值或最小值</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">19</span>, <span class="number">6</span>];</span><br><span class="line"><span class="built_in">Math</span>.max.call(<span class="literal">null</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">19</span>, <span class="number">6</span>); <span class="comment">// 19</span></span><br><span class="line"><span class="built_in">Math</span>.max.call(<span class="literal">null</span>, arr1); <span class="comment">// NaN call 不能接收数组参数</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Math</span>.max.apply(<span class="literal">null</span>, arr1); <span class="comment">// 19</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>利用 call, apply 来做继承, 多继承</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Animal</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>._name = name;</span><br><span class="line">  <span class="keyword">this</span>.showName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>._name);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Cat</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  Animal.call(<span class="keyword">this</span>, name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Animal.call(this, name); 给 Cat 添加 _name, showName.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> cat = <span class="keyword">new</span> Cat(<span class="string">'TONY'</span>);</span><br><span class="line">cat.showName();</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/55/">55</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="/head1.jpg" alt="Double">
          <p class="site-author-name" itemprop="name">Double</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">548</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">24</span>
                <span class="site-state-item-name">categories</span>
              
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">260</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Double</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  





  






  





  

  

  

  

  

  

</body>
</html>
