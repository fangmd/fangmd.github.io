<!doctype html>



  


<html class="theme-next muse use-motion" lang>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css">


  <meta name="keywords" content="Hexo, NexT">








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1">






<meta property="og:type" content="website">
<meta property="og:title" content="Double">
<meta property="og:url" content="http://yoursite.com/page/32/index.html">
<meta property="og:site_name" content="Double">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Double">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/32/">





  <title>Double</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Double</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/11/13/Python/django/django-rest-framework/7. django-rest-framework -- Renderers/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Double">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/head1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Double">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/11/13/Python/django/django-rest-framework/7. django-rest-framework -- Renderers/" itemprop="url">7. django-rest-framework -- Renderers</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-11-13T13:18:12+08:00">
                2016-11-13
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index">
                    <span itemprop="name">Python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Renderers"><a href="#Renderers" class="headerlink" title="Renderers"></a>Renderers</h1><blockquote>
<p>Before a TemplateResponse instance can be returned to the client, it must be rendered. The rendering process takes the intermediate representation of template and context, and turns it into the final byte stream that can be served to the client.<br>— Django documentation</p>
</blockquote>
<h2 id="How-the-renderer-is-determined"><a href="#How-the-renderer-is-determined" class="headerlink" title="How the renderer is determined"></a>How the renderer is determined</h2><ol>
<li><p>决定：请求头 <code>Accept</code></p>
</li>
<li><p>URL 的后缀（优先）</p>
</li>
</ol>
<h2 id="Setting-the-renderers"><a href="#Setting-the-renderers" class="headerlink" title="Setting the renderers"></a>Setting the renderers</h2><pre><code>REST_FRAMEWORK = {
    &apos;DEFAULT_RENDERER_CLASSES&apos;: (
        &apos;rest_framework.renderers.JSONRenderer&apos;,
        &apos;rest_framework.renderers.BrowsableAPIRenderer&apos;,
    )
}
</code></pre><p>也可以为视图独立设置：</p>
<pre><code>from django.contrib.auth.models import User
from rest_framework.renderers import JSONRenderer
from rest_framework.response import Response
from rest_framework.views import APIView

class UserCountView(APIView):
    &quot;&quot;&quot;
    A view that returns the count of active users in JSON.
    &quot;&quot;&quot;
    renderer_classes = (JSONRenderer, )

    def get(self, request, format=None):
        user_count = User.objects.filter(active=True).count()
        content = {&apos;user_count&apos;: user_count}
        return Response(content)
</code></pre><p>方法视图；</p>
<pre><code>@api_view([&apos;GET&apos;])
@renderer_classes((JSONRenderer,))
def user_count_view(request, format=None):
    &quot;&quot;&quot;
    A view that returns the count of active users in JSON.
    &quot;&quot;&quot;
    user_count = User.objects.filter(active=True).count()
    content = {&apos;user_count&apos;: user_count}
    return Response(content)
</code></pre><h2 id="Ordering-of-renderer-classes"><a href="#Ordering-of-renderer-classes" class="headerlink" title="Ordering of renderer classes"></a>Ordering of renderer classes</h2><h1 id="API-Reference"><a href="#API-Reference" class="headerlink" title="API Reference"></a>API Reference</h1><h2 id="JSONRenderer"><a href="#JSONRenderer" class="headerlink" title="JSONRenderer"></a>JSONRenderer</h2><h2 id="TemplateHTMLRenderer"><a href="#TemplateHTMLRenderer" class="headerlink" title="TemplateHTMLRenderer"></a>TemplateHTMLRenderer</h2><h2 id="StaticHTMLRenderer"><a href="#StaticHTMLRenderer" class="headerlink" title="StaticHTMLRenderer"></a>StaticHTMLRenderer</h2><h2 id="BrowsableAPIRenderer"><a href="#BrowsableAPIRenderer" class="headerlink" title="BrowsableAPIRenderer"></a>BrowsableAPIRenderer</h2><p>渲染成一个网页可操作的API接口</p>
<ul>
<li>.media_type: text/html</li>
<li>.format: ‘.api’</li>
<li>.charset: utf-8</li>
<li>.template: ‘rest_framework/api.html’</li>
</ul>
<h2 id="AdminRenderer"><a href="#AdminRenderer" class="headerlink" title="AdminRenderer"></a>AdminRenderer</h2><p>Renders data into HTML for an admin-like display:</p>
<h2 id="HTMLFormRenderer"><a href="#HTMLFormRenderer" class="headerlink" title="HTMLFormRenderer"></a>HTMLFormRenderer</h2><p>使用 html 模版生产结果</p>
<h2 id="MultiPartRenderer"><a href="#MultiPartRenderer" class="headerlink" title="MultiPartRenderer"></a>MultiPartRenderer</h2><h1 id="Third-party-packages"><a href="#Third-party-packages" class="headerlink" title="Third party packages"></a>Third party packages</h1><h2 id="YAML"><a href="#YAML" class="headerlink" title="YAML"></a>YAML</h2><h2 id="XML"><a href="#XML" class="headerlink" title="XML"></a>XML</h2>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/11/13/Python/django/django-rest-framework/9. django-rest-framework -- Serializers fields/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Double">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/head1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Double">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/11/13/Python/django/django-rest-framework/9. django-rest-framework -- Serializers fields/" itemprop="url">9. django-rest-framework -- Serializers fields</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-11-13T13:18:12+08:00">
                2016-11-13
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index">
                    <span itemprop="name">Python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Serializer-fields"><a href="#Serializer-fields" class="headerlink" title="Serializer fields"></a>Serializer fields</h1><p>fields 负责将原始数据转化到相应的数据类型，验证数据的有效性，重新获取和设置值到对象中。</p>
<h2 id="Core-arguments-核心参数"><a href="#Core-arguments-核心参数" class="headerlink" title="Core arguments 核心参数"></a>Core arguments 核心参数</h2><ul>
<li>read_only</li>
<li>write_only</li>
<li>required</li>
<li>allow_null</li>
<li>default</li>
<li>source</li>
<li>validators</li>
<li>error_messages</li>
<li>label</li>
<li>help_text</li>
<li>initial <code>day = serializers.DateField(initial=datetime.date.today)</code></li>
<li>style</li>
</ul>
<h2 id="Boolean-fields"><a href="#Boolean-fields" class="headerlink" title="Boolean fields"></a>Boolean fields</h2><h1 id="String-fields"><a href="#String-fields" class="headerlink" title="String fields"></a>String fields</h1><h2 id="EmailField"><a href="#EmailField" class="headerlink" title="EmailField"></a>EmailField</h2><h2 id="RegexField"><a href="#RegexField" class="headerlink" title="RegexField"></a>RegexField</h2><h2 id="SlugField"><a href="#SlugField" class="headerlink" title="SlugField"></a>SlugField</h2><h2 id="URLField"><a href="#URLField" class="headerlink" title="URLField"></a>URLField</h2><h2 id="UUIDField"><a href="#UUIDField" class="headerlink" title="UUIDField"></a>UUIDField</h2><h2 id="FilePathField"><a href="#FilePathField" class="headerlink" title="FilePathField"></a>FilePathField</h2><h2 id="IPAddressField"><a href="#IPAddressField" class="headerlink" title="IPAddressField"></a>IPAddressField</h2><h1 id="Numeric-fields"><a href="#Numeric-fields" class="headerlink" title="Numeric fields"></a>Numeric fields</h1><h2 id="IntegerField"><a href="#IntegerField" class="headerlink" title="IntegerField"></a>IntegerField</h2><h2 id="FloatField"><a href="#FloatField" class="headerlink" title="FloatField"></a>FloatField</h2><h2 id="DecimalField"><a href="#DecimalField" class="headerlink" title="DecimalField"></a>DecimalField</h2><h1 id="Date-and-time-fields"><a href="#Date-and-time-fields" class="headerlink" title="Date and time fields"></a>Date and time fields</h1><h2 id="DateTimeField"><a href="#DateTimeField" class="headerlink" title="DateTimeField"></a>DateTimeField</h2><h2 id="DateField"><a href="#DateField" class="headerlink" title="DateField"></a>DateField</h2><h2 id="TimeField"><a href="#TimeField" class="headerlink" title="TimeField"></a>TimeField</h2><h2 id="DurationField"><a href="#DurationField" class="headerlink" title="DurationField"></a>DurationField</h2><h1 id="Choice-selection-fields"><a href="#Choice-selection-fields" class="headerlink" title="Choice selection fields"></a>Choice selection fields</h1><h2 id="ChoiceField"><a href="#ChoiceField" class="headerlink" title="ChoiceField"></a>ChoiceField</h2><h2 id="MultipleChoiceField"><a href="#MultipleChoiceField" class="headerlink" title="MultipleChoiceField"></a>MultipleChoiceField</h2><h1 id="File-upload-fields"><a href="#File-upload-fields" class="headerlink" title="File upload fields"></a>File upload fields</h1><h2 id="FileField"><a href="#FileField" class="headerlink" title="FileField"></a>FileField</h2><h2 id="ImageField"><a href="#ImageField" class="headerlink" title="ImageField"></a>ImageField</h2><h1 id="Composite-fields"><a href="#Composite-fields" class="headerlink" title="Composite fields"></a>Composite fields</h1><h2 id="ListField"><a href="#ListField" class="headerlink" title="ListField"></a>ListField</h2><h2 id="DictField"><a href="#DictField" class="headerlink" title="DictField"></a>DictField</h2><h2 id="JSONField"><a href="#JSONField" class="headerlink" title="JSONField"></a>JSONField</h2><h1 id="Miscellaneous-fields"><a href="#Miscellaneous-fields" class="headerlink" title="Miscellaneous fields"></a>Miscellaneous fields</h1><h2 id="ReadOnlyField"><a href="#ReadOnlyField" class="headerlink" title="ReadOnlyField"></a>ReadOnlyField</h2><h2 id="HiddenField"><a href="#HiddenField" class="headerlink" title="HiddenField"></a>HiddenField</h2><h2 id="ModelField"><a href="#ModelField" class="headerlink" title="ModelField"></a>ModelField</h2><h2 id="SerializerMethodField"><a href="#SerializerMethodField" class="headerlink" title="SerializerMethodField"></a>SerializerMethodField</h2><h1 id="Custom-fields"><a href="#Custom-fields" class="headerlink" title="Custom fields"></a>Custom fields</h1>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/11/13/Python/django/django-rest-framework/8. django-rest-framework -- Serializers/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Double">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/head1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Double">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/11/13/Python/django/django-rest-framework/8. django-rest-framework -- Serializers/" itemprop="url">8. django-rest-framework -- Serializers</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-11-13T13:18:12+08:00">
                2016-11-13
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index">
                    <span itemprop="name">Python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Serializers"><a href="#Serializers" class="headerlink" title="Serializers"></a>Serializers</h1><p>提供</p>
<ol>
<li>Python 对象 –》 xml，json 等格式数据</li>
<li>xml，json等格式数据 –》 Python 对象</li>
</ol>
<h2 id="Declaring-Serializers"><a href="#Declaring-Serializers" class="headerlink" title="Declaring Serializers"></a>Declaring Serializers</h2><h3 id="例子："><a href="#例子：" class="headerlink" title="例子："></a>例子：</h3><p>创建一个简单的 Models：</p>
<pre><code>from datetime import datetime

class Comment(object):
    def __init__(self, email, content, created=None):
        self.email = email
        self.content = content
        self.created = created or datetime.now()

comment = Comment(email=&apos;leila@example.com&apos;, content=&apos;foo bar&apos;)
</code></pre><p>序列化器：</p>
<pre><code>from rest_framework import serializers

class CommentSerializer(serializers.Serializer):
    email = serializers.EmailField()
    content = serializers.CharField(max_length=200)
    created = serializers.DateTimeField()
</code></pre><h2 id="Serializing-objects-使用-序列化器-对象"><a href="#Serializing-objects-使用-序列化器-对象" class="headerlink" title="Serializing objects 使用 序列化器 对象"></a>Serializing objects 使用 序列化器 对象</h2><pre><code>serializer = CommentSerializer(comment)
serializer.data
# {&apos;email&apos;: &apos;leila@example.com&apos;, &apos;content&apos;: &apos;foo bar&apos;, &apos;created&apos;: &apos;2016-01-27T15:17:10.375877&apos;}

from rest_framework.renderers import JSONRenderer

json = JSONRenderer().render(serializer.data)
json
# b&apos;{&quot;email&quot;:&quot;leila@example.com&quot;,&quot;content&quot;:&quot;foo bar&quot;,&quot;created&quot;:&quot;2016-01-27T15:17:10.375877&quot;}&apos;
</code></pre><h2 id="Deserializing-objects-反序列化"><a href="#Deserializing-objects-反序列化" class="headerlink" title="Deserializing objects 反序列化"></a>Deserializing objects 反序列化</h2><pre><code>from django.utils.six import BytesIO
from rest_framework.parsers import JSONParser

stream = BytesIO(json)
data = JSONParser().parse(stream)

serializer = CommentSerializer(data=data)
serializer.is_valid()
# True
serializer.validated_data
# {&apos;content&apos;: &apos;foo bar&apos;, &apos;email&apos;: &apos;leila@example.com&apos;, &apos;created&apos;: datetime.datetime(2012, 08, 22, 16, 20, 09, 822243)}
</code></pre><h2 id="Saving-instances"><a href="#Saving-instances" class="headerlink" title="Saving instances"></a>Saving instances</h2><p>实现 <code>update</code>,<code>create</code> 方法</p>
<pre><code>class CommentSerializer(serializers.Serializer):
    email = serializers.EmailField()
    content = serializers.CharField(max_length=200)
    created = serializers.DateTimeField()

    def create(self, validated_data):
        return Comment(**validated_data)

    def update(self, instance, validated_data):
        instance.email = validated_data.get(&apos;email&apos;, instance.email)
        instance.content = validated_data.get(&apos;content&apos;, instance.content)
        instance.created = validated_data.get(&apos;created&apos;, instance.created)
        return instance
</code></pre><p>如果这个对象属于 django 中的models：</p>
<pre><code>def create(self, validated_data):
    return Comment.objects.create(**validated_data)

def update(self, instance, validated_data):
    instance.email = validated_data.get(&apos;email&apos;, instance.email)
    instance.content = validated_data.get(&apos;content&apos;, instance.content)
    instance.created = validated_data.get(&apos;created&apos;, instance.created)
    instance.save()
    return instance
</code></pre><p>然后可以调用 <code>save()</code> 方法，返回值是 数据对象：</p>
<pre><code>comment = serializer.save()
</code></pre><p>调用 <code>save()</code> 方法会创建或者更新一条数据：</p>
<pre><code># .save() will create a new instance.
serializer = CommentSerializer(data=data)

# .save() will update the existing `comment` instance.
serializer = CommentSerializer(comment, data=data)
</code></pre><p><code>create()</code>, <code>update()</code> 方法都是可选方法，是否要实现取决于 serializer 类</p>
<h3 id="Passing-additional-attributes-to-save-传递参数到-save-方法中"><a href="#Passing-additional-attributes-to-save-传递参数到-save-方法中" class="headerlink" title="Passing additional attributes to .save() 传递参数到 save() 方法中"></a>Passing additional attributes to .save() 传递参数到 save() 方法中</h3><pre><code>serializer.save(owner=request.user)
</code></pre><p>这个额外的参数回被添加到 <code>validated_data</code> 中当 <code>.create()</code>,<code>.update()</code>方法被调用的时候</p>
<h3 id="Overriding-save-directly-重写-save-方法"><a href="#Overriding-save-directly-重写-save-方法" class="headerlink" title="Overriding .save() directly. 重写 save() 方法"></a>Overriding .save() directly. 重写 save() 方法</h3><pre><code>class ContactForm(serializers.Serializer):
    email = serializers.EmailField()
    message = serializers.CharField()

    def save(self):
        email = self.validated_data[&apos;email&apos;]
        message = self.validated_data[&apos;message&apos;]
        send_email(from=email, message=message)
</code></pre><h2 id="Validation-验证"><a href="#Validation-验证" class="headerlink" title="Validation 验证"></a>Validation 验证</h2><p>当反序列化数据的时候需要调用 <code>is_valid()</code> 方法来验证数据的正确性，如果数据有错误调用 <code>.errors</code> 可以获取到错误的具体内容：</p>
<pre><code>serializer = CommentSerializer(data={&apos;email&apos;: &apos;foobar&apos;, &apos;content&apos;: &apos;baz&apos;})
serializer.is_valid()
# False
serializer.errors
# {&apos;email&apos;: [u&apos;Enter a valid e-mail address.&apos;], &apos;created&apos;: [u&apos;This field is required.&apos;]}
</code></pre><p>字典中的那个 key 都是成员变量名， value 就是变量的值</p>
<h3 id="Raising-an-exception-on-invalid-data-抛出一个错误当数据非法的时候"><a href="#Raising-an-exception-on-invalid-data-抛出一个错误当数据非法的时候" class="headerlink" title="Raising an exception on invalid data 抛出一个错误当数据非法的时候"></a>Raising an exception on invalid data 抛出一个错误当数据非法的时候</h3><pre><code># Return a 400 response if the data was invalid.
serializer.is_valid(raise_exception=True)
</code></pre><h3 id="Field-level-validation"><a href="#Field-level-validation" class="headerlink" title="Field-level validation"></a>Field-level validation</h3><p>…</p>
<h1 id="ModelSerializer"><a href="#ModelSerializer" class="headerlink" title="ModelSerializer"></a>ModelSerializer</h1><p>ModelSerializer 提供了使用 Model fields 创建 Serializer 类的快捷方式</p>
<p>ModelSerializer 和 Serializer 一般一样除了：</p>
<ol>
<li>根据 model 自动创建字段</li>
<li>自动创建验证器</li>
<li>实现了 <code>.create()</code>,<code>.update()</code></li>
</ol>
<p>创建一个 ModelSerializer:</p>
<pre><code>class AccountSerializer(serializers.ModelSerializer):
    class Meta:
        model = Account
        fields = (&apos;id&apos;, &apos;account_name&apos;, &apos;users&apos;, &apos;created&apos;)
</code></pre><h2 id="Inspecting-a-ModelSerializer-查看一个-ModelSerializer"><a href="#Inspecting-a-ModelSerializer-查看一个-ModelSerializer" class="headerlink" title="Inspecting a ModelSerializer 查看一个 ModelSerializer"></a>Inspecting a ModelSerializer 查看一个 ModelSerializer</h2><pre><code>&gt;&gt;&gt; from myapp.serializers import AccountSerializer
&gt;&gt;&gt; serializer = AccountSerializer()
&gt;&gt;&gt; print(repr(serializer))
AccountSerializer():
    id = IntegerField(label=&apos;ID&apos;, read_only=True)
    name = CharField(allow_blank=True, max_length=100, required=False)
    owner = PrimaryKeyRelatedField(queryset=User.objects.all())
</code></pre><h2 id="Specifying-which-fields-to-include-定义哪些-fields-被包含在序列化中"><a href="#Specifying-which-fields-to-include-定义哪些-fields-被包含在序列化中" class="headerlink" title="Specifying which fields to include 定义哪些 fields 被包含在序列化中"></a>Specifying which fields to include 定义哪些 fields 被包含在序列化中</h2><p>定义所有fileds：<code>fields = __all__</code></p>
<pre><code>class AccountSerializer(serializers.ModelSerializer):
    class Meta:
        model = Account
        fields = &apos;__all__&apos;
</code></pre><p>指定部分fields：</p>
<pre><code>class AccountSerializer(serializers.ModelSerializer):
    class Meta:
        model = Account
        fields = (&apos;id&apos;, &apos;account_name&apos;, &apos;users&apos;, &apos;created&apos;)
</code></pre><p>使用 <code>exclude</code> 排除部分 fields：</p>
<pre><code>class AccountSerializer(serializers.ModelSerializer):
    class Meta:
        model = Account
        exclude = (&apos;users&apos;,)
</code></pre><h2 id="Specifying-nested-serialization-定义内部-序列化器"><a href="#Specifying-nested-serialization-定义内部-序列化器" class="headerlink" title="Specifying nested serialization 定义内部 序列化器"></a>Specifying nested serialization 定义内部 序列化器</h2><h2 id="Specifying-fields-explicitly-添加额外的字段"><a href="#Specifying-fields-explicitly-添加额外的字段" class="headerlink" title="Specifying fields explicitly 添加额外的字段"></a>Specifying fields explicitly 添加额外的字段</h2><pre><code>class AccountSerializer(serializers.ModelSerializer):
    url = serializers.CharField(source=&apos;get_absolute_url&apos;, read_only=True)
    groups = serializers.PrimaryKeyRelatedField(many=True)

    class Meta:
        model = Account
</code></pre><h2 id="Specifying-read-only-fields-指定自读字段"><a href="#Specifying-read-only-fields-指定自读字段" class="headerlink" title="Specifying read only fields 指定自读字段"></a>Specifying read only fields 指定自读字段</h2><p>方式一：给字段添加属性 <code>read_only=True</code></p>
<p>方式二：</p>
<pre><code>class AccountSerializer(serializers.ModelSerializer):
    class Meta:
        model = Account
        fields = (&apos;id&apos;, &apos;account_name&apos;, &apos;users&apos;, &apos;created&apos;)
        read_only_fields = (&apos;account_name&apos;,)
</code></pre><p>Model fields 中如果设置了：<code>editable=False</code>或者<code>AutoField</code> 默认为只读</p>
<h2 id="Additional-keyword-arguments-添加额外的参数"><a href="#Additional-keyword-arguments-添加额外的参数" class="headerlink" title="Additional keyword arguments 添加额外的参数"></a>Additional keyword arguments 添加额外的参数</h2><p><code>extra_kwargs</code></p>
<pre><code>class CreateUserSerializer(serializers.ModelSerializer):
    class Meta:
        model = User
        fields = (&apos;email&apos;, &apos;username&apos;, &apos;password&apos;)
        extra_kwargs = {&apos;password&apos;: {&apos;write_only&apos;: True}}

    def create(self, validated_data):
        user = User(
            email=validated_data[&apos;email&apos;],
            username=validated_data[&apos;username&apos;]
        )
        user.set_password(validated_data[&apos;password&apos;])
        user.save()
        return user
</code></pre><h2 id="Relational-fields"><a href="#Relational-fields" class="headerlink" title="Relational fields"></a>Relational fields</h2><h2 id="Inheritance-of-the-‘Meta’-class"><a href="#Inheritance-of-the-‘Meta’-class" class="headerlink" title="Inheritance of the ‘Meta’ class"></a>Inheritance of the ‘Meta’ class</h2><pre><code>class AccountSerializer(MyBaseSerializer):
    class Meta(MyBaseSerializer.Meta):
        model = Account
</code></pre><h2 id="Customizing-field-mappings"><a href="#Customizing-field-mappings" class="headerlink" title="Customizing field mappings"></a>Customizing field mappings</h2><h1 id="HyperlinkedModelSerializer-超级链接模型序列化器"><a href="#HyperlinkedModelSerializer-超级链接模型序列化器" class="headerlink" title="HyperlinkedModelSerializer 超级链接模型序列化器"></a>HyperlinkedModelSerializer 超级链接模型序列化器</h1><p>HyperlinkedModelSerializer 和 ModelSerializer 相似，除了它使用 hyperlinks 来实现关系网而不是主键。</p>
<p>默认添加 <code>url</code> 字段，而不是 主键字段。</p>
<pre><code>class AccountSerializer(serializers.HyperlinkedModelSerializer):
    class Meta:
        model = Account
        fields = (&apos;url&apos;, &apos;id&apos;, &apos;account_name&apos;, &apos;users&apos;, &apos;created&apos;)
</code></pre><h2 id="Absolute-and-relative-URLs-绝对和相对的-URLs"><a href="#Absolute-and-relative-URLs-绝对和相对的-URLs" class="headerlink" title="Absolute and relative URLs 绝对和相对的 URLs"></a>Absolute and relative URLs 绝对和相对的 URLs</h2><pre><code>serializer = AccountSerializer(queryset, context={&apos;request&apos;: request})

http://api.example.com/accounts/1/
</code></pre><p>If you do want to use relative URLs, you should explicitly pass {‘request’: None} in the serializer context.</p>
<pre><code>/accounts/1/
</code></pre><h2 id="How-hyperlinked-views-are-determined"><a href="#How-hyperlinked-views-are-determined" class="headerlink" title="How hyperlinked views are determined"></a>How hyperlinked views are determined</h2><p>。。。。。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/11/13/Python/django/django-rest-framework/4.django-rest-framework -- ViewSets/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Double">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/head1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Double">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/11/13/Python/django/django-rest-framework/4.django-rest-framework -- ViewSets/" itemprop="url">django-rest-framework -- ViewSets</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-11-13T13:18:12+08:00">
                2016-11-13
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index">
                    <span itemprop="name">Python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="ViewSets"><a href="#ViewSets" class="headerlink" title="ViewSets"></a>ViewSets</h1><h2 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h2><pre><code>from django.contrib.auth.models import User
from django.shortcuts import get_object_or_404
from myapps.serializers import UserSerializer
from rest_framework import viewsets
from rest_framework.response import Response

class UserViewSet(viewsets.ViewSet):
    &quot;&quot;&quot;
    A simple ViewSet for listing or retrieving users.
    &quot;&quot;&quot;
    def list(self, request):
        queryset = User.objects.all()
        serializer = UserSerializer(queryset, many=True)
        return Response(serializer.data)

    def retrieve(self, request, pk=None):
        queryset = User.objects.all()
        user = get_object_or_404(queryset, pk=pk)
        serializer = UserSerializer(user)
        return Response(serializer.data)
</code></pre><p>ViewSet 可分离：</p>
<pre><code>user_list = UserViewSet.as_view({&apos;get&apos;: &apos;list&apos;})
user_detail = UserViewSet.as_view({&apos;get&apos;: &apos;retrieve&apos;})
</code></pre><p>通常 url 设置：通过 router</p>
<pre><code>from myapp.views import UserViewSet
from rest_framework.routers import DefaultRouter

router = DefaultRouter()
router.register(r&apos;users&apos;, UserViewSet)
urlpatterns = router.urls
</code></pre><p>通常使用时可以继承 ModelViewSet ：</p>
<pre><code>class UserViewSet(viewsets.ModelViewSet):
    &quot;&quot;&quot;
    A viewset for viewing and editing user instances.
    &quot;&quot;&quot;
    serializer_class = UserSerializer
    queryset = User.objects.all()
</code></pre><h2 id="Marking-extra-actions-for-routing"><a href="#Marking-extra-actions-for-routing" class="headerlink" title="Marking extra actions for routing"></a>Marking extra actions for routing</h2><h1 id="API-Reference"><a href="#API-Reference" class="headerlink" title="API Reference"></a>API Reference</h1><h2 id="ViewSet"><a href="#ViewSet" class="headerlink" title="ViewSet"></a>ViewSet</h2><p>继承 APIView，</p>
<blockquote>
<p>The ViewSet class does not provide any implementations of actions. In order to use a ViewSet class you’ll override the class and define the action implementations explicitly.</p>
</blockquote>
<p>属于抽象类，如果使用这个类作为父类，需要自己实现方法</p>
<h2 id="GenericViewSet"><a href="#GenericViewSet" class="headerlink" title="GenericViewSet"></a>GenericViewSet</h2><p>继承 GenericAPIView</p>
<p>同样属于抽象类</p>
<h2 id="ModelViewSet"><a href="#ModelViewSet" class="headerlink" title="ModelViewSet"></a>ModelViewSet</h2><p>继承 GenericAPIView</p>
<p>提供的方法：.list(), .retrieve(), .create(), .update(), .partial_update(), and .destroy()</p>
<h3 id="Example-1"><a href="#Example-1" class="headerlink" title="Example"></a>Example</h3><p>使用 ModelViewSet ， 需要最少提供：queryset，serializer_class 属性</p>
<pre><code>class AccountViewSet(viewsets.ModelViewSet):
    &quot;&quot;&quot;
    A simple ViewSet for viewing and editing accounts.
    &quot;&quot;&quot;
    queryset = Account.objects.all()
    serializer_class = AccountSerializer
    permission_classes = [IsAccountAdminOrReadOnly]
</code></pre><h2 id="ReadOnlyModelViewSet"><a href="#ReadOnlyModelViewSet" class="headerlink" title="ReadOnlyModelViewSet"></a>ReadOnlyModelViewSet</h2><p>继承 GenericAPIView</p>
<p>only provides the ‘read-only’ actions：.list() and .retrieve()</p>
<h3 id="Example-2"><a href="#Example-2" class="headerlink" title="Example"></a>Example</h3><pre><code>class AccountViewSet(viewsets.ReadOnlyModelViewSet):
    &quot;&quot;&quot;
    A simple ViewSet for viewing accounts.
    &quot;&quot;&quot;
    queryset = Account.objects.all()
    serializer_class = AccountSerializer
</code></pre><h1 id="Custom-ViewSet-base-classes"><a href="#Custom-ViewSet-base-classes" class="headerlink" title="Custom ViewSet base classes"></a>Custom ViewSet base classes</h1><pre><code>class CreateListRetrieveViewSet(mixins.CreateModelMixin,
                                mixins.ListModelMixin,
                                mixins.RetrieveModelMixin,
                                viewsets.GenericViewSet):
    &quot;&quot;&quot;
    A viewset that provides `retrieve`, `create`, and `list` actions.

    To use it, override the class and set the `.queryset` and
    `.serializer_class` attributes.
    &quot;&quot;&quot;
    pass
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/11/10/Python/django/django-rest-framework/2.django-rest-framework -- Views/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Double">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/head1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Double">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/11/10/Python/django/django-rest-framework/2.django-rest-framework -- Views/" itemprop="url">django-rest-framework -- Views</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-11-10T13:18:12+08:00">
                2016-11-10
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index">
                    <span itemprop="name">Python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Class-based-Views-视图基本类"><a href="#Class-based-Views-视图基本类" class="headerlink" title="Class-based Views 视图基本类"></a>Class-based Views 视图基本类</h1><p>rest_framework 提供 <code>APIView</code> ，继承自 django 的视图类 <code>View</code></p>
<p><code>APIView</code> 相比较正常的 <code>View</code> 的特点：</p>
<ol>
<li><p>接收的请求是 rest-framework 的 Request 实例</p>
<p> Requests passed to the handler methods will be REST framework’s Request instances, not Django’s HttpRequest instances.</p>
</li>
<li><p>请求处理结果返回的也是 rest-framework 的 Response</p>
<p> Handler methods may return REST framework’s Response, instead of Django’s HttpResponse. The view will manage content negotiation and setting the correct renderer on the response.</p>
</li>
<li><p>任何的异常将会被捕获，反馈到 response 中</p>
<p> Any APIException exceptions will be caught and mediated into appropriate responses.</p>
</li>
<li><p>请求会先检查其权限</p>
<p> Incoming requests will be authenticated and appropriate permission and/or throttle checks will be run before dispatching the request to the handler method.</p>
</li>
</ol>
<p>使用 APIView 和使用正常的 View 用法基本相同，类中都有请求方法的相应方法 如：<code>.get()</code>, <code>.post()</code>。。。</p>
<p>例子：</p>
<pre><code>from rest_framework.views import APIView
from rest_framework.response import Response
from rest_framework import authentication, permissions

class ListUsers(APIView):
    &quot;&quot;&quot;
    View to list all users in the system.

    * Requires token authentication.
    * Only admin users are able to access this view.
    &quot;&quot;&quot;
    authentication_classes = (authentication.TokenAuthentication,)
    permission_classes = (permissions.IsAdminUser,)

    def get(self, request, format=None):
        &quot;&quot;&quot;
        Return a list of all users.
        &quot;&quot;&quot;
        usernames = [user.username for user in User.objects.all()]
        return Response(usernames)
</code></pre><h2 id="API-policy-attributes-类的属性"><a href="#API-policy-attributes-类的属性" class="headerlink" title="API policy attributes 类的属性"></a>API policy attributes 类的属性</h2><ul>
<li>.renderer_classes</li>
<li>.parser_classes</li>
<li>.authentication_classes ：认证</li>
<li>.throttle_classes</li>
<li>.permission_classes ： 权限</li>
<li>.content_negotiation_class</li>
</ul>
<h2 id="API-policy-instantiation-methods-对象的方法"><a href="#API-policy-instantiation-methods-对象的方法" class="headerlink" title="API policy instantiation methods 对象的方法"></a>API policy instantiation methods 对象的方法</h2><p>6个方法，对应上面6个属性的 <code>get</code> 方法</p>
<ul>
<li>.get_renderers(self)</li>
</ul>
<h2 id="API-policy-implementation-methods-实现的方法"><a href="#API-policy-implementation-methods-实现的方法" class="headerlink" title="API policy implementation methods 实现的方法"></a>API policy implementation methods 实现的方法</h2><p>下面3个方法会在请求分配前执行</p>
<ul>
<li>.check_permissions(self, request)</li>
<li>.check_throttles(self, request)</li>
<li>.perform_content_negotiation(self, request, force=False)</li>
</ul>
<h2 id="Dispatch-methods-请求调度方法"><a href="#Dispatch-methods-请求调度方法" class="headerlink" title="Dispatch methods 请求调度方法"></a>Dispatch methods 请求调度方法</h2><p>执行 <code>.dispatch()</code> , 将请求分配给具体的方法 .get(), .post(), put(), patch() and .delete().</p>
<h3 id="initial-self-request-args-kwargs"><a href="#initial-self-request-args-kwargs" class="headerlink" title=".initial(self, request, *args, **kwargs)"></a>.initial(self, request, *args, **kwargs)</h3><p>在处理方法之前执行，用来做权限判断等，</p>
<p>一般不需要去重写</p>
<h3 id="handle-exception-self-exc"><a href="#handle-exception-self-exc" class="headerlink" title=".handle_exception(self, exc)"></a>.handle_exception(self, exc)</h3><p>错误处理</p>
<p>会捕获所有 <code>rest_framework.exceptions.APIException</code> 的子类异常，和 Django <code>Http404</code>,<code>PermissionDenied</code> 异常。</p>
<p>如果需要自定义错误的返回，需要重写这个方法</p>
<h2 id="initialize-request-self-request-args-kwargs"><a href="#initialize-request-self-request-args-kwargs" class="headerlink" title=".initialize_request(self, request, *args, **kwargs)"></a>.initialize_request(self, request, *args, **kwargs)</h2><p>这个方法用来确保请求属于 <code>Request</code> ，而不是原生请求 <code>HttpRequest</code></p>
<p>一般不需要去重写</p>
<h2 id="finalize-response-self-request-response-args-kwargs"><a href="#finalize-response-self-request-response-args-kwargs" class="headerlink" title=".finalize_response(self, request, response, *args, **kwargs)"></a>.finalize_response(self, request, response, *args, **kwargs)</h2><p>确保请求返回的对象是 <code>Response</code></p>
<p>一般不需要去重写</p>
<h1 id="Function-Based-Views"><a href="#Function-Based-Views" class="headerlink" title="Function Based Views"></a>Function Based Views</h1><p>通过注解实现</p>
<h2 id="api-view"><a href="#api-view" class="headerlink" title="@api_view()"></a>@api_view()</h2><p><code>@api_view(http_method_names=[&#39;GET&#39;], exclude_from_schema=False)</code></p>
<h2 id="API-policy-decorators-api-装饰器"><a href="#API-policy-decorators-api-装饰器" class="headerlink" title="API policy decorators api 装饰器"></a>API policy decorators api 装饰器</h2><p>需要写在 <code>@api_view</code> 之后</p>
<pre><code>@throttle_classes([OncePerDayUserThrottle]) # 确保这个 api 一天被调用一次
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/11/10/Python/django/django-rest-framework/Django Model field reference/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Double">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/head1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Double">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/11/10/Python/django/django-rest-framework/Django Model field reference/" itemprop="url">Django Model Field reference</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-11-10T13:18:12+08:00">
                2016-11-10
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index">
                    <span itemprop="name">Python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h1 id="Field-options"><a href="#Field-options" class="headerlink" title="Field options"></a>Field options</h1><h2 id="null"><a href="#null" class="headerlink" title="null"></a>null</h2><p><code>Field.null</code></p>
<p>如果 True django 会用 NULL 存储空值。默认 False.</p>
<blockquote>
<p>If True, Django will store empty values as NULL in the database. Default is False.</p>
</blockquote>
<p>If you want to accept null values with BooleanField, use NullBooleanField instead.</p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2016/11/10/Python/django/django-rest-framework/Django Model field reference/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/11/07/Python/django/django-rest-framework/django-rest-framework 提高/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Double">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/head1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Double">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/11/07/Python/django/django-rest-framework/django-rest-framework 提高/" itemprop="url">django-rest-framework 提高</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-11-07T13:18:12+08:00">
                2016-11-07
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index">
                    <span itemprop="name">Python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="一个后台架构需要考虑的"><a href="#一个后台架构需要考虑的" class="headerlink" title="一个后台架构需要考虑的"></a>一个后台架构需要考虑的</h1><p>统一的异常处理<br>api权限<br>统一的参数校验<br>缓存如何可以做的更简单统一<br>认证<br>统一的查询过滤<br>代码分层</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/11/07/Python/django/django-rest-framework/django-rest-framework/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Double">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/head1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Double">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/11/07/Python/django/django-rest-framework/django-rest-framework/" itemprop="url">django-rest-framework 官方文档记录</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-11-07T13:18:12+08:00">
                2016-11-07
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index">
                    <span itemprop="name">Python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h1 id="Tutorial-1-Serialization-序列化"><a href="#Tutorial-1-Serialization-序列化" class="headerlink" title="Tutorial 1: Serialization 序列化"></a>Tutorial 1: Serialization 序列化</h1><h2 id="安装基本环境"><a href="#安装基本环境" class="headerlink" title="安装基本环境"></a>安装基本环境</h2><pre><code>pip install django
pip install djangorestframework
pip install pygments  # We&apos;ll be using this for the code highlighting
</code></pre><h2 id="开始-创建测试环境"><a href="#开始-创建测试环境" class="headerlink" title="开始 创建测试环境"></a>开始 创建测试环境</h2><p>创建一个 django 工程</p>
<pre><code>django-admin.py startproject tutorial
</code></pre><p>在工程中创建一个 app</p>
<pre><code>python manage.py startapp snippets
</code></pre>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2016/11/07/Python/django/django-rest-framework/django-rest-framework/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/11/07/linux/terminal设置代理/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Double">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/head1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Double">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/11/07/linux/terminal设置代理/" itemprop="url">Terminal 设置代理</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-11-07T11:38:14+08:00">
                2016-11-07
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/program/" itemprop="url" rel="index">
                    <span itemprop="name">program</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <pre><code>$ export http_proxy=&apos;http://localhost:8087&apos;
$ export https_proxy=&apos;http://localhost:8087&apos;


export http_proxy=http://127.0.0.1:1080/
export https_proxy=http://127.0.0.1:1080/
</code></pre><p>PS：别用 ping 对以上代理进行测试，不管用。</p>
<p>以上 需要 查看 SS 是否自带 Http 代理端口。</p>
<h1 id="设置-Shadowsocks-代理"><a href="#设置-Shadowsocks-代理" class="headerlink" title="设置 Shadowsocks 代理"></a>设置 Shadowsocks 代理</h1><p><img src="http://droidyue.com/blog/2016/04/04/set-shadowsocks-proxy-for-terminal/index.html" alt="http://droidyue.com/blog/2016/04/04/set-shadowsocks-proxy-for-terminal/index.html"></p>
<h2 id="mac"><a href="#mac" class="headerlink" title="mac"></a>mac</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install polipo</span><br></pre></td></tr></table></figure>
<h3 id="修改配置"><a href="#修改配置" class="headerlink" title="修改配置:"></a>修改配置:</h3><p>设置每次登陆启动polipo</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ln -sfv /usr/local/opt/polipo/*.plist ~/Library/LaunchAgents</span><br></pre></td></tr></table></figure>
<p>修改文件/usr/local/opt/polipo/homebrew.mxcl.polipo.plist设置parentProxy:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;</span><br><span class="line">&lt;plist version=&quot;1.0&quot;&gt;</span><br><span class="line">  &lt;dict&gt;</span><br><span class="line">    &lt;key&gt;Label&lt;/key&gt;</span><br><span class="line">    &lt;string&gt;homebrew.mxcl.polipo&lt;/string&gt;</span><br><span class="line">    &lt;key&gt;RunAtLoad&lt;/key&gt;</span><br><span class="line">    &lt;true/&gt;</span><br><span class="line">    &lt;key&gt;KeepAlive&lt;/key&gt;</span><br><span class="line">    &lt;true/&gt;</span><br><span class="line">    &lt;key&gt;ProgramArguments&lt;/key&gt;</span><br><span class="line">    &lt;array&gt;</span><br><span class="line">        &lt;string&gt;/usr/local/opt/polipo/bin/polipo&lt;/string&gt;</span><br><span class="line">        &lt;string&gt;socksParentProxy=localhost:1080&lt;/string&gt;</span><br><span class="line">    &lt;/array&gt;</span><br><span class="line">    &lt;!-- Set `ulimit -n 20480`. The default OS X limit is 256, that&apos;s</span><br><span class="line">         not enough for Polipo (displays &apos;too many files open&apos; errors).</span><br><span class="line">         It seems like you have no reason to lower this limit</span><br><span class="line">         (and unlikely will want to raise it). --&gt;</span><br><span class="line">    &lt;key&gt;SoftResourceLimits&lt;/key&gt;</span><br><span class="line">    &lt;dict&gt;</span><br><span class="line">      &lt;key&gt;NumberOfFiles&lt;/key&gt;</span><br><span class="line">      &lt;integer&gt;20480&lt;/integer&gt;</span><br><span class="line">    &lt;/dict&gt;</span><br><span class="line">  &lt;/dict&gt;</span><br><span class="line">&lt;/plist&gt;</span><br></pre></td></tr></table></figure></p>
<p>修改的地方是增加了<code>&lt;string&gt;socksParentProxy=localhost:1080&lt;/string&gt;</code></p>
<h3 id="启动-Mac"><a href="#启动-Mac" class="headerlink" title="启动(Mac):"></a>启动(Mac):</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">launchctl unload ~/Library/LaunchAgents/homebrew.mxcl.polipo.plist</span><br><span class="line">launchctl load ~/Library/LaunchAgents/homebrew.mxcl.polipo.plis</span><br><span class="line"></span><br><span class="line">// or</span><br><span class="line">launchctl unload /usr/local/opt/polipo/homebrew.mxcl.polipo.plist</span><br><span class="line">launchctl load /usr/local/opt/polipo/homebrew.mxcl.polipo.plist</span><br></pre></td></tr></table></figure>
<h3 id="验证及使用"><a href="#验证及使用" class="headerlink" title="验证及使用:"></a>验证及使用:</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">07:56:24-androidyue/var/log$ curl ip.gs</span><br><span class="line">当前 IP：125.39.112.15 来自：中国天津天津 联通</span><br><span class="line">08:09:23-androidyue/var/log$ http_proxy=http://localhost:8123 curl ip.gs</span><br><span class="line">当前 IP：210.140.193.128 来自：日本日本</span><br></pre></td></tr></table></figure>
<h3 id="设置别名"><a href="#设置别名" class="headerlink" title="设置别名:"></a>设置别名:</h3><p>bash中有一个很好的东西，就是别名alias. Linux用户修改~/.bashrc，Mac用户修改~/.bash_profile文件，增加如下设置:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alias hp=&quot;http_proxy=http://localhost:8123&quot;</span><br></pre></td></tr></table></figure>
<p>然后Linux用户执行source ~/.bashrc，Mac用户执行source ~/.bash_profile</p>
<p>使用：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">20:39:39-androidyue~$ curl ip.gs</span><br><span class="line">当前 IP：125.39.112.14 来自：中国天津天津 联通</span><br><span class="line">20:39:44-androidyue~$ hp curl ip.gs</span><br><span class="line">当前 IP：210.140.193.128 来自：日本日本 </span><br><span class="line">20:39:48-androidyue~$</span><br></pre></td></tr></table></figure></p>
<h3 id="当前会话全局设置"><a href="#当前会话全局设置" class="headerlink" title="当前会话全局设置"></a>当前会话全局设置</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">export http_proxy=http://localhost:8123</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">unset http_proxy</span><br></pre></td></tr></table></figure>
<p>如果想要更长久的设置代理，可以将export http_proxy=<a href="http://localhost:8123加入.bashrc或者.bash_profile文件" target="_blank" rel="noopener">http://localhost:8123加入.bashrc或者.bash_profile文件</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/11/04/Android/Android 版本/Android5.0/material_design/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Double">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/head1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Double">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/11/04/Android/Android 版本/Android5.0/material_design/" itemprop="url">Material Design</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-11-04T22:38:14+08:00">
                2016-11-04
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/" itemprop="url" rel="index">
                    <span itemprop="name">Android</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>来源：官方文档</p>
<h1 id="入门指南"><a href="#入门指南" class="headerlink" title="入门指南"></a>入门指南</h1><p><a href="https://developer.android.com/training/material/get-started.html" target="_blank" rel="noopener">入门指南</a></p>
<p>如果要使用 Material Design 创建应用需要做到以下几点：</p>
<ol>
<li>请查阅 <a href="http://www.google.com/design/spec" target="_blank" rel="noopener">Material Design 规范</a>。</li>
<li>在您的应用中使用材料主题。</li>
<li>遵循 Material Design 指导方针创建您的布局。</li>
<li>指定您视图要投射阴影的高度。</li>
<li>使用系统小组件呈现列表与卡片。</li>
<li>定制您的应用中的动画。</li>
</ol>
<h1 id="使用材料主题"><a href="#使用材料主题" class="headerlink" title="使用材料主题"></a>使用材料主题</h1><blockquote>
<p>注意：材料主题仅在 Android 5.0（API 级别 21）及更高版本中提供。<br>如果 Activity 继承自 AppCompatActivity， 就必须使用兼容主题 Theme.AppCompat.Light.NoActionBar</p>
</blockquote>
<p>新材料主题提供的：</p>
<ol>
<li>让您设置主题配色工具的系统小组件</li>
<li>适用于系统小组件的触摸反馈动画</li>
<li>操作行为转换动画</li>
</ol>
<p>查看 <a href="https://developer.android.com/reference/android/R.style.html" target="_blank" rel="noopener"> R.style</a> 了解更多关于主题的细节。</p>
<h2 id="定制配色"><a href="#定制配色" class="headerlink" title="定制配色"></a>定制配色</h2><pre><code>&lt;resources&gt;
  &lt;!-- inherit from the material theme --&gt;
  &lt;style name=&quot;AppTheme&quot; parent=&quot;android:Theme.Material&quot;&gt;
    &lt;!-- Main theme colors --&gt;
    &lt;!--   your app branding color for the app bar --&gt;
    &lt;item name=&quot;android:colorPrimary&quot;&gt;@color/primary&lt;/item&gt;
    &lt;!--   darker variant for the status bar and contextual app bars --&gt;
    &lt;item name=&quot;android:colorPrimaryDark&quot;&gt;@color/primary_dark&lt;/item&gt;
    &lt;!--   theme UI controls like checkboxes and text fields --&gt;
    &lt;item name=&quot;android:colorAccent&quot;&gt;@color/accent&lt;/item&gt;
  &lt;/style&gt;
&lt;/resources&gt;
</code></pre><h2 id="定制状态栏"><a href="#定制状态栏" class="headerlink" title="定制状态栏"></a>定制状态栏</h2><h3 id="方式一-设置属性"><a href="#方式一-设置属性" class="headerlink" title="方式一 设置属性"></a>方式一 设置属性</h3><p>在扩展材料主题时使用 android:statusBarColor 属性设置状态栏颜色</p>
<p>让状态栏透明可以设置值为：<code>@android:color/transparent</code></p>
<blockquote>
<p>默认情况下，android:statusBarColor 将继承 android:colorPrimaryDark 的值。</p>
</blockquote>
<h2 id="方式二"><a href="#方式二" class="headerlink" title="方式二"></a>方式二</h2><pre><code>Window.setStatusBarColor()
</code></pre><h2 id="给-Activity-设置不用的主题"><a href="#给-Activity-设置不用的主题" class="headerlink" title="给 Activity 设置不用的主题"></a>给 Activity 设置不用的主题</h2><pre><code>XML 布局定义内的元素可指定 android:theme
</code></pre><h2 id="布局设计"><a href="#布局设计" class="headerlink" title="布局设计"></a>布局设计</h2><p><a href="http://www.google.com/design/spec" target="_blank" rel="noopener">Material Design 指导方针</a></p>
<p>需要注意的点：</p>
<ol>
<li>基线格点</li>
<li>关键线</li>
<li>间距</li>
<li>触摸目标大小</li>
<li>布局结构</li>
</ol>
<h2 id="指定视图的高度"><a href="#指定视图的高度" class="headerlink" title="指定视图的高度"></a>指定视图的高度</h2><p>设置属性： ‘android:elevation’</p>
<p>属性：’translationZ’ 可以创建反映出视图高度临时变化的动画，高度变化可在<a href="https://developer.android.com/training/material/animations.html#ViewState" target="_blank" rel="noopener">响应触摸手势</a>时发挥作用。</p>
<p>更多相关：<a href="https://developer.android.com/training/material/shadows-clipping.html" target="_blank" rel="noopener">定义阴影与裁剪视图</a></p>
<h1 id="创建列表与卡片"><a href="#创建列表与卡片" class="headerlink" title="创建列表与卡片"></a>创建列表与卡片</h1><p>使用 <code>RecyclerView</code>, <code>CardView</code></p>
<h2 id="RecyclerView-使用"><a href="#RecyclerView-使用" class="headerlink" title="RecyclerView 使用"></a>RecyclerView 使用</h2><h3 id="优化"><a href="#优化" class="headerlink" title="优化"></a>优化</h3><pre><code>// use this setting to improve performance if you know that changes
// in content do not change the layout size of the RecyclerView
mRecyclerView.setHasFixedSize(true);
</code></pre><h3 id="设置动画"><a href="#设置动画" class="headerlink" title="设置动画"></a>设置动画</h3><p>扩展 RecyclerView.ItemAnimator 类别并使用 RecyclerView.setItemAnimator() 方法。</p>
<h2 id="CardView"><a href="#CardView" class="headerlink" title="CardView"></a>CardView</h2><p>扩展自 FrameLayout</p>
<ul>
<li><p>设置阴影：<code>card_view:cardElevation</code> (在 Android 5.0（API 级别 21）及更高版本中使用真实高度与动态阴影，而在早期的 Android 版本中则返回编程阴影实现。)</p>
</li>
<li><p>设置圆角： <code>card_view:cardCornerRadius</code>, <code>CardView.setRadius</code></p>
</li>
<li>背景色：<code>card_view:cardBackgroundColor</code></li>
</ul>
<h1 id="定义阴影与裁剪视图"><a href="#定义阴影与裁剪视图" class="headerlink" title="定义阴影与裁剪视图"></a>定义阴影与裁剪视图</h1><p>由 Z 属性所表示的视图高度将决定其阴影的视觉外观：拥有较高 Z 值的视图将投射更大且更柔和的阴影。 拥有较高 Z 值的视图将挡住拥有较低 Z 值的视图；不过视图的 Z 值并不影响视图的大小。</p>
<h2 id="指定视图高度"><a href="#指定视图高度" class="headerlink" title="指定视图高度"></a>指定视图高度</h2><ul>
<li>高度：静态组件。</li>
<li>转换：用于动画的动态组件</li>
</ul>
<p>Z = elevation + translationZ</p>
<p>定义视图高度： <code>android:elevation</code>, <code>View.setElevation()</code></p>
<p>设置视图转换，请使用 View.setTranslationZ() 方法</p>
<p>全新的 ViewPropertyAnimator.z() 与 ViewPropertyAnimator.translationZ() 方法让您能够轻松地为视图高度添加动画。如果要了解更多信息，请参阅 ViewPropertyAnimator 的 API 参考以及属性动画开发者指南。</p>
<p>Z 值以 dp（密度独立像素）为单位度量</p>
<h4 id="各个控件应该设置的高度"><a href="#各个控件应该设置的高度" class="headerlink" title="各个控件应该设置的高度"></a>各个控件应该设置的高度</h4><p><img src="https://raw.githubusercontent.com/fangmd/markdownphoto/master/src/material_design.png" alt="Material_design 各个控件的高度"></p>
<h2 id="自定义视图阴影与轮廓"><a href="#自定义视图阴影与轮廓" class="headerlink" title="自定义视图阴影与轮廓"></a>自定义视图阴影与轮廓</h2><p>视图的背景可绘制对象的边界将决定其阴影的默认形状。</p>
<p>背景可绘制对象被定义为一个拥有圆角的矩形：</p>
<pre><code>&lt;!-- res/drawable/myrect.xml --&gt;
&lt;shape xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
       android:shape=&quot;rectangle&quot;&gt;
    &lt;solid android:color=&quot;#42000000&quot; /&gt;
    &lt;corners android:radius=&quot;5dp&quot; /&gt;
&lt;/shape&gt;
</code></pre><p>视图将投射一个带有圆角的阴影，因为背景可绘制对象将定义视图的轮廓。</p>
<h2 id="裁剪视图"><a href="#裁剪视图" class="headerlink" title="裁剪视图"></a>裁剪视图</h2><p><code>View.setClipToOutline()</code>, <code>android:clipToOutline</code></p>
<h1 id="Working-with-drawable"><a href="#Working-with-drawable" class="headerlink" title="Working with drawable"></a>Working with drawable</h1><ul>
<li>图片着色</li>
<li>突出颜色萃取</li>
<li>矢量图片</li>
</ul>
<h2 id="为图片资源着色"><a href="#为图片资源着色" class="headerlink" title="为图片资源着色"></a>为图片资源着色</h2><p><code>android:tint</code>, <code>android:tintMode</code>, <code>setTint()</code> 为  BitmapDrawable 或 NinePatchDrawable 对象着色</p>
<h2 id="从图像萃取突出颜色"><a href="#从图像萃取突出颜色" class="headerlink" title="从图像萃取突出颜色"></a>从图像萃取突出颜色</h2><p>Android 支持内容库 r21 及更高版本包括 Palette 类别，可让您从图像萃取突出颜色。</p>
<p>萃取下列突出颜色:</p>
<ul>
<li>鲜艳</li>
<li>鲜艳深色</li>
<li>鲜艳浅色</li>
<li>低调</li>
<li>低调深色</li>
<li>低调浅色</li>
</ul>
<p>usage: 将 Bitmap 对象传递给位于您上载图像的背景线程的 Palette.generate() 静态方法。 如果您无法使用此线程，请调用 Palette.generateAsync() 方法并提供一个侦听程序。</p>
<pre><code>dependencies {
    ...
    compile &apos;com.android.support:palette-v7:21.0.0&apos;
}
</code></pre><h1 id="定制您的动画-Defining-Custom-animations"><a href="#定制您的动画-Defining-Custom-animations" class="headerlink" title="定制您的动画 Defining Custom animations"></a>定制您的动画 Defining Custom animations</h1><p> Android 5.0（API 级别 21）及更高版本可让您定制这些动画，同时也可创建新动画：</p>
<ul>
<li>触摸反馈</li>
<li>循环揭露</li>
<li>操作行为转换</li>
<li>曲线运动</li>
<li>视图状态改变</li>
</ul>
<h2 id="定制触摸反馈"><a href="#定制触摸反馈" class="headerlink" title="定制触摸反馈"></a>定制触摸反馈</h2><p>利用 RippleDrawable 实现触摸波纹效果</p>
<ul>
<li>?android:attr/selectableItemBackground 指定有界的波纹。</li>
<li>?android:attr/selectableItemBackgroundBorderless 指定越过视图边界的波纹</li>
</ul>
<p>改变默认触摸反馈颜色，请使用主题的 android:colorControlHighlight 属性</p>
<h2 id="使用揭露效果"><a href="#使用揭露效果" class="headerlink" title="使用揭露效果"></a>使用揭露效果</h2><p>ViewAnimationUtils.createCircularReveal() 方法让您能够为裁剪区域添加动画以揭露或隐藏视图。</p>
<p>显示view</p>
<pre><code>final TextView tv9 = (TextView) findViewById(R.id.tv9);

findViewById(R.id.content_main).setOnClickListener(new View.OnClickListener() {
    @Override public void onClick(View v) {
        // get the center for the clipping circle
        int cx = (tv9.getRight() - tv9.getLeft()) / 2;
        int cy = (tv9.getBottom() - tv9.getTop()) / 2;

        // get the final radius for the clipping circle
        int finalRadius = Math.max(tv9.getWidth(), tv9.getHeight());

        // create the animator for this view (the start radius is zero)
        final Animator anim = ViewAnimationUtils.createCircularReveal(tv9, cx, cy, 0, finalRadius);

        tv9.setVisibility(View.VISIBLE);

        anim.start();
    }
});
</code></pre><p>隐藏view：</p>
<pre><code>final TextView tv9 = (TextView) findViewById(R.id.tv9);

tv9.setOnClickListener(new View.OnClickListener() {
    @Override public void onClick(View v) {
        // get the center for the clipping circle
        int cx = (tv9.getRight() - tv9.getLeft()) / 2;
        int cy = (tv9.getBottom() - tv9.getTop()) / 2;

        // get the final radius for the clipping circle
        int initRadius = Math.max(tv9.getWidth(), tv9.getHeight());

        // create the animator for this view (the start radius is zero)
        final Animator anim = ViewAnimationUtils.createCircularReveal(tv9, cx, cy, initRadius, 0);

        anim.addListener(new AnimatorListenerAdapter() {
            @Override public void onAnimationEnd(Animator animation) {
                super.onAnimationEnd(animation);
                // make the view visible and start the animation
                tv9.setVisibility(View.INVISIBLE);
            }
        });
        anim.start();
    }
});
</code></pre><p>沿着中心缩小:</p>
<pre><code>Animator animator = ViewAnimationUtils.createCircularReveal(view, view.getWidth() / 2, view.getHeight() / 2, view.getWidth(), 0);
animator.setInterpolator(new LinearInterpolator());
animator.setDuration(1000);
animator.start();
</code></pre><p>从左上角扩展：</p>
<pre><code>Animator animator = ViewAnimationUtils.createCircularReveal(view,0,0,0,(float) Math.hypot(view.getWidth(), view.getHeight()));
animator.setDuration(1000);
animator.start();
</code></pre><h2 id="定制操作行为转换"><a href="#定制操作行为转换" class="headerlink" title="定制操作行为转换"></a>定制操作行为转换</h2><p>为进入、退出转换以及操作行为之间的共享元素转换指定定制动画</p>
<p>Android 5.0（API 级别 21）支持这些进入与退出转换：</p>
<ul>
<li>分解 - 从场景中心移入或移出视图。</li>
<li>滑动 - 从场景边缘移入或移出视图。</li>
<li>淡入淡出 - 通过调整透明度在场景中增添或移除视图。</li>
</ul>
<p>任何扩展 Visibility 类别的转换均将获得进入或退出转换支持。 如果要了解更多信息，请参阅 Transition 类别的 API 参考文档。</p>
<p>Android 5.0（API 级别 21）也支持这些共享元素转换：</p>
<ul>
<li>changeBounds - 为目标视图的布局边界的变化添加动画。</li>
<li>changeClipBounds - 为目标视图的裁剪边界的变化添加动画。</li>
<li>changeTransform - 为目标视图的缩放与旋转变化添加动画。</li>
<li>changeImageTransform - 为目标图像的大小与缩放变化添加动画。</li>
</ul>
<h2 id="指定定制转换"><a href="#指定定制转换" class="headerlink" title="指定定制转换"></a>指定定制转换</h2><p>材料主题继承的风格时，使用 android:windowContentTransitions 属性启用窗口内容转换</p>
<pre><code>&lt;style name=&quot;BaseAppTheme&quot; parent=&quot;android:Theme.Material&quot;&gt;
  &lt;!-- enable window content transitions --&gt;
  &lt;item name=&quot;android:windowContentTransitions&quot;&gt;true&lt;/item&gt;

  &lt;!-- specify enter and exit transitions --&gt;
  &lt;item name=&quot;android:windowEnterTransition&quot;&gt;@transition/explode&lt;/item&gt;
  &lt;item name=&quot;android:windowExitTransition&quot;&gt;@transition/explode&lt;/item&gt;

  &lt;!-- specify shared element transitions --&gt;
  &lt;item name=&quot;android:windowSharedElementEnterTransition&quot;&gt;
    @transition/change_image_transform&lt;/item&gt;
  &lt;item name=&quot;android:windowSharedElementExitTransition&quot;&gt;
    @transition/change_image_transform&lt;/item&gt;
&lt;/style&gt;
</code></pre><p>change_image_transform:</p>
<pre><code>&lt;!-- res/transition/change_image_transform.xml --&gt;
&lt;!-- (see also Shared Transitions below) --&gt;
&lt;transitionSet xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;
  &lt;changeImageTransform/&gt;
&lt;/transitionSet&gt;
</code></pre><p>如果要在您的代码中启用窗口内容转换，请调用 Window.requestFeature() 方法：</p>
<pre><code>// inside your activity (if you did not enable transitions in your theme)
getWindow().requestFeature(Window.FEATURE_CONTENT_TRANSITIONS);

// set an exit transition
getWindow().setExitTransition(new Explode());
</code></pre><p>如果要在您的代码中指定转换，请以 Transition 对象调用这些方法：</p>
<ul>
<li>Window.setEnterTransition()</li>
<li>Window.setExitTransition()</li>
<li>Window.setSharedElementEnterTransition()</li>
<li>Window.setSharedElementExitTransition()</li>
</ul>
<p>setExitTransition() 和 setSharedElementExitTransition() 方法定义正在调用的操作行为的退出转换。 setEnterTransition() 与 setSharedElementEnterTransition() 方法定义被调用的操作行为的进入转换。</p>
<h2 id="使用转换启动一个操作行为"><a href="#使用转换启动一个操作行为" class="headerlink" title="使用转换启动一个操作行为"></a>使用转换启动一个操作行为</h2><pre><code>startActivity(intent,
              ActivityOptions.makeSceneTransitionAnimation(this).toBundle());
</code></pre><h2 id="以共享元素启动一个操作行为"><a href="#以共享元素启动一个操作行为" class="headerlink" title="以共享元素启动一个操作行为"></a>以共享元素启动一个操作行为</h2><p>如果要在两个拥有共享元素的操作行为之间安排屏幕转换动画：</p>
<ol>
<li>请在您的主题中启用窗口内容转换。</li>
<li>在您的风格中指定一个共享元素转换。</li>
<li>将您的转换定义为 XML 资源。</li>
<li>利用 android:transitionName 属性对两个布局中的共享元素指定一个通用名称。</li>
<li><p>使用 ActivityOptions.makeSceneTransitionAnimation() 方法。</p>
<pre><code>// get the element that receives the click event
final View imgContainerView = findViewById(R.id.img_container);

// get the common element for the transition in this activity
final View androidRobotView = findViewById(R.id.image_small);

// define a click listener
imgContainerView.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View view) {
        Intent intent = new Intent(this, Activity2.class);
        // create the transition animation - the images in the layouts
        // of both activities are defined with android:transitionName=&quot;robot&quot;
        ActivityOptions options = ActivityOptions
            .makeSceneTransitionAnimation(this, androidRobotView, &quot;robot&quot;);
        // start the new activity
        startActivity(intent, options.toBundle());
    }
});
</code></pre></li>
</ol>
<p>对于在您的代码中生成的共享动态视图，请使用 View.setTransitionName() 方法在两个操作行为中指定一个通用元素名称。</p>
<p>如果要在完成第二项操作行为时反转场景转换动画，请调用 Activity.finishAfterTransition() 方法而非 Activity.finish()。</p>
<h2 id="以多个共享元素启动一个操作行为"><a href="#以多个共享元素启动一个操作行为" class="headerlink" title="以多个共享元素启动一个操作行为"></a>以多个共享元素启动一个操作行为</h2><pre><code>ActivityOptions options = ActivityOptions.makeSceneTransitionAnimation(this,
        Pair.create(view1, &quot;agreedName1&quot;),
        Pair.create(view2, &quot;agreedName2&quot;));
</code></pre><h2 id="使用曲线运动"><a href="#使用曲线运动" class="headerlink" title="使用曲线运动"></a>使用曲线运动</h2><p>PathInterpolator 类别是一个基于贝塞尔曲线或 Path 对象的全新插入器。</p>
<pre><code>&lt;pathInterpolator xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    android:controlX1=&quot;0.4&quot;
    android:controlY1=&quot;0&quot;
    android:controlX2=&quot;1&quot;
    android:controlY2=&quot;1&quot;/&gt;
</code></pre><p>系统将为 Material Design 规范中的三种基本曲线提供 XML 资源：</p>
<ul>
<li>@interpolator/fast_out_linear_in.xml</li>
<li>@interpolator/fast_out_slow_in.xml</li>
<li>@interpolator/linear_out_slow_in.xml</li>
</ul>
<p>可以将一个 PathInterpolator 对象传递给 Animator.setInterpolator() 方法。</p>
<h2 id="为视图状态改变添加动画"><a href="#为视图状态改变添加动画" class="headerlink" title="为视图状态改变添加动画"></a>为视图状态改变添加动画</h2><p>StateListAnimator 类别让您能够定义视图状态改变时运行的动画。</p>
<pre><code>&lt;!-- animate the translationZ property of a view when pressed --&gt;
&lt;selector xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;
  &lt;item android:state_pressed=&quot;true&quot;&gt;
    &lt;set&gt;
      &lt;objectAnimator android:propertyName=&quot;translationZ&quot;
        android:duration=&quot;@android:integer/config_shortAnimTime&quot;
        android:valueTo=&quot;2dp&quot;
        android:valueType=&quot;floatType&quot;/&gt;
        &lt;!-- you could have other objectAnimator elements
             here for &quot;x&quot; and &quot;y&quot;, or other properties --&gt;
    &lt;/set&gt;
  &lt;/item&gt;
  &lt;item android:state_enabled=&quot;true&quot;
    android:state_pressed=&quot;false&quot;
    android:state_focused=&quot;true&quot;&gt;
    &lt;set&gt;
      &lt;objectAnimator android:propertyName=&quot;translationZ&quot;
        android:duration=&quot;100&quot;
        android:valueTo=&quot;0&quot;
        android:valueType=&quot;floatType&quot;/&gt;
    &lt;/set&gt;
  &lt;/item&gt;
&lt;/selector&gt;
</code></pre><p>如果要将定制视图状态动画附加至一个视图，请依照此示例使用 XML 资源文件中的 selector 元素定义一个动画，并使用 android:stateListAnimator 属性将此动画分配给您的视图。</p>
<p>如果要将一个状态列表动画分配给您的代码内的一个视图，请使用 AnimationInflater.loadStateListAnimator() 方法，并以 View.setStateListAnimator() 方法将动画分配给您的视图。</p>
<p>当您的主题扩展材料主题时，在默认情况下按钮将拥有一个 Z 动画。如果要避免您的按钮出现这类行为，请将 android:stateListAnimator 属性设置为 @null。</p>
<p>AnimatedStateListDrawable 类别让您能够创建图片，显示相关视图之间的状态变化。</p>
<pre><code>&lt;!-- res/drawable/myanimstatedrawable.xml --&gt;
&lt;animated-selector
    xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;

    &lt;!-- provide a different drawable for each state--&gt;
    &lt;item android:id=&quot;@+id/pressed&quot; android:drawable=&quot;@drawable/drawableP&quot;
        android:state_pressed=&quot;true&quot;/&gt;
    &lt;item android:id=&quot;@+id/focused&quot; android:drawable=&quot;@drawable/drawableF&quot;
        android:state_focused=&quot;true&quot;/&gt;
    &lt;item android:id=&quot;@id/default&quot;
        android:drawable=&quot;@drawable/drawableD&quot;/&gt;

    &lt;!-- specify a transition --&gt;
    &lt;transition android:fromId=&quot;@+id/default&quot; android:toId=&quot;@+id/pressed&quot;&gt;
        &lt;animation-list&gt;
            &lt;item android:duration=&quot;15&quot; android:drawable=&quot;@drawable/dt1&quot;/&gt;
            &lt;item android:duration=&quot;15&quot; android:drawable=&quot;@drawable/dt2&quot;/&gt;
            ...
        &lt;/animation-list&gt;
    &lt;/transition&gt;
    ...
&lt;/animated-selector&gt;
</code></pre><h2 id="为矢量图片添加动画"><a href="#为矢量图片添加动画" class="headerlink" title="为矢量图片添加动画"></a>为矢量图片添加动画</h2><p> AnimatedVectorDrawable 类别可让您为矢量图片的属性添加动画。</p>
<p> 需要创建 3 个 XML 文件：（它对于 vector 有要求）</p>
<ol>
<li>在 res/drawable/ 中拥有 <vector> 元素的矢量图片</vector></li>
<li>在 res/drawable/ 中拥有 <animated-vector> 元素且已添加动画的矢量图片</animated-vector></li>
<li>在 res/anim/ 中拥有 <objectanimator> 元素的一个或多个对象动画</objectanimator></li>
</ol>
<p>添加动画的矢量图片可为 <group> 以及 <path> 元素的属性添加动画。<group> 元素定义路径集或子组，而 <path> 元素则定义将绘制的路径。</path></group></path></group></p>
<p>使用 android:name 属性给这些群组和路径指定一个唯一名称，以便让您能够从您的动画定义中引用这些群组或路径</p>
<pre><code>&lt;!-- res/drawable/vectordrawable.xml --&gt;
&lt;vector xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    android:height=&quot;64dp&quot;
    android:width=&quot;64dp&quot;
    android:viewportHeight=&quot;600&quot;
    android:viewportWidth=&quot;600&quot;&gt;
    &lt;group
        android:name=&quot;rotationGroup&quot;
        android:pivotX=&quot;300.0&quot;
        android:pivotY=&quot;300.0&quot;
        android:rotation=&quot;45.0&quot; &gt;
        &lt;path
            android:name=&quot;v&quot;
            android:fillColor=&quot;#000000&quot;
            android:pathData=&quot;M300,70 l 0,-70 70,70 0,0 -70,70z&quot; /&gt;
    &lt;/group&gt;
&lt;/vector&gt;
</code></pre><p>已添加动画的矢量图片定义按名称引用矢量图片内的群组和路径：</p>
<pre><code>&lt;!-- res/drawable/animvectordrawable.xml --&gt;
&lt;animated-vector xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
  android:drawable=&quot;@drawable/vectordrawable&quot; &gt;
    &lt;target
        android:name=&quot;rotationGroup&quot;
        android:animation=&quot;@anim/rotation&quot; /&gt;
    &lt;target
        android:name=&quot;v&quot;
        android:animation=&quot;@anim/path_morph&quot; /&gt;
&lt;/animated-vector&gt;
</code></pre><p>动画定义代表着 ObjectAnimator 或 AnimatorSet 对象。</p>
<pre><code>&lt;!-- res/anim/rotation.xml --&gt;
&lt;objectAnimator
    android:duration=&quot;6000&quot;
    android:propertyName=&quot;rotation&quot;
    android:valueFrom=&quot;0&quot;
    android:valueTo=&quot;360&quot; /&gt;
</code></pre><p>此示例中的第二个动画对矢量图片的路径进行变形:</p>
<pre><code>&lt;!-- res/anim/path_morph.xml --&gt;
&lt;set xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;
    &lt;objectAnimator
        android:duration=&quot;3000&quot;
        android:propertyName=&quot;pathData&quot;
        android:valueFrom=&quot;M300,70 l 0,-70 70,70 0,0   -70,70z&quot;
        android:valueTo=&quot;M300,70 l 0,-70 70,0  0,140 -70,0 z&quot;
        android:valueType=&quot;pathType&quot; /&gt;
&lt;/set&gt;
</code></pre><p>开启动画：</p>
<pre><code>ImageView iv = (ImageView) findViewById(R.id.iv);
Drawable drawable = iv.getDrawable();
if (drawable instanceof Animatable) {
    ((Animatable) drawable).start();
}
</code></pre><h1 id="Maintaining-Compatibility"><a href="#Maintaining-Compatibility" class="headerlink" title="Maintaining Compatibility"></a>Maintaining Compatibility</h1><h2 id="Define-Alternative-Styles-定义替换-styles"><a href="#Define-Alternative-Styles-定义替换-styles" class="headerlink" title="Define Alternative Styles 定义替换 styles"></a>Define Alternative Styles 定义替换 styles</h2><ol>
<li>Define a theme that inherits from an older theme (like Holo) in res/values/styles.xml.</li>
<li>Define a theme with the same name that inherits from the material theme in res/values-v21/styles.xml.</li>
<li>Set this theme as your app’s theme in the manifest file.</li>
</ol>
<h2 id="Provide-Alternative-Layouts-提供替换的布局"><a href="#Provide-Alternative-Layouts-提供替换的布局" class="headerlink" title="Provide Alternative Layouts 提供替换的布局"></a>Provide Alternative Layouts 提供替换的布局</h2><ul>
<li>res/layout-v21/</li>
<li><p>res/layout/</p>
</li>
<li><p>res/values/</p>
</li>
<li>res/values-v21/</li>
</ul>
<h2 id="Use-the-Support-Library-使用支持包"><a href="#Use-the-Support-Library-使用支持包" class="headerlink" title="Use the Support Library 使用支持包"></a>Use the Support Library 使用支持包</h2><h3 id="Dependencies-添加依赖"><a href="#Dependencies-添加依赖" class="headerlink" title="Dependencies 添加依赖"></a>Dependencies 添加依赖</h3><pre><code>dependencies {
    compile &apos;com.android.support:appcompat-v7:25.0.1&apos;
    compile &apos;com.android.support:cardview-v7:25.0.1&apos;
    compile &apos;com.android.support:recyclerview-v7:25.0.1&apos;
}
</code></pre><h2 id="Check-the-System-Version-检查版本"><a href="#Check-the-System-Version-检查版本" class="headerlink" title="Check the System Version 检查版本"></a>Check the System Version 检查版本</h2><p>在使用 Android5.0 代码的时候使用下面的代码做适配：</p>
<pre><code>// Check if we&apos;re running on Android 5.0 or higher
if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP) {
    // Call some material design APIs here
} else {
    // Implement this feature without material design
}
</code></pre><h1 id="Selecting-Colors-with-the-Palette-API"><a href="#Selecting-Colors-with-the-Palette-API" class="headerlink" title="Selecting Colors with the Palette API"></a>Selecting Colors with the Palette API</h1><h2 id="Set-up-the-library"><a href="#Set-up-the-library" class="headerlink" title="Set up the library"></a>Set up the library</h2><pre><code>android {
  compileSdkVersion 24
  ...
}

dependencies {
  ...
  compile &apos;com.android.support:palette-v7:24.2.1&apos;
}
</code></pre><h2 id="Create-a-palette"><a href="#Create-a-palette" class="headerlink" title="Create a palette"></a>Create a palette</h2><p>Palette 对象有获取 image 的主颜色的功能。</p>
<h3 id="Generate-a-Palette-instance-创建-Palette-对象"><a href="#Generate-a-Palette-instance-创建-Palette-对象" class="headerlink" title="Generate a Palette instance 创建 Palette 对象"></a>Generate a Palette instance 创建 Palette 对象</h3><pre><code>// Generate palette synchronously and return it
public Palette createPaletteSync(Bitmap bitmap) {
  Palette p = Palette.from(bitmap).generate();
  return p;
}

// Generate palette asynchronously and use it on a different
// thread using onGenerated()
public void createPaletteAsync(Bitmap bitmap) {
  Palette.from(bitmap).generate(new PaletteAsyncListener() {
    public void onGenerated(Palette p) {
      // Use generated instance
    }
  });
}
</code></pre><h3 id="Customize-your-palette-自定义-palette"><a href="#Customize-your-palette-自定义-palette" class="headerlink" title="Customize your palette 自定义 palette"></a>Customize your palette 自定义 palette</h3><p>Palette.Builder 允许自定义 获取颜色的数量，获取颜色的区域，允许获取的颜色值。</p>
<ul>
<li><p>addFilter()</p>
<p>  添加获取的颜色过滤，Pass in your own Palette.Filter and modify its isAllowed() method to determine which colors are filtered from the palette.</p>
</li>
<li><p>maximumColorCount()</p>
<p>  设置获取颜色的数量值，默认16</p>
</li>
<li><p>setRegion()</p>
<p>  定义获取颜色的区域</p>
</li>
<li><p>addTarget()</p>
<p>  自己定义获取的颜色值</p>
</li>
</ul>
<h2 id="Extract-color-profiles-提取颜色参数"><a href="#Extract-color-profiles-提取颜色参数" class="headerlink" title="Extract color profiles 提取颜色参数"></a>Extract color profiles 提取颜色参数</h2><p>可提取的颜色类型：</p>
<ul>
<li>Light Vibrant</li>
<li>Vibrant</li>
<li>Dark Vibrant</li>
<li>Light Muted</li>
<li>Muted</li>
<li>Dark Muted</li>
</ul>
<p><code>Palette’s get&lt;Profile&gt;Color()</code></p>
<h3 id="Use-swatches-to-create-color-schemes-使用色板定义颜色策略"><a href="#Use-swatches-to-create-color-schemes-使用色板定义颜色策略" class="headerlink" title="Use swatches to create color schemes 使用色板定义颜色策略"></a>Use swatches to create color schemes 使用色板定义颜色策略</h3><p>Palette 对象也可以使用 Palette.Swatch 生成。</p>
<p>通过调用色板的获取颜色方法：getBodyTextColor() and getTitleTextColor()，可以获取到合适的颜色。</p>
<p>Palette 对象的 <code>get&lt;Profile&gt;Swatch()</code> 方法返回色板。</p>
<pre><code>// Return a palette&apos;s vibrant swatch after checking that it exists
private Palette.Swatch checkVibrantSwatch(Palette p) {
  Palette.Swatch vibrant = p.getVibrantSwatch();
  if (vibrant != null) {
    return vibrant;
  }
  // Throw error
}
</code></pre><p>usage：</p>
<pre><code>// Set the background and text colors of a toolbar given a
// bitmap image to match
public void setToolbarColor(Bitmap bitmap) {
  // Generate the palette and get the vibrant swatch
  // See the createPaletteSync() and checkVibrantSwatch() methods
  // from the code snippets above
  Palette p = createPaletteSync(bitmap);
  Palette.Swatch vibrantSwatch = checkVibrantSwatch(p);

  // Set the toolbar background and text colors
  Toolbar toolbar = (Toolbar) findViewById(R.id.toolbar);
  toolbar.setBackgroundColor(vibrantSwatch.getRgb());
  toolbar.setTitleTextColor(vibrantSwatch.getTitleTextColor());
}
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/31/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/31/">31</a><span class="page-number current">32</span><a class="page-number" href="/page/33/">33</a><span class="space">&hellip;</span><a class="page-number" href="/page/55/">55</a><a class="extend next" rel="next" href="/page/33/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="/head1.jpg" alt="Double">
          <p class="site-author-name" itemprop="name">Double</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">548</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">24</span>
                <span class="site-state-item-name">categories</span>
              
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">260</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Double</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  





  






  





  

  

  

  

  

  

</body>
</html>
