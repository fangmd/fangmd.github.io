<!doctype html>



  


<html class="theme-next muse use-motion" lang>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css">


  <meta name="keywords" content="Docker,">








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1">






<meta name="description" content="Get Started with DockerBuild your own imageWrite a Dockerfile12345$ mkdir mydockerbuild$ cd mydockerbuild$ view Dockerfile Dockerfile 文件中先添加下面的内容：表示这个 image 基于 docker/whalesay image  1FROM docker/whal">
<meta name="keywords" content="Docker">
<meta property="og:type" content="article">
<meta property="og:title" content="Docker Learn">
<meta property="og:url" content="http://yoursite.com/2017/01/01/program/docker/docker-learn/index.html">
<meta property="og:site_name" content="Double">
<meta property="og:description" content="Get Started with DockerBuild your own imageWrite a Dockerfile12345$ mkdir mydockerbuild$ cd mydockerbuild$ view Dockerfile Dockerfile 文件中先添加下面的内容：表示这个 image 基于 docker/whalesay image  1FROM docker/whal">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2021-08-12T14:50:57.429Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Docker Learn">
<meta name="twitter:description" content="Get Started with DockerBuild your own imageWrite a Dockerfile12345$ mkdir mydockerbuild$ cd mydockerbuild$ view Dockerfile Dockerfile 文件中先添加下面的内容：表示这个 image 基于 docker/whalesay image  1FROM docker/whal">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2017/01/01/program/docker/docker-learn/">





  <title>Docker Learn | Double</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Double</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/01/01/program/docker/docker-learn/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Double">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/head1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Double">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Docker Learn</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-01-01T13:18:12+08:00">
                2017-01-01
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Docker/" itemprop="url" rel="index">
                    <span itemprop="name">Docker</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="Get-Started-with-Docker"><a href="#Get-Started-with-Docker" class="headerlink" title="Get Started with Docker"></a>Get Started with Docker</h1><h2 id="Build-your-own-image"><a href="#Build-your-own-image" class="headerlink" title="Build your own image"></a>Build your own image</h2><h3 id="Write-a-Dockerfile"><a href="#Write-a-Dockerfile" class="headerlink" title="Write a Dockerfile"></a>Write a Dockerfile</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir mydockerbuild</span><br><span class="line"></span><br><span class="line">$ cd mydockerbuild</span><br><span class="line"></span><br><span class="line">$ view Dockerfile</span><br></pre></td></tr></table></figure>
<p><code>Dockerfile</code> 文件中先添加下面的内容：表示这个 image 基于 <code>docker/whalesay</code> image </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FROM docker/whalesay:latest</span><br></pre></td></tr></table></figure>
<p>安装 <code>fortunes</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RUN apt-get -y update &amp;&amp; apt-get install -y fortunes</span><br></pre></td></tr></table></figure>
<p><code>CMD</code> 表示要执行的命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CMD /usr/games/fortune -a | cowsay</span><br></pre></td></tr></table></figure>
<h3 id="Build-an-image-from-your-Dockerfile"><a href="#Build-an-image-from-your-Dockerfile" class="headerlink" title="Build an image from your Dockerfile"></a>Build an image from your Dockerfile</h3><p>编译 docker image， <code>-t [image name]</code> 表示命名这个 image， <code>.</code> 表示从当前目录找 DockerFile<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build -t docker-whale .</span><br></pre></td></tr></table></figure></p>
<h3 id="Learn-about-the-build-process"><a href="#Learn-about-the-build-process" class="headerlink" title="Learn about the build process"></a>Learn about the build process</h3><p>编译命名执行后：会读取 DockerFile 文件，执行里面的语句</p>
<ol>
<li><p>Docker 检查 DockerFile 的完整性，输出语句：</p>
<pre><code>Sending build context to Docker daemon 2.048 kB
</code></pre></li>
<li><p>执行语句：检查本地是否有 <code>whalwsay</code> image， 如果没有就从 Docker HUB pull </p>
<pre><code>Step 1 : FROM docker/whalesay:latest
---&gt; 6b362a9f73eb
</code></pre><p> 最后输出 <code>whalwsay</code> 的 ID</p>
</li>
<li><p>执行语句：</p>
<p> Docker 创建临时的 container 执行下面的命名，安装 <code>fortunes</code> 软件</p>
<pre><code>Step 2 : RUN apt-get -y update &amp;&amp; apt-get install -y fortunes
</code></pre><p> 安装结束后临时 container 会被移除</p>
</li>
<li><p>执行语句：</p>
<p> 创建新的中间 container a8e6faa88df3 执行 CMD 命令。</p>
<pre><code>Step 3 : CMD /usr/games/fortune -a | cowsay
---&gt; Running in a8e6faa88df3
---&gt; 7d9495d03763
Removing intermediate container a8e6faa88df3
Successfully built 7d9495d03763
</code></pre></li>
</ol>
<h3 id="Run-your-new-docker-whale"><a href="#Run-your-new-docker-whale" class="headerlink" title="Run your new docker-whale"></a>Run your new docker-whale</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker images</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run docker-whale</span><br></pre></td></tr></table></figure>
<h2 id="Tag-push-and-pull-your-image"><a href="#Tag-push-and-pull-your-image" class="headerlink" title="Tag, push, and pull your image"></a>Tag, push, and pull your image</h2><h3 id="Tag-and-push-the-image"><a href="#Tag-and-push-the-image" class="headerlink" title="Tag and push the image"></a>Tag and push the image</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker tag [id] [account name/image name:latest]</span><br><span class="line">docker tag 7d9495d03763 maryatdocker/docker-whale:latest</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker login</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker push [image tag]</span><br></pre></td></tr></table></figure>
<h3 id="Pull-your-new-image"><a href="#Pull-your-new-image" class="headerlink" title="Pull your new image"></a>Pull your new image</h3><p>删除 本地 镜像</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rmi -f 7d9495d03763</span><br></pre></td></tr></table></figure>
<p>直接运行镜像，就会从远程下载镜像</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run fangmingdong/learn</span><br></pre></td></tr></table></figure>
<h1 id="Learn-by-Example"><a href="#Learn-by-Example" class="headerlink" title="Learn by Example"></a>Learn by Example</h1><h2 id="Hello-world-in-container"><a href="#Hello-world-in-container" class="headerlink" title="Hello world in container"></a>Hello world in container</h2><h3 id="Run-a-Hello-world"><a href="#Run-a-Hello-world" class="headerlink" title="Run a Hello world"></a>Run a Hello world</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run ubuntu /bin/echo &apos;Hello world&apos;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>docker run</code> 运行一个容器</li>
<li><code>ubuntu</code> 是一个 镜像</li>
<li><code>/bin/echo &#39;Hello world&#39;</code> 命令运行在内部的一个新容器中</li>
</ul>
<h3 id="Run-an-interactive-container"><a href="#Run-an-interactive-container" class="headerlink" title="Run an interactive container"></a>Run an interactive container</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -t -i ubuntu /bin/bash</span><br></pre></td></tr></table></figure>
<ul>
<li><code>-t</code>表示在容器内部使用终端</li>
<li><code>-i</code> 允许和容器建立外部连接</li>
</ul>
<h3 id="Start-a-daemonized-Hello-world"><a href="#Start-a-daemonized-Hello-world" class="headerlink" title="Start a daemonized Hello world"></a>Start a daemonized Hello world</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d ubuntu /bin/sh -c &quot;while true; do echo hello world; sleep 1; done&quot;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>-d</code> flag runs the container in the background (to daemonize it).</li>
</ul>
<p>运行后输出: container id</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10331d6d3d678d2400d09b7a570fb07faca75db1e74c764cd503f56cb372670a</span><br></pre></td></tr></table></figure>
<p>使用 <code>docker ps</code> 查看正在运行的 container</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CONTAINER ID  IMAGE         COMMAND               CREATED        STATUS       PORTS NAMES</span><br><span class="line">1e5535038e28  ubuntu  /bin/sh -c &apos;while tr  2 minutes ago  Up 1 minute        insane_babbage</span><br></pre></td></tr></table></figure>
<p>这里的 container id 是缩写.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker logs insane_babbage</span><br></pre></td></tr></table></figure>
<ul>
<li><code>docker logs</code> 查看容器内部</li>
</ul>
<p>停止容器运行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker stop insane_babbage</span><br></pre></td></tr></table></figure>
<h2 id="Run-a-simple-application"><a href="#Run-a-simple-application" class="headerlink" title="Run a simple application"></a>Run a simple application</h2><h3 id="Learn-about-the-Docker-client"><a href="#Learn-about-the-Docker-client" class="headerlink" title="Learn about the Docker client"></a>Learn about the Docker client</h3><p>Docker 程序就是 Docker 客户端</p>
<p>通过命令行的形式使用 Docker 客户端</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[sudo] docker [subcommand] [flags] [arguments] ..</span><br></pre></td></tr></table></figure>
<h3 id="Get-Docker-command-help"><a href="#Get-Docker-command-help" class="headerlink" title="Get Docker command help"></a>Get Docker command help</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker --help</span><br></pre></td></tr></table></figure>
<p>具体命令使用帮助：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker attach --help</span><br></pre></td></tr></table></figure>
<h3 id="Run-a-web-application-in-Docker"><a href="#Run-a-web-application-in-Docker" class="headerlink" title="Run a web application in Docker"></a>Run a web application in Docker</h3><p>下面的例子运行：Python Flask application</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -P training/webapp python app.py</span><br></pre></td></tr></table></figure>
<ul>
<li><code>-P</code>:表示映射所有端口到容器内部</li>
<li><code>training/webapp</code>:是一个预先创建好的 image</li>
<li><code>python app.py</code>: 这个命名运行在容器内部，启动 web 应用</li>
</ul>
<h3 id="View-the-web-application-container"><a href="#View-the-web-application-container" class="headerlink" title="View the web application container"></a>View the web application container</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps -l</span><br></pre></td></tr></table></figure>
<p>查看刚才运行的 container</p>
<ul>
<li><code>-l</code>: 表示最后运行的 container</li>
</ul>
<p>查看 docker-machine ip:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-machine ip</span><br></pre></td></tr></table></figure>
<h3 id="A-network-port-shortcut"><a href="#A-network-port-shortcut" class="headerlink" title="A network port shortcut"></a>A network port shortcut</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker port nostalgic_morse 5000</span><br></pre></td></tr></table></figure>
<h3 id="View-the-web-application’s-logs"><a href="#View-the-web-application’s-logs" class="headerlink" title="View the web application’s logs"></a>View the web application’s logs</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ docker logs -f nostalgic_morse</span><br><span class="line"></span><br><span class="line">* Running on http://0.0.0.0:5000/</span><br><span class="line">10.0.2.2 - - [06/Nov/2016 20:16:31] &quot;GET / HTTP/1.1&quot; 200 -</span><br><span class="line">10.0.2.2 - - [06/Nov/2016 20:16:31] &quot;GET /favicon.ico HTTP/1.1&quot; 404 -</span><br></pre></td></tr></table></figure>
<h3 id="Look-at-the-web-application-container’s-processes"><a href="#Look-at-the-web-application-container’s-processes" class="headerlink" title="Look at the web application container’s processes"></a>Look at the web application container’s processes</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ docker top nostalgic_morse</span><br><span class="line"></span><br><span class="line">PID                 USER                COMMAND</span><br><span class="line">854                 root                python app.py</span><br></pre></td></tr></table></figure>
<h3 id="Inspect-the-web-application-container"><a href="#Inspect-the-web-application-container" class="headerlink" title="Inspect the web application container"></a>Inspect the web application container</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ docker inspect nostalgic_morse</span><br><span class="line"></span><br><span class="line">$ docker inspect [container name]</span><br></pre></td></tr></table></figure>
<h3 id="Stop-the-web-application-container"><a href="#Stop-the-web-application-container" class="headerlink" title="Stop the web application container"></a>Stop the web application container</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker stop [container name or container id]</span><br></pre></td></tr></table></figure>
<h3 id="Restart-the-web-application-container"><a href="#Restart-the-web-application-container" class="headerlink" title="Restart the web application container"></a>Restart the web application container</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker start [container name or container id]</span><br></pre></td></tr></table></figure>
<h3 id="Remove-the-web-application-container"><a href="#Remove-the-web-application-container" class="headerlink" title="Remove the web application container"></a>Remove the web application container</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rm [container name]</span><br></pre></td></tr></table></figure>
<h2 id="Build-your-own-images"><a href="#Build-your-own-images" class="headerlink" title="Build your own images"></a>Build your own images</h2><h2 id="Network-containers"><a href="#Network-containers" class="headerlink" title="Network containers"></a>Network containers</h2><h2 id="Manage-data-in-containers"><a href="#Manage-data-in-containers" class="headerlink" title="Manage data in containers"></a>Manage data in containers</h2><h1 id="Docker-Compose"><a href="#Docker-Compose" class="headerlink" title="Docker Compose"></a>Docker Compose</h1><h2 id="Overview-of-Docker-Compose"><a href="#Overview-of-Docker-Compose" class="headerlink" title="Overview of Docker Compose"></a>Overview of Docker Compose</h2><p>Docker Compose 是一个可以运行多个 container 的 Docker 工具应用。</p>
<p>使用 Compose file 配置应用的服务，然后使用一个命名就能启动所有的服务。</p>
<p>使用 Compose 三个步骤：</p>
<ul>
<li>使用 Dockerfile 定义 Docker app 的运行环境</li>
<li>使用 <code>docker-compose.yml</code> 定义所有需要启动的服务，然后他们可以一起启动</li>
<li>最后运行 docker-compose</li>
</ul>
<p><code>docker-compose.yml</code> 例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">version: &apos;2&apos;</span><br><span class="line">services:</span><br><span class="line">  web:</span><br><span class="line">    build: .</span><br><span class="line">    ports:</span><br><span class="line">    - &quot;5000:5000&quot;</span><br><span class="line">    volumes:</span><br><span class="line">    - .:/code</span><br><span class="line">    - logvolume01:/var/log</span><br><span class="line">    links:</span><br><span class="line">    - redis</span><br><span class="line">  redis:</span><br><span class="line">    image: redis</span><br><span class="line">volumes:</span><br><span class="line">  logvolume01: &#123;&#125;</span><br></pre></td></tr></table></figure>
<p>Compose 有命名自己的命令工具控制整个应用的生命周期：</p>
<ul>
<li>Start, stop and rebuild services</li>
<li>View the status of running services</li>
<li>Stream the log output of running services</li>
<li>Run a one-off command on a service</li>
</ul>
<h2 id="Get-started-with-Docker-Compose"><a href="#Get-started-with-Docker-Compose" class="headerlink" title="Get started with Docker Compose"></a>Get started with Docker Compose</h2><h2 id="Quickstart-Compose-and-Django"><a href="#Quickstart-Compose-and-Django" class="headerlink" title="Quickstart: Compose and Django"></a>Quickstart: Compose and Django</h2><h3 id="Define-the-project-components"><a href="#Define-the-project-components" class="headerlink" title="Define the project components"></a>Define the project components</h3><ol>
<li>创建一个工程目录 <code>dockerdjango</code></li>
<li><p>目录中创建 <code>Dockerfile</code></p>
<pre><code>FROM python:3.5.2
ENV PYTHONUNBUFFERED 1
RUN mkdir /code
WORKDIR /code
ADD requirements.txt /code/
RUN pip install -r requirements.txt
ADD . /code/
</code></pre></li>
<li><p>目录中创建 <code>requirements.txt</code></p>
<pre><code>Django
psycopg2
</code></pre></li>
<li><p>目录中创建 <code>docker-compose.yml</code></p>
<pre><code>version: &apos;2&apos;
services:
  db:
    image: postgres
  web:
    build: .
    command: python manage.py runserver 0.0.0.0:8000
    volumes:
      * .:/code
    ports:
      * &quot;8000:8000&quot;
    depends_on:
      * db
</code></pre><p> 这里建立了两个服务：db，web</p>
</li>
</ol>
<h3 id="Create-a-Django-project"><a href="#Create-a-Django-project" class="headerlink" title="Create a Django project"></a>Create a Django project</h3><ol>
<li>切换工作目录到工程根目录</li>
<li><p>使用 <code>docker-compose</code> 命令创建 Django 工程</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose run web django-admin.py startproject composeexample .</span><br></pre></td></tr></table></figure>
<p> 上面的语句运行 <code>django-admin.py startproject composeexample</code> 命令在 container 内部，使用 <code>web</code> service 的 image 和 configuration。如果是初次运行会在当前目录创建 <code>web</code> image 因为在 <code>docker-compose.yml</code> 中定义了 <code>build: .</code></p>
</li>
<li></li>
</ol>
<h3 id="Connect-the-database"><a href="#Connect-the-database" class="headerlink" title="Connect the database"></a>Connect the database</h3><p><code>composeexample/settings.py</code> file:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">DATABASES = &#123;</span><br><span class="line">     &apos;default&apos;: &#123;</span><br><span class="line">         &apos;ENGINE&apos;: &apos;django.db.backends.postgresql&apos;,</span><br><span class="line">         &apos;NAME&apos;: &apos;postgres&apos;,</span><br><span class="line">         &apos;USER&apos;: &apos;postgres&apos;,</span><br><span class="line">         &apos;HOST&apos;: &apos;db&apos;,</span><br><span class="line">         &apos;PORT&apos;: 5432,</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up</span><br></pre></td></tr></table></figure>
<p>访问 <code>http:docker-machone ip:8000</code> 查看是否运行成功</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Docker/" rel="tag"># Docker</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/01/01/program/docker/docker-command/" rel="next" title="Docker Command">
                <i class="fa fa-chevron-left"></i> Docker Command
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/01/01/server/nginx/启动nginx status状态/" rel="prev" title="启动 nginx status">
                启动 nginx status <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="/head1.jpg" alt="Double">
          <p class="site-author-name" itemprop="name">Double</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">548</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">24</span>
                <span class="site-state-item-name">categories</span>
              
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">260</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Get-Started-with-Docker"><span class="nav-number">1.</span> <span class="nav-text">Get Started with Docker</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Build-your-own-image"><span class="nav-number">1.1.</span> <span class="nav-text">Build your own image</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Write-a-Dockerfile"><span class="nav-number">1.1.1.</span> <span class="nav-text">Write a Dockerfile</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Build-an-image-from-your-Dockerfile"><span class="nav-number">1.1.2.</span> <span class="nav-text">Build an image from your Dockerfile</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Learn-about-the-build-process"><span class="nav-number">1.1.3.</span> <span class="nav-text">Learn about the build process</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Run-your-new-docker-whale"><span class="nav-number">1.1.4.</span> <span class="nav-text">Run your new docker-whale</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Tag-push-and-pull-your-image"><span class="nav-number">1.2.</span> <span class="nav-text">Tag, push, and pull your image</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Tag-and-push-the-image"><span class="nav-number">1.2.1.</span> <span class="nav-text">Tag and push the image</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Pull-your-new-image"><span class="nav-number">1.2.2.</span> <span class="nav-text">Pull your new image</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Learn-by-Example"><span class="nav-number">2.</span> <span class="nav-text">Learn by Example</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Hello-world-in-container"><span class="nav-number">2.1.</span> <span class="nav-text">Hello world in container</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Run-a-Hello-world"><span class="nav-number">2.1.1.</span> <span class="nav-text">Run a Hello world</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Run-an-interactive-container"><span class="nav-number">2.1.2.</span> <span class="nav-text">Run an interactive container</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Start-a-daemonized-Hello-world"><span class="nav-number">2.1.3.</span> <span class="nav-text">Start a daemonized Hello world</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Run-a-simple-application"><span class="nav-number">2.2.</span> <span class="nav-text">Run a simple application</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Learn-about-the-Docker-client"><span class="nav-number">2.2.1.</span> <span class="nav-text">Learn about the Docker client</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Get-Docker-command-help"><span class="nav-number">2.2.2.</span> <span class="nav-text">Get Docker command help</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Run-a-web-application-in-Docker"><span class="nav-number">2.2.3.</span> <span class="nav-text">Run a web application in Docker</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#View-the-web-application-container"><span class="nav-number">2.2.4.</span> <span class="nav-text">View the web application container</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#A-network-port-shortcut"><span class="nav-number">2.2.5.</span> <span class="nav-text">A network port shortcut</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#View-the-web-application’s-logs"><span class="nav-number">2.2.6.</span> <span class="nav-text">View the web application’s logs</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Look-at-the-web-application-container’s-processes"><span class="nav-number">2.2.7.</span> <span class="nav-text">Look at the web application container’s processes</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Inspect-the-web-application-container"><span class="nav-number">2.2.8.</span> <span class="nav-text">Inspect the web application container</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Stop-the-web-application-container"><span class="nav-number">2.2.9.</span> <span class="nav-text">Stop the web application container</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Restart-the-web-application-container"><span class="nav-number">2.2.10.</span> <span class="nav-text">Restart the web application container</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Remove-the-web-application-container"><span class="nav-number">2.2.11.</span> <span class="nav-text">Remove the web application container</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Build-your-own-images"><span class="nav-number">2.3.</span> <span class="nav-text">Build your own images</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Network-containers"><span class="nav-number">2.4.</span> <span class="nav-text">Network containers</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Manage-data-in-containers"><span class="nav-number">2.5.</span> <span class="nav-text">Manage data in containers</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Docker-Compose"><span class="nav-number">3.</span> <span class="nav-text">Docker Compose</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Overview-of-Docker-Compose"><span class="nav-number">3.1.</span> <span class="nav-text">Overview of Docker Compose</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Get-started-with-Docker-Compose"><span class="nav-number">3.2.</span> <span class="nav-text">Get started with Docker Compose</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Quickstart-Compose-and-Django"><span class="nav-number">3.3.</span> <span class="nav-text">Quickstart: Compose and Django</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Define-the-project-components"><span class="nav-number">3.3.1.</span> <span class="nav-text">Define the project components</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Create-a-Django-project"><span class="nav-number">3.3.2.</span> <span class="nav-text">Create a Django project</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Connect-the-database"><span class="nav-number">3.3.3.</span> <span class="nav-text">Connect the database</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Double</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  





  






  





  

  

  

  

  

  

</body>
</html>
